/**
 * Copyright 2018 PhenixP2P Inc. All Rights Reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("phenix-web-sdk",[],e):"object"==typeof exports?exports["phenix-web-sdk"]=e():t["phenix-web-sdk"]=e()}(window,function(){return function(t){var e={};function i(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},i.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=85)}([function(t,e,i){var n,r;n=[i(84)],void 0===(r=function(t){"use strict";return t}.apply(e,n))||(t.exports=r)},function(t,e,i){var n,r;n=[i(83)],void 0===(r=function(t){return t}.apply(e,n))||(t.exports=r)},function(t,e,i){var n,r,s,o;t.exports=(n=i(0),r=i(1),s=i(82),o=i(7),function(t){function e(n){if(i[n])return i[n].exports;var r=i[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var i={};return e.m=t,e.c=i,e.i=function(t){return t},e.d=function(t,i,n){e.o(t,i)||Object.defineProperty(t,i,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=14)}([function(t,e){t.exports=n},function(t,e,i){(function(i){var n;void 0===(n=function(){"use strict";return"object"==typeof window?window:"object"==typeof i?i:{}}.apply(e,[]))||(t.exports=n)}).call(e,i(5))},function(t,e,i){var n,r;n=[i(0),i(12),i(6),i(1)],void 0===(r=function(t,e,i,n){"use strict";function r(t,n,r){var s=this;this.t=t,this.e=n,this.a=r,this.u={},this.h=new e.DisposableList;var o=function(t){s.f=!0,s.v=!0===t,t?c.call(s):p("Failed to create Phenix video element"),s.g&&s.g(s.v)};try{if(this.y=function(t){var e=document.createElement("video");return t&&((e=document.createElement("object")).type="application/x-phenix-video"),e}(r),this.y.className=this.t.className,this.y.height=this.t.height,this.y.width=this.t.width,this.w=this.t.style.cssText,this.t.style.cssText="visibility:hidden !important;width:0px !important;height:0px !important;margin:0px !important;padding:0px !important;border-style:none !important;border-width:0px !important;max-width:0px !important;max-height:0px !important;outline:none !important",this.h.add(new e.Disposable(function(){s.t.style.cssText=s.w})),this.y.onunload=function(){s.f=!1},d.call(this),document.body&&document.body.contains||l("document.body.contains is not supported"),document.body&&document.body.contains&&document.body.contains(this.t)&&(this.t.parentNode.replaceChild(this.y,this.t),this.h.add(new e.Disposable(function(){s.y.parentNode&&s.y.parentNode.replaceChild(s.t,s.y)}))),!r)return o(!0);(new i).waitForReady(this.y,o)}catch(t){p("Error while loading Phenix RTC"+t),o(!1)}}function s(t,e,i){if(!this.a)return this.y.addEventListener(t,e,i);var n=this.u[t];n||(n=this.u[t]=[],this.f&&a.call(this,t)),n.push(e)}function o(t,e,i){if(!this.a)return this.y.removeEventListener(t,e,i);var n=this.u[t];if(n){var r=n.indexOf(e);r>=0&&((n=n.splice(r,1)).length>0?this.u[t]=n:delete this.u[t])}}function a(t){var e=this;e.y.phenixSetEventListener(t,function(){var i=e.u[t];if(i)for(var n=0;n<i.length;n++)i[n].apply(e,arguments)})}function u(t,e){var i;document.createEvent?(i=document.createEvent("HTMLEvents")).initEvent(e,!0,!0):(i=document.createEventObject()).eventType=e,i.eventName=e,setTimeout(function(){document.createEvent?t.dispatchEvent(i):t.fireEvent("on"+i.eventType,i)})}function c(){for(var t=Object.keys(this.u),e=0;e<t.length;e++)a.call(this,t[e]);this.hookUpEvents(),h.call(this),this.y.id=this.t.id,this.y.style.cssText=this.t.cssText,this.y.className=this.t.className,this.y.innerHtml=this.t.innerHtml,this.y.width=this.t.width,this.y.height=this.t.height,this.y.autoplay=this.t.autoplay,this.y.muted=this.t.muted,this.y.defaultMuted=this.t.defaultMuted,this.y.volume=this.t.volume,this.e&&(this.y.src=this.e)}function h(){var i=this,r=["style"];if(t.get(n,["MutationObserver"])){var s=new MutationObserver(function(t){t.forEach(function(t){"attributes"===t.type&&t.target===i.t&&-1===r.indexOf(t.attributeName)&&(i.y[t.attributeName]=i.t[t.attributeName])})});s.observe(i.t,{attributes:!0}),i.h.add(new e.Disposable(function(){s.disconnect()}))}else{l("Falling back to use of DOM event listeners. This results in degraded performance for further DOM modifications and does not work for IE prior to version 9. See https://developer.mozilla.org/en-US/docs/Web/Guide/Events/Mutation_events for details.");var o=function(t){i.y[t.target.tagName]=i.t[t.target.tagName]};i.t.addEventListener?(i.t.addEventListener("DOMAttrModified",o,!1),i.h.add(new e.Disposable(function(){i.t.removeEventListener("DOMAttrModified",o,!1)}))):(i.t.attachEvent("onpropertychange",o),i.h.add(new e.Disposable(function(){i.t.detachEvent("DOMAttrModified",o)})))}}function d(){var i=this;if(t.get(n,["MutationObserver"])){var r=new MutationObserver(function(t){t.forEach(function(t){if("childList"===t.type)for(var e=0;e<t.addedNodes.length;e++){var n=t.addedNodes[e];t.target!==i.y&&(n===i.t?(t.target.replaceChild(i.y,i.t),c.call(i)):f(t.target,i.t)&&(i.t.parentNode.replaceChild(i.y,i.t),c.call(i)))}})});r.observe(document.body,{childList:!0,attributes:!1,characterData:!1,subtree:!0}),i.h.add(new e.Disposable(function(){r.disconnect()}))}else{l("Falling back to use of DOM event listeners. This results in degraded performance for further DOM modifications and does not work for IE prior to version 9. See https://developer.mozilla.org/en-US/docs/Web/Guide/Events/Mutation_events for details.");var a=function(){i.t.parentNode.replaceChild(i.y,i.t)};s("DOMNodeInserted",a,!1),i.h.add(new e.Disposable(function(){o("DOMNodeInserted",a,!1)}))}}function f(t,e){for(var i=e.parentNode;null!==i;){if(i===t)return!0;i=i.parentNode}return!1}var l=function(){console.log.apply(console,arguments)}||function(){},p=function(){console.error.apply(console,arguments)}||l;return r.prototype.hookUpEvents=function(){var t=this,i=this.t,n=function(){u(i,"error")},r=function(){i.muted=t.y.muted,u(i,"mute")},s=function(){i.muted=t.y.muted,u(i,"unmute")},o=function(){i.ended=t.y.ended,u(i,"ended")},a=function(){i.width=t.y.width,i.height=t.y.height,u(i,"loadedmetadata")},c=function(){i.width=t.y.width,i.height=t.y.height,u(i,"loadeddata")},h=function(){i.width=t.y.width,i.height=t.y.height,u(i,"resize")};this.addEventListener("error",n),this.addEventListener("mute",r),this.addEventListener("unmute",s),this.addEventListener("ended",o),this.addEventListener("loadedmetadata",a),this.addEventListener("loadeddata",c),this.addEventListener("resize",h);var d=new e.Disposable(function(){t.removeEventListener("error",n),t.removeEventListener("mute",r),t.removeEventListener("unmute",s),t.removeEventListener("ended",o),t.removeEventListener("loadedmetadata",a),t.removeEventListener("loadeddata",c),t.removeEventListener("resize",h)});return this.h.add(d),d},r.prototype.onReady=function(t){var e=this;this.f?setTimeout(function(){t(e.v)},1):this.g=t},r.prototype.getElement=function(){return this.y},r.prototype.addEventListener=function(t,e,i){s.call(this,t,e,i)},r.prototype.removeEventListener=function(t,e,i){o.call(this,t,e,i)},r.prototype.destroy=function(){this.h.dispose()},r}.apply(e,n))||(t.exports=r)},function(t,e){t.exports=r},function(t,e){t.exports=s},function(t,e){var i;i=function(){return this}();try{i=i||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(i=window)}t.exports=i},function(t,e,i){var n,r;n=[i(4)],void 0===(r=function(t){"use strict";function e(t){this.b=t||15e3}var i=new t(navigator.userAgent).detect(),n=function(){console.error.apply(console,arguments)}||console.log;return e.prototype.waitForReadyWithTimeout=function(t,e,r){var s=!1,o=1,a=o,u=function(t){s||(s=!0,e(t))};t.hasOwnProperty&&t.hasOwnProperty("onload")||"IE"!==i.browser&&n("No means of detecting when <object> is loaded"),t.onload=function(){u(!0)},function e(){4===t.readyState?u(!0):t.phenixVersion?u(!0):(o=Math.min(o+1e3,2*o),(a+=o)>r?(n("Timed out while waiting for <object> to load"),u(!1)):setTimeout(e,o))}()},e.prototype.waitForReady=function(t,e){t.phenixVersion?e(!0):this.waitForReadyWithTimeout(t,e,this.b)},e}.apply(e,n))||(t.exports=r)},function(t,e){t.exports=o},function(t,e,i){var n,r;n=[i(0),i(3),i(7),i(4),i(1),i(16),i(15)],void 0===(r=function(t,e,i,n,r,s,o){"use strict";function a(){if(t.assign(c,s()),o.isSupported()){c.phenixSupported=!0;var e=new o,i=function(){c.RTCPeerConnection=e.getRTCPeerConnectionConstructor(),c.RTCSessionDescription=e.getRTCSessionDescriptionConstructor(),c.RTCIceCandidate=e.getRTCIceCandidateConstructor(),c.getSources=e.getSourcesDelegate(),c.getUserMedia=e.getUserMediaDelegate(),c.getStats=e.getStatsDelegate(),Function.prototype.bind?(c.attachMediaStream=e.attachMediaStream.bind(e),c.reattachMediaStream=e.reattachMediaStream.bind(e),c.isPhenixEnabled=e.isEnabled.bind(e)):(c.attachMediaStream=function(){e.attachMediaStream.apply(e,arguments)},c.reattachMediaStream=function(){e.reattachMediaStream.apply(e,arguments)},c.isPhenixEnabled=function(){return e.isEnabled()}),c.webrtcSupported=!0,c.phenixSupported=!0,c.phenixVersion=e.getVersion(),c.onLoaded&&c.onLoaded.call()};e.isEnabled()?i():e.onReady(function(t){t&&(i(),c.onload&&"function"==typeof c.onload&&c.onload())}),e.onLoaded(function(){i()})}else c.phenixSupported=!1;return c}var u=new n(navigator.userAgent).detect(),c={browser:u.browser,browserVersion:u.version,phenixSupported:!1,isPhenixEnabled:function(){return!1},onLoaded:void 0,global:r};return t.assign(a(),{shim:a})}.apply(e,n))||(t.exports=r)},function(t,e,i){var n,r;n=[i(1)],void 0===(r=function(t){"use strict";return function(e){t.RTCPeerConnection=e.RTCPeerConnection,t.RTCSessionDescription=e.RTCSessionDescription,t.RTCIceCandidate=e.RTCIceCandidate}}.apply(e,n))||(t.exports=r)},function(t,e,i){var n,r;n=[i(0),i(3)],void 0===(r=function(t,e){"use strict";function i(t){e.S(t,"cleanup"),this.k=t}return i.prototype.dispose=function(){return this.k.call()},i.prototype.toString=function(){return t.toString(this)},i}.apply(e,n))||(t.exports=r)},function(t,e,i){var n,r;n=[i(0)],void 0===(r=function(t){"use strict";function e(){this.I=[]}return e.prototype.add=function(e){if(!e||!t.S(e.dispose))throw new Error('"disposable" must be a disposable or implement dispose');this.I.push(e)},e.prototype.dispose=function(){var e=[];return t.forEach(this.I,function(t){e.push(t.dispose())}),this.I=[],e},e.prototype.toString=function(){return t.toString(this)},e}.apply(e,n))||(t.exports=r)},function(t,e,i){var n,r;n=[i(10),i(11)],void 0===(r=function(t,e){return{Disposable:t,DisposableList:e}}.apply(e,n))||(t.exports=r)},function(t,e,i){(function(e){var i;!function(e){t.exports=e()}(function(){return function t(e,n,r){function s(a,u){if(!n[a]){if(!e[a]){if(!u&&("function"==typeof i&&i))return i(a,!0);if(o)return i(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var h=n[a]={exports:{}};e[a][0].call(h.exports,function(t){return s(e[a][1][t]||t)},h,h.exports,t,e,n,r)}return n[a].exports}for(var o="function"==typeof i&&i,a=0;a<r.length;a++)s(r[a]);return s}({1:[function(t,e,i){},{}],2:[function(t,i,n){(function(e){"use strict";var n=t("./adapter_factory.js");i.exports=n({window:e.window})}).call(this,void 0!==e?e:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./adapter_factory.js":3}],3:[function(t,e,i){"use strict";e.exports=function(e,i){var n=e&&e.window,r={shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0};for(var s in i)hasOwnProperty.call(i,s)&&(r[s]=i[s]);var o=t("./utils"),a=o.log,u=o.detectBrowser(n),c={browserDetails:u,extractVersion:o.extractVersion,disableLog:o.disableLog,disableWarnings:o.disableWarnings},h=t("./chrome/chrome_shim")||null,d=t("./edge/edge_shim")||null,f=t("./firefox/firefox_shim")||null,l=t("./safari/safari_shim")||null;switch(u.browser){case"chrome":if(!h||!h.shimPeerConnection||!r.shimChrome)return a("Chrome shim is not included in this adapter release."),c;a("adapter.js shimming chrome."),c.browserShim=h,h.shimGetUserMedia(n),h.shimMediaStream(n),o.shimCreateObjectURL(n),h.shimSourceObject(n),h.shimPeerConnection(n),h.shimOnTrack(n),h.shimAddTrackRemoveTrack(n),h.shimGetSendersWithDtmf(n);break;case"firefox":if(!f||!f.shimPeerConnection||!r.shimFirefox)return a("Firefox shim is not included in this adapter release."),c;a("adapter.js shimming firefox."),c.browserShim=f,f.shimGetUserMedia(n),o.shimCreateObjectURL(n),f.shimSourceObject(n),f.shimPeerConnection(n),f.shimOnTrack(n);break;case"edge":if(!d||!d.shimPeerConnection||!r.shimEdge)return a("MS edge shim is not included in this adapter release."),c;a("adapter.js shimming edge."),c.browserShim=d,d.shimGetUserMedia(n),o.shimCreateObjectURL(n),d.shimPeerConnection(n),d.shimReplaceTrack(n);break;case"safari":if(!l||!r.shimSafari)return a("Safari shim is not included in this adapter release."),c;a("adapter.js shimming safari."),c.browserShim=l,o.shimCreateObjectURL(n),l.shimRTCIceServerUrls(n),l.shimCallbacksAPI(n),l.shimLocalStreamsAPI(n),l.shimRemoteStreamsAPI(n),l.shimGetUserMedia(n);break;default:a("Unsupported browser!")}return c}},{"./chrome/chrome_shim":4,"./edge/edge_shim":1,"./firefox/firefox_shim":6,"./safari/safari_shim":8,"./utils":9}],4:[function(t,e,i){"use strict";var n=t("../utils.js"),r=n.log,s={shimMediaStream:function(t){t.MediaStream=t.MediaStream||t.webkitMediaStream},shimOnTrack:function(t){if("object"==typeof t&&t.RTCPeerConnection&&!("ontrack"in t.RTCPeerConnection.prototype)){Object.defineProperty(t.RTCPeerConnection.prototype,"ontrack",{get:function(){return this.T},set:function(t){this.T&&this.removeEventListener("track",this.T),this.addEventListener("track",this.T=t)}});var e=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){var i=this;return i.R||(i.R=function(e){e.stream.addEventListener("addtrack",function(n){var r;r=t.RTCPeerConnection.prototype.getReceivers?i.getReceivers().find(function(t){return t.track.id===n.track.id}):{track:n.track};var s=new Event("track");s.track=n.track,s.receiver=r,s.streams=[e.stream],i.dispatchEvent(s)}),e.stream.getTracks().forEach(function(n){var r;r=t.RTCPeerConnection.prototype.getReceivers?i.getReceivers().find(function(t){return t.track.id===n.id}):{track:n};var s=new Event("track");s.track=n,s.receiver=r,s.streams=[e.stream],i.dispatchEvent(s)})},i.addEventListener("addstream",i.R)),e.apply(i,arguments)}}},shimGetSendersWithDtmf:function(t){if("object"==typeof t&&t.RTCPeerConnection&&!("getSenders"in t.RTCPeerConnection.prototype)&&"createDTMFSender"in t.RTCPeerConnection.prototype){var e=function(t,e){return{track:e,get dtmf(){return void 0===this.C&&("audio"===e.kind?this.C=t.createDTMFSender(e):this.C=null),this.C},x:t}};if(!t.RTCPeerConnection.prototype.getSenders){t.RTCPeerConnection.prototype.getSenders=function(){return this.O=this.O||[],this.O.slice()};var i=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function(t,n){var r=this,s=i.apply(r,arguments);return s||(s=e(r,t),r.O.push(s)),s};var n=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function(t){var e=this;n.apply(e,arguments);var i=e.O.indexOf(t);-1!==i&&e.O.splice(i,1)}}var r=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(t){var i=this;i.O=i.O||[],r.apply(i,[t]),t.getTracks().forEach(function(t){i.O.push(e(i,t))})};var s=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(t){var e=this;e.O=e.O||[],s.apply(e,[e.M[t.id]||t]),t.getTracks().forEach(function(t){var i=e.O.find(function(e){return e.track===t});i&&e.O.splice(e.O.indexOf(i),1)})}}else if("object"==typeof t&&t.RTCPeerConnection&&"getSenders"in t.RTCPeerConnection.prototype&&"createDTMFSender"in t.RTCPeerConnection.prototype&&t.RTCRtpSender&&!("dtmf"in t.RTCRtpSender.prototype)){var o=t.RTCPeerConnection.prototype.getSenders;t.RTCPeerConnection.prototype.getSenders=function(){var t=this,e=o.apply(t,[]);return e.forEach(function(e){e.x=t}),e},Object.defineProperty(t.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this.C&&("audio"===this.track.kind?this.C=this.x.createDTMFSender(this.track):this.C=null),this.C}})}},shimSourceObject:function(t){var e=t&&t.URL;"object"==typeof t&&(!t.HTMLMediaElement||"srcObject"in t.HTMLMediaElement.prototype||Object.defineProperty(t.HTMLMediaElement.prototype,"srcObject",{get:function(){return this.P},set:function(t){var i=this;return this.P=t,this.src&&e.revokeObjectURL(this.src),t?(this.src=e.createObjectURL(t),t.addEventListener("addtrack",function(){i.src&&e.revokeObjectURL(i.src),i.src=e.createObjectURL(t)}),void t.addEventListener("removetrack",function(){i.src&&e.revokeObjectURL(i.src),i.src=e.createObjectURL(t)})):void(this.src="")}}))},shimAddTrackRemoveTrack:function(t){if(!t.RTCPeerConnection.prototype.addTrack){var e=t.RTCPeerConnection.prototype.getLocalStreams;t.RTCPeerConnection.prototype.getLocalStreams=function(){var t=this,i=e.apply(this);return t.q=t.q||{},i.map(function(e){return t.q[e.id]})};var i=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(e){var n=this;if(n.M=n.M||{},n.q=n.q||{},e.getTracks().forEach(function(t){if(n.getSenders().find(function(e){return e.track===t}))throw new DOMException("Track already exists.","InvalidAccessError")}),!n.q[e.id]){var r=new t.MediaStream(e.getTracks());n.M[e.id]=r,n.q[r.id]=e,e=r}i.apply(n,[e])};var n=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(t){var e=this;e.M=e.M||{},e.q=e.q||{},n.apply(e,[e.M[t.id]||t]),delete e.q[e.M[t.id]?e.M[t.id].id:t.id],delete e.M[t.id]},t.RTCPeerConnection.prototype.addTrack=function(e,i){var n=this;if("closed"===n.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var r=[].slice.call(arguments,1);if(1!==r.length||!r[0].getTracks().find(function(t){return t===e}))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(n.getSenders().find(function(t){return t.track===e}))throw new DOMException("Track already exists.","InvalidAccessError");n.M=n.M||{},n.q=n.q||{};var s=n.M[i.id];if(s)s.addTrack(e),n.dispatchEvent(new Event("negotiationneeded"));else{var o=new t.MediaStream([e]);n.M[i.id]=o,n.q[o.id]=i,n.addStream(o)}return n.getSenders().find(function(t){return t.track===e})},t.RTCPeerConnection.prototype.removeTrack=function(t){var e,i=this;if("closed"===i.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!t.x)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(t.x===i))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");i.M=i.M||{},Object.keys(i.M).forEach(function(n){i.M[n].getTracks().find(function(e){return t.track===e})&&(e=i.M[n])}),e&&(1===e.getTracks().length?i.removeStream(e):e.removeTrack(t.track),i.dispatchEvent(new Event("negotiationneeded")))}}},shimPeerConnection:function(t){var e=n.detectBrowser(t);if(t.RTCPeerConnection){var i=t.RTCPeerConnection;t.RTCPeerConnection=function(t,e){if(t&&t.iceServers){for(var r=[],s=0;s<t.iceServers.length;s++){var o=t.iceServers[s];!o.hasOwnProperty("urls")&&o.hasOwnProperty("url")?(n.deprecated("RTCIceServer.url","RTCIceServer.urls"),(o=JSON.parse(JSON.stringify(o))).urls=o.url,r.push(o)):r.push(t.iceServers[s])}t.iceServers=r}return new i(t,e)},t.RTCPeerConnection.prototype=i.prototype,Object.defineProperty(t.RTCPeerConnection,"generateCertificate",{get:function(){return i.generateCertificate}})}else t.RTCPeerConnection=function(e,i){return r("PeerConnection"),e&&e.iceTransportPolicy&&(e.iceTransports=e.iceTransportPolicy),new t.webkitRTCPeerConnection(e,i)},t.RTCPeerConnection.prototype=t.webkitRTCPeerConnection.prototype,t.webkitRTCPeerConnection.generateCertificate&&Object.defineProperty(t.RTCPeerConnection,"generateCertificate",{get:function(){return t.webkitRTCPeerConnection.generateCertificate}});var s=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(t,e,i){var n=this,r=arguments;if(arguments.length>0&&"function"==typeof t)return s.apply(this,arguments);if(0===s.length&&(0===arguments.length||"function"!=typeof arguments[0]))return s.apply(this,[]);var o=function(t){var e={};return t.result().forEach(function(t){var i={id:t.id,timestamp:t.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[t.type]||t.type};t.names().forEach(function(e){i[e]=t.stat(e)}),e[i.id]=i}),e},a=function(t){return new Map(Object.keys(t).map(function(e){return[e,t[e]]}))};return arguments.length>=2?s.apply(this,[function(t){r[1](a(o(t)))},arguments[0]]):new Promise(function(t,e){s.apply(n,[function(e){t(a(o(e)))},e])}).then(e,i)},e.version<51&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(e){var i=t.RTCPeerConnection.prototype[e];t.RTCPeerConnection.prototype[e]=function(){var t=arguments,e=this,n=new Promise(function(n,r){i.apply(e,[t[0],n,r])});return t.length<2?n:n.then(function(){t[1].apply(null,[])},function(e){t.length>=3&&t[2].apply(null,[e])})}}),e.version<52&&["createOffer","createAnswer"].forEach(function(e){var i=t.RTCPeerConnection.prototype[e];t.RTCPeerConnection.prototype[e]=function(){var t=this;if(arguments.length<1||1===arguments.length&&"object"==typeof arguments[0]){var e=1===arguments.length?arguments[0]:void 0;return new Promise(function(n,r){i.apply(t,[n,r,e])})}return i.apply(this,arguments)}}),["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(e){var i=t.RTCPeerConnection.prototype[e];t.RTCPeerConnection.prototype[e]=function(){return arguments[0]=new("addIceCandidate"===e?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),i.apply(this,arguments)}});var o=t.RTCPeerConnection.prototype.addIceCandidate;t.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?o.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}};e.exports={shimMediaStream:s.shimMediaStream,shimOnTrack:s.shimOnTrack,shimAddTrackRemoveTrack:s.shimAddTrackRemoveTrack,shimGetSendersWithDtmf:s.shimGetSendersWithDtmf,shimSourceObject:s.shimSourceObject,shimPeerConnection:s.shimPeerConnection,shimGetUserMedia:t("./getusermedia")}},{"../utils.js":9,"./getusermedia":5}],5:[function(t,e,i){"use strict";var n=t("../utils.js"),r=n.log;e.exports=function(t){var e=n.detectBrowser(t),i=t&&t.navigator,s=function(t){if("object"!=typeof t||t.mandatory||t.optional)return t;var e={};return Object.keys(t).forEach(function(i){if("require"!==i&&"advanced"!==i&&"mediaSource"!==i){var n="object"==typeof t[i]?t[i]:{ideal:t[i]};void 0!==n.exact&&"number"==typeof n.exact&&(n.min=n.max=n.exact);var r=function(t,e){return t?t+e.charAt(0).toUpperCase()+e.slice(1):"deviceId"===e?"sourceId":e};if(void 0!==n.ideal){e.optional=e.optional||[];var s={};"number"==typeof n.ideal?(s[r("min",i)]=n.ideal,e.optional.push(s),(s={})[r("max",i)]=n.ideal,e.optional.push(s)):(s[r("",i)]=n.ideal,e.optional.push(s))}void 0!==n.exact&&"number"!=typeof n.exact?(e.mandatory=e.mandatory||{},e.mandatory[r("",i)]=n.exact):["min","max"].forEach(function(t){void 0!==n[t]&&(e.mandatory=e.mandatory||{},e.mandatory[r(t,i)]=n[t])})}}),t.advanced&&(e.optional=(e.optional||[]).concat(t.advanced)),e},o=function(t,n){if((t=JSON.parse(JSON.stringify(t)))&&"object"==typeof t.audio){var o=function(t,e,i){e in t&&!(i in t)&&(t[i]=t[e],delete t[e])};o((t=JSON.parse(JSON.stringify(t))).audio,"autoGainControl","googAutoGainControl"),o(t.audio,"noiseSuppression","googNoiseSuppression"),t.audio=s(t.audio)}if(t&&"object"==typeof t.video){var a=t.video.facingMode;a=a&&("object"==typeof a?a:{ideal:a});var u,c=e.version<61;if(a&&("user"===a.exact||"environment"===a.exact||"user"===a.ideal||"environment"===a.ideal)&&(!i.mediaDevices.getSupportedConstraints||!i.mediaDevices.getSupportedConstraints().facingMode||c)&&(delete t.video.facingMode,"environment"===a.exact||"environment"===a.ideal?u=["back","rear"]:"user"!==a.exact&&"user"!==a.ideal||(u=["front"]),u))return i.mediaDevices.enumerateDevices().then(function(e){var i=(e=e.filter(function(t){return"videoinput"===t.kind})).find(function(t){return u.some(function(e){return-1!==t.label.toLowerCase().indexOf(e)})});return!i&&e.length&&-1!==u.indexOf("back")&&(i=e[e.length-1]),i&&(t.video.deviceId=a.exact?{exact:i.deviceId}:{ideal:i.deviceId}),t.video=s(t.video),r("chrome: "+JSON.stringify(t)),n(t)});t.video=s(t.video)}return r("chrome: "+JSON.stringify(t)),n(t)},a=function(t){return{name:{PermissionDeniedError:"NotAllowedError",InvalidStateError:"NotReadableError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotReadableError",MediaDeviceKillSwitchOn:"NotReadableError"}[t.name]||t.name,message:t.message,constraint:t.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}};i.getUserMedia=function(t,e,n){o(t,function(t){i.webkitGetUserMedia(t,e,function(t){n(a(t))})})};var u=function(t){return new Promise(function(e,n){i.getUserMedia(t,e,n)})};if(i.mediaDevices||(i.mediaDevices={getUserMedia:u,enumerateDevices:function(){return new Promise(function(e){var i={audio:"audioinput",video:"videoinput"};return t.MediaStreamTrack.getSources(function(t){e(t.map(function(t){return{label:t.label,kind:i[t.kind],deviceId:t.id,groupId:""}}))})})},getSupportedConstraints:function(){return{deviceId:!0,echoCancellation:!0,facingMode:!0,frameRate:!0,height:!0,width:!0}}}),i.mediaDevices.getUserMedia){var c=i.mediaDevices.getUserMedia.bind(i.mediaDevices);i.mediaDevices.getUserMedia=function(t){return o(t,function(t){return c(t).then(function(e){if(t.audio&&!e.getAudioTracks().length||t.video&&!e.getVideoTracks().length)throw e.getTracks().forEach(function(t){t.stop()}),new DOMException("","NotFoundError");return e},function(t){return Promise.reject(a(t))})})}}else i.mediaDevices.getUserMedia=function(t){return u(t)};void 0===i.mediaDevices.addEventListener&&(i.mediaDevices.addEventListener=function(){r("Dummy mediaDevices.addEventListener called.")}),void 0===i.mediaDevices.removeEventListener&&(i.mediaDevices.removeEventListener=function(){r("Dummy mediaDevices.removeEventListener called.")})}},{"../utils.js":9}],6:[function(t,e,i){"use strict";var n=t("../utils"),r={shimOnTrack:function(t){"object"!=typeof t||!t.RTCPeerConnection||"ontrack"in t.RTCPeerConnection.prototype||Object.defineProperty(t.RTCPeerConnection.prototype,"ontrack",{get:function(){return this.T},set:function(t){this.T&&(this.removeEventListener("track",this.T),this.removeEventListener("addstream",this.R)),this.addEventListener("track",this.T=t),this.addEventListener("addstream",this.R=function(t){t.stream.getTracks().forEach(function(e){var i=new Event("track");i.track=e,i.receiver={track:e},i.streams=[t.stream],this.dispatchEvent(i)}.bind(this))}.bind(this))}})},shimSourceObject:function(t){"object"==typeof t&&(!t.HTMLMediaElement||"srcObject"in t.HTMLMediaElement.prototype||Object.defineProperty(t.HTMLMediaElement.prototype,"srcObject",{get:function(){return this.mozSrcObject},set:function(t){this.mozSrcObject=t}}))},shimPeerConnection:function(t){var e=n.detectBrowser(t);if("object"==typeof t&&(t.RTCPeerConnection||t.mozRTCPeerConnection)){t.RTCPeerConnection||(t.RTCPeerConnection=function(i,n){if(e.version<38&&i&&i.iceServers){for(var r=[],s=0;s<i.iceServers.length;s++){var o=i.iceServers[s];if(o.hasOwnProperty("urls"))for(var a=0;a<o.urls.length;a++){var u={url:o.urls[a]};0===o.urls[a].indexOf("turn")&&(u.username=o.username,u.credential=o.credential),r.push(u)}else r.push(i.iceServers[s])}i.iceServers=r}return new t.mozRTCPeerConnection(i,n)},t.RTCPeerConnection.prototype=t.mozRTCPeerConnection.prototype,t.mozRTCPeerConnection.generateCertificate&&Object.defineProperty(t.RTCPeerConnection,"generateCertificate",{get:function(){return t.mozRTCPeerConnection.generateCertificate}}),t.RTCSessionDescription=t.mozRTCSessionDescription,t.RTCIceCandidate=t.mozRTCIceCandidate),["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(e){var i=t.RTCPeerConnection.prototype[e];t.RTCPeerConnection.prototype[e]=function(){return arguments[0]=new("addIceCandidate"===e?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),i.apply(this,arguments)}});var i=t.RTCPeerConnection.prototype.addIceCandidate;t.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?i.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())};var r={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},s=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(t,i,n){return s.apply(this,[t||null]).then(function(t){if(e.version<48&&(t=function(t){var e=new Map;return Object.keys(t).forEach(function(i){e.set(i,t[i]),e[i]=t[i]}),e}(t)),e.version<53&&!i)try{t.forEach(function(t){t.type=r[t.type]||t.type})}catch(e){if("TypeError"!==e.name)throw e;t.forEach(function(e,i){t.set(i,Object.assign({},e,{type:r[e.type]||e.type}))})}return t}).then(i,n)}}}};e.exports={shimOnTrack:r.shimOnTrack,shimSourceObject:r.shimSourceObject,shimPeerConnection:r.shimPeerConnection,shimGetUserMedia:t("./getusermedia")}},{"../utils":9,"./getusermedia":7}],7:[function(t,e,i){"use strict";var n=t("../utils"),r=n.log;e.exports=function(t){var e=n.detectBrowser(t),i=t&&t.navigator,s=t&&t.MediaStreamTrack,o=function(t){return{name:{InternalError:"NotReadableError",NotSupportedError:"TypeError",PermissionDeniedError:"NotAllowedError",SecurityError:"NotAllowedError"}[t.name]||t.name,message:{"The operation is insecure.":"The request is not allowed by the user agent or the platform in the current context."}[t.message]||t.message,constraint:t.constraint,toString:function(){return this.name+(this.message&&": ")+this.message}}},a=function(t,n,s){var a=function(t){if("object"!=typeof t||t.require)return t;var e=[];return Object.keys(t).forEach(function(i){if("require"!==i&&"advanced"!==i&&"mediaSource"!==i){var n=t[i]="object"==typeof t[i]?t[i]:{ideal:t[i]};if(void 0===n.min&&void 0===n.max&&void 0===n.exact||e.push(i),void 0!==n.exact&&("number"==typeof n.exact?n.min=n.max=n.exact:t[i]=n.exact,delete n.exact),void 0!==n.ideal){t.advanced=t.advanced||[];var r={};"number"==typeof n.ideal?r[i]={min:n.ideal,max:n.ideal}:r[i]=n.ideal,t.advanced.push(r),delete n.ideal,Object.keys(n).length||delete t[i]}}}),e.length&&(t.require=e),t};return t=JSON.parse(JSON.stringify(t)),e.version<38&&(r("spec: "+JSON.stringify(t)),t.audio&&(t.audio=a(t.audio)),t.video&&(t.video=a(t.video)),r("ff37: "+JSON.stringify(t))),i.mozGetUserMedia(t,n,function(t){s(o(t))})};if(i.mediaDevices||(i.mediaDevices={getUserMedia:function(t){return new Promise(function(e,i){a(t,e,i)})},addEventListener:function(){},removeEventListener:function(){}}),i.mediaDevices.enumerateDevices=i.mediaDevices.enumerateDevices||function(){return new Promise(function(t){t([{kind:"audioinput",deviceId:"default",label:"",groupId:""},{kind:"videoinput",deviceId:"default",label:"",groupId:""}])})},e.version<41){var u=i.mediaDevices.enumerateDevices.bind(i.mediaDevices);i.mediaDevices.enumerateDevices=function(){return u().then(void 0,function(t){if("NotFoundError"===t.name)return[];throw t})}}if(e.version<49){var c=i.mediaDevices.getUserMedia.bind(i.mediaDevices);i.mediaDevices.getUserMedia=function(t){return c(t).then(function(e){if(t.audio&&!e.getAudioTracks().length||t.video&&!e.getVideoTracks().length)throw e.getTracks().forEach(function(t){t.stop()}),new DOMException("The object can not be found here.","NotFoundError");return e},function(t){return Promise.reject(o(t))})}}if(!(e.version>55&&"autoGainControl"in i.mediaDevices.getSupportedConstraints())){var h=function(t,e,i){e in t&&!(i in t)&&(t[i]=t[e],delete t[e])},d=i.mediaDevices.getUserMedia.bind(i.mediaDevices);if(i.mediaDevices.getUserMedia=function(t){return"object"==typeof t&&"object"==typeof t.audio&&(t=JSON.parse(JSON.stringify(t)),h(t.audio,"autoGainControl","mozAutoGainControl"),h(t.audio,"noiseSuppression","mozNoiseSuppression")),d(t)},s&&s.prototype.getSettings){var f=s.prototype.getSettings;s.prototype.getSettings=function(){var t=f.apply(this,arguments);return h(t,"mozAutoGainControl","autoGainControl"),h(t,"mozNoiseSuppression","noiseSuppression"),t}}if(s&&s.prototype.applyConstraints){var l=s.prototype.applyConstraints;s.prototype.applyConstraints=function(t){return"audio"===this.kind&&"object"==typeof t&&(t=JSON.parse(JSON.stringify(t)),h(t,"autoGainControl","mozAutoGainControl"),h(t,"noiseSuppression","mozNoiseSuppression")),l.apply(this,[t])}}}i.getUserMedia=function(t,r,s){return e.version<44?a(t,r,s):(n.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),void i.mediaDevices.getUserMedia(t).then(r,s))}}},{"../utils":9}],8:[function(t,e,i){"use strict";var n=t("../utils"),r={shimLocalStreamsAPI:function(t){if("object"==typeof t&&t.RTCPeerConnection){if("getLocalStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getLocalStreams=function(){return this.D||(this.D=[]),this.D}),"getStreamById"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getStreamById=function(t){var e=null;return this.D&&this.D.forEach(function(i){i.id===t&&(e=i)}),this.A&&this.A.forEach(function(i){i.id===t&&(e=i)}),e}),!("addStream"in t.RTCPeerConnection.prototype)){var e=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addStream=function(t){this.D||(this.D=[]),-1===this.D.indexOf(t)&&this.D.push(t);var i=this;t.getTracks().forEach(function(n){e.call(i,n,t)})},t.RTCPeerConnection.prototype.addTrack=function(t,i){i&&(this.D?-1===this.D.indexOf(i)&&this.D.push(i):this.D=[i]),e.call(this,t,i)}}"removeStream"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.removeStream=function(t){this.D||(this.D=[]);var e=this.D.indexOf(t);if(-1!==e){this.D.splice(e,1);var i=this,n=t.getTracks();this.getSenders().forEach(function(t){-1!==n.indexOf(t.track)&&i.removeTrack(t)})}})}},shimRemoteStreamsAPI:function(t){"object"==typeof t&&t.RTCPeerConnection&&("getRemoteStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getRemoteStreams=function(){return this.A?this.A:[]}),"onaddstream"in t.RTCPeerConnection.prototype||Object.defineProperty(t.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this.N},set:function(t){this.N&&(this.removeEventListener("addstream",this.N),this.removeEventListener("track",this.F)),this.addEventListener("addstream",this.N=t),this.addEventListener("track",this.F=function(t){var e=t.streams[0];if(this.A||(this.A=[]),!(this.A.indexOf(e)>=0)){this.A.push(e);var i=new Event("addstream");i.stream=t.streams[0],this.dispatchEvent(i)}}.bind(this))}}))},shimCallbacksAPI:function(t){if("object"==typeof t&&t.RTCPeerConnection){var e=t.RTCPeerConnection.prototype,i=e.createOffer,n=e.createAnswer,r=e.setLocalDescription,s=e.setRemoteDescription,o=e.addIceCandidate;e.createOffer=function(t,e){var n=arguments.length>=2?arguments[2]:arguments[0],r=i.apply(this,[n]);return e?(r.then(t,e),Promise.resolve()):r},e.createAnswer=function(t,e){var i=arguments.length>=2?arguments[2]:arguments[0],r=n.apply(this,[i]);return e?(r.then(t,e),Promise.resolve()):r};var a=function(t,e,i){var n=r.apply(this,[t]);return i?(n.then(e,i),Promise.resolve()):n};e.setLocalDescription=a,a=function(t,e,i){var n=s.apply(this,[t]);return i?(n.then(e,i),Promise.resolve()):n},e.setRemoteDescription=a,a=function(t,e,i){var n=o.apply(this,[t]);return i?(n.then(e,i),Promise.resolve()):n},e.addIceCandidate=a}},shimGetUserMedia:function(t){var e=t&&t.navigator;e.getUserMedia||(e.webkitGetUserMedia?e.getUserMedia=e.webkitGetUserMedia.bind(e):e.mediaDevices&&e.mediaDevices.getUserMedia&&(e.getUserMedia=function(t,i,n){e.mediaDevices.getUserMedia(t).then(i,n)}.bind(e)))},shimRTCIceServerUrls:function(t){var e=t.RTCPeerConnection;t.RTCPeerConnection=function(t,i){if(t&&t.iceServers){for(var r=[],s=0;s<t.iceServers.length;s++){var o=t.iceServers[s];!o.hasOwnProperty("urls")&&o.hasOwnProperty("url")?(n.deprecated("RTCIceServer.url","RTCIceServer.urls"),(o=JSON.parse(JSON.stringify(o))).urls=o.url,delete o.url,r.push(o)):r.push(t.iceServers[s])}t.iceServers=r}return new e(t,i)},t.RTCPeerConnection.prototype=e.prototype,Object.defineProperty(t.RTCPeerConnection,"generateCertificate",{get:function(){return e.generateCertificate}})}};e.exports={shimCallbacksAPI:r.shimCallbacksAPI,shimLocalStreamsAPI:r.shimLocalStreamsAPI,shimRemoteStreamsAPI:r.shimRemoteStreamsAPI,shimGetUserMedia:r.shimGetUserMedia,shimRTCIceServerUrls:r.shimRTCIceServerUrls}},{"../utils":9}],9:[function(t,e,i){"use strict";var n=!0,r=!0,s={disableLog:function(t){return"boolean"!=typeof t?new Error("Argument type: "+typeof t+". Please use a boolean."):(n=t,t?"adapter.js logging disabled":"adapter.js logging enabled")},disableWarnings:function(t){return"boolean"!=typeof t?new Error("Argument type: "+typeof t+". Please use a boolean."):(r=!t,"adapter.js deprecation warnings "+(t?"disabled":"enabled"))},log:function(){if("object"==typeof window){if(n)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}},deprecated:function(t,e){r&&console.warn(t+" is deprecated, please use "+e+" instead.")},extractVersion:function(t,e,i){var n=t.match(e);return n&&n.length>=i&&parseInt(n[i],10)},detectBrowser:function(t){var e=t&&t.navigator,i={browser:null,version:null};if(void 0===t||!t.navigator)return i.browser="Not a browser.",i;if(e.mozGetUserMedia)i.browser="firefox",i.version=this.extractVersion(e.userAgent,/Firefox\/(\d+)\./,1);else if(e.webkitGetUserMedia)if(t.webkitRTCPeerConnection)i.browser="chrome",i.version=this.extractVersion(e.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else{if(!e.userAgent.match(/Version\/(\d+).(\d+)/))return i.browser="Unsupported webkit-based browser with GUM support but no WebRTC support.",i;i.browser="safari",i.version=this.extractVersion(e.userAgent,/AppleWebKit\/(\d+)\./,1)}else if(e.mediaDevices&&e.userAgent.match(/Edge\/(\d+).(\d+)$/))i.browser="edge",i.version=this.extractVersion(e.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!e.mediaDevices||!e.userAgent.match(/AppleWebKit\/(\d+)\./))return i.browser="Not a supported browser.",i;i.browser="safari",i.version=this.extractVersion(e.userAgent,/AppleWebKit\/(\d+)\./,1)}return i},shimCreateObjectURL:function(t){var e=t&&t.URL;if("object"==typeof t&&t.HTMLMediaElement&&"srcObject"in t.HTMLMediaElement.prototype){var i=e.createObjectURL.bind(e),n=e.revokeObjectURL.bind(e),r=new Map,o=0;e.createObjectURL=function(t){if("getTracks"in t){var e="polyblob:"+ ++o;return r.set(e,t),s.deprecated("URL.createObjectURL(stream)","elem.srcObject = stream"),e}return i(t)},e.revokeObjectURL=function(t){n(t),r.delete(t)};var a=Object.getOwnPropertyDescriptor(t.HTMLMediaElement.prototype,"src");Object.defineProperty(t.HTMLMediaElement.prototype,"src",{get:function(){return a.get.apply(this)},set:function(t){return this.srcObject=r.get(t)||null,a.set.apply(this,[t])}});var u=t.HTMLMediaElement.prototype.setAttribute;t.HTMLMediaElement.prototype.setAttribute=function(){return 2===arguments.length&&"src"===(""+arguments[0]).toLowerCase()&&(this.srcObject=r.get(arguments[1])||null),u.apply(this,arguments)}}}};e.exports={log:s.log,deprecated:s.deprecated,disableLog:s.disableLog,disableWarnings:s.disableWarnings,extractVersion:s.extractVersion,shimCreateObjectURL:s.shimCreateObjectURL,detectBrowser:s.detectBrowser.bind(s)}},{}]},{},[2])(2)})}).call(e,i(5))},function(t,e,i){"use strict";var n,r;n=[i(8),i(9),i(2)],void 0===(r=function(t,e,i){return t.PhenixVideo=i,t.onLoaded=function(){e(t)},t.onLoaded(),t}.apply(e,n))||(t.exports=r)},function(t,e,i){var n,r;n=[i(0),i(3),i(7),i(6),i(2)],void 0===(r=function(t,e,i,n,r){"use strict";function s(){var t=this;this.j=function(){var t=document.createElement("div");return t.id="phenixRTC",t.style.cssText="visibility:hidden !important;width:0px !important;height:0px !important;margin:0px !important;padding:0px !important;border-style:none !important;border-width:0px !important;max-width:0px !important;max-height:0px !important;outline:none !important",document.body.appendChild(t),t}(),this.U="?";try{this.L=function(t){var e=document.createElement("object");return e.type="application/x-phenix-rtc",t.appendChild(e),e}(this.j),this.L.onunload=function(){t.f=!1},(new n).waitForReady(this.L,function(e){t.f=!0,t.v=!0===e,t.U=t.L.phenixVersion||"?.?.?.?",f(e?"Phenix RTC "+t.U:"No Phenix RTC"),t.g&&t.g(t.v)})}catch(t){l("Error while loading Phenix RTC"+t)}}function o(){this.j&&document.getElementById("phenixRTC")!==this.j&&(document.body.appendChild(this.j),this.B&&this.B.call(this))}function a(e){var i=function(){var i=null;switch(arguments.length){case 0:i=new e;break;case 1:i=new e(arguments[0]);break;case 2:i=new e(arguments[0],arguments[1]);break;case 3:i=new e(arguments[0],arguments[1],arguments[2]);break;case 4:i=new e(arguments[0],arguments[1],arguments[2],arguments[3]);break;case 5:i=new e(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4]);break;default:throw new Error("Unsupported number of arguments in Phenix Object Constructor")}return i.phenixAddEventListener=t.bind(u,i),i.phenixRemoveEventListener=t.bind(c,i),i};return t.forOwn(e,function(t,e){i[e]=t}),i}function u(t,i){e.W(t,"name"),e.S(i,"listener"),h.call(this,t),function(t,e){if(!this.events||!this.events[t])throw new Error("No event observable for event: "+name);this.events[t].listeners.push(e)}.call(this,t,i)}function c(t,e){d.call(this,t,e)}function h(e){if(!this.events||!this.events[e]){this.events||(this.events={});var n=this.events;n[e]={observable:(new i.Observable).extend({timeout:0}),subscription:null,listeners:[]},this.phenixSetEventListener(e,t.bind(n[e].observable.setValue,n[e].observable)),n[e].subscription=n[e].observable.subscribe(function(i){var r=n[e].listeners;t.forEach(r,function(t){t(i)})})}}function d(e,i){this.events&&this.events.events[e]&&(this.events[e].listeners=t.filter(this.events[e].listeners,function(t){return i!==t}))}var f=function(){console.log.apply(console,arguments)}||function(){},l=function(){console.error.apply(console,arguments)}||f;return s.prototype.onReady=function(t){var e=this;this.f?setTimeout(function(){t(e.v)},1):this.g=t},s.prototype.onLoaded=function(t){this.B=t},s.prototype.isLoaded=function(){return!0===this.f},s.isSupported=function(){if(navigator.plugins)for(var t=navigator.plugins,e=0;e<t.length;e++)if(t[e].name.indexOf("PhenixRTC")>=0)return!0;if(navigator.userAgent&&(navigator.userAgent.match(/MSIE/)||navigator.userAgent.match(/Trident/)))try{return new window.ActiveXObject("PhenixP2P.RTC"),!0}catch(t){return!1}return!1},s.prototype.isEnabled=function(){return o.call(this),this.L&&void 0!==this.L.phenixVersion},s.prototype.getVersion=function(){return o.call(this),this.U},s.prototype.getRTCPeerConnectionConstructor=function(){return o.call(this),a(this.L.RTCPeerConnection)},s.prototype.getRTCSessionDescriptionConstructor=function(){return o.call(this),a(this.L.RTCSessionDescription)},s.prototype.getRTCIceCandidateConstructor=function(){return o.call(this),a(this.L.RTCIceCandidate)},s.prototype.getSourcesDelegate=function(){var t=this;return function(e){return o.call(t),t.L.getSources(e)}},s.prototype.getUserMediaDelegate=function(){var t=this;return function(e,i,n){return o.call(t),t.L.getUserMedia(e,i,n)}},s.prototype.getStatsDelegate=function(){return function(t,e,i,n){return t.getStats(e,i,n)}},s.prototype.attachMediaStream=function(t,e){return o.call(this),function(t,e){if(!t)throw new Error("Can not attach a stream to a undefined element");if(t.phenixVersion)return t.src=e,t;var i=new r(t,e,!0);return i.getElement().phenixPresenter=i,i.getElement()}.call(this,t,e)},s.prototype.reattachMediaStream=function(t,e){return o.call(this),this.attachMediaStream(t,e.src)},s}.apply(e,n))||(t.exports=r)},function(t,e,i){var n,r;n=[i(0),i(4),i(13),i(1),i(2)],void 0===(r=function(t,e,i,n,r){"use strict";function s(){if(w=n.RTCPeerConnection,b=n.RTCSessionDescription,S=n.RTCIceCandidate,navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices&&(k=t.bind(c,null,"input")),navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices&&(E=t.bind(c,null,"output")),(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia||n.getUserMedia)&&(I=o),!n.RTCPeerConnection)return g("[%s] browser version [%s] does not appear to be WebRTC-capable",y.browser,y.version);switch(y.browser){case"Firefox":g("Firefox detected",y),R=function(t,e){g("Attaching media stream");var i=t.muted;return y.version>57&&(t.srcObject=e),t.mozSrcObject=e,t.play(),!0===i&&(t.muted=!0),t},x=function(t,e){g("Reattaching media stream");var i=t.muted;return y.version>57&&(t.srcObject=e.srcObject),t.mozSrcObject=e.mozSrcObject,t.play(),!0===i&&(t.muted=!0),t},T=function(e,i,n,r){e.getStats(i,t.bind(l,this,e,n),r)},O=!0;break;case"Opera":g("Opera detected",y),R=h,x=f,T=function(e,i,n,r){e.getStats(t.bind(l,this,e,n),i,r)},O=!0;break;case"Chrome":g("Webkit detected",y),R=h,x=f,T=function(e,i,n,r){e.getStats(t.bind(l,this,e,n),i,r)},O=!0;break;case"Edge":g("Edge detected",y),R=h,x=f,T=function(e,i,n,r){e.getStats(i,t.bind(l,this,e,n),r)},O=!0;break;case"Safari":g("Safari detected",y),R=function(e,i){return t.V(i)&&(e.__phenixHasPlayedWebRtc=!0),h(e,i)},C=function(t,e){return t.__phenixHasPlayedWebRtc?((t=new r(t,e,!1).getElement()).play(),t):d(t,e)},x=f,T=function(e,i,n,r){e.getStats(i).then(t.bind(l,this,e,n),r)},O=!0;break;case"ReactNative":g("React Native detected",y),R=function(){g("attachMediaStream not supported in React Native environment")},C=function(){g("attachUriStream not supported in React Native environment")},x=function(){g("reattachMediaStream not supported in React Native environment")},T=function(e,i,n,r){e.getStats(i).then(t.bind(l,this,e,n),r)},O=!0;break;default:g("Browser does not appear to be WebRTC-capable",y)}}function o(e,i,r){var s=t.bind(a,this,e,i,r);return navigator&&t.S(navigator.getUserMedia)?navigator.getUserMedia(e,s,r):n&&t.S(n.getUserMedia)?n.getUserMedia(e,s,r):void 0}function a(t,e,i,n){setTimeout(function(){for(var r=n.getTracks(),s=0;s<r.length;s++){var o=r[s];if(o.onended=function(t){g(t.timeStamp,"Track",o.id,o.label,"ended")},g("Track",o.id,o.label,r[s].kind,"readyState=",r[s].readyState),"ended"===o.readyState)return u("User media not available",i,r)}var a=(t.audio?1:0)+(t.video?1:0);return r.length!==a?u("Unable to get all requested user media.",i,r):void e(n)},100)}function u(t,e,i){try{var n=new Error(t);n.code="unavailable",e(n)}finally{!function(t){for(var e=0;e<t.length;e++)t[e].stop()}(i)}}function c(t,e){if("input"!==t&&"output"!==t)throw new Error("Unsupported device type "+t);navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices().then(function(i){var n=[];i.forEach(function(e){e.kind==="audio"+t?n.push({kind:"audio",id:e.deviceId,label:e.label}):e.kind==="video"+t&&n.push({kind:"video",id:e.deviceId,label:e.label})}),e(n)})}function h(t,e){return void 0!==t.srcObject?t.srcObject=e:void 0!==t.mozSrcObject?t.mozSrcObject=e:void 0!==t.src?t.src=URL.createObjectURL(e):g("Error attaching stream to element."),t.play(),t}function d(t,e){return t.src=e,t.play(),t}function f(t,e){return t.src=e.src,t}function l(t,e,i){e(p(t,i))}function p(e,i){switch(y.browser){case"Edge":i.forEach(function(t){t.mediaType=m(e,t.codecId),t.bytesSent=v(t.packetsSent,t.mediaType),t.bytesReceived=v(t.packetsReceived,t.mediaType)});break;case"Safari":i.forEach(function(e){t.includes(e.id.toLowerCase(),"audio")&&t.includes(e.id.toLowerCase(),"rtp")&&(e.mediaType="audio"),t.includes(e.id.toLowerCase(),"video")&&t.includes(e.id.toLowerCase(),"rtp")&&(e.mediaType="video")})}return i}function m(e,i){var n;if(i)return function(e,i){var n=e.localDescription.sdp.split("m="),r=e.remoteDescription.sdp.split("m=");n.length===r.length&&t.findIndex(n,function(t,e){return i(t)})}(e,function(e){t.startsWith(e,"video")&&t.includes(e.toLowerCase(),i.toLowerCase())&&(n="video"),t.startsWith(e,"audio")&&t.includes(e.toLowerCase(),i.toLowerCase())&&(n="audio")}),n}function v(t,e){var i=parseInt(t)||0;return"audio"===e?100*i:"video"===e?1080*i:void 0}var g=function(){console.log.apply(console,arguments)},y=new e(navigator.userAgent).detect(),w=n.RTCPeerConnection,b=n.RTCSessionDescription,S=n.RTCIceCandidate,k=null,E=null,I=null,T=null,R=null,C=null,x=null,O=!1;return function(){s();var t={RTCPeerConnection:w,RTCSessionDescription:b,RTCIceCandidate:S,getSources:k,getDestinations:E,getUserMedia:I,getStats:T,attachMediaStream:R,attachUriStream:C||d,reattachMediaStream:x,webrtcSupported:O,exportGlobal:function(){n.RTCPeerConnection=t.RTCPeerConnection,n.RTCSessionDescription=t.RTCSessionDescription,n.RTCIceCandidate=t.RTCIceCandidate}};return t}}.apply(e,n))||(t.exports=r)}]))},function(t,e,i){var n,r;n=[i(80),i(79)],void 0===(r=function(t,e){return{Disposable:t,DisposableList:e}}.apply(e,n))||(t.exports=r)},function(t,e,i){var n,r;n=[i(22),i(72)],void 0===(r=function(t,e){return{Event:t,NamedEvents:e}}.apply(e,n))||(t.exports=r)},function(t,e,i){var n,r;n=[i(54)],void 0===(r=function(t){"use strict";return t}.apply(e,n))||(t.exports=r)},function(t,e,i){var n;void 0===(n=function(){"use strict";return{networkStates:{networkEmpty:{id:0,name:"NETWORK_EMPTY"},networkIdle:{id:1,name:"NETWORK_IDLE"},networkLoading:{id:2,name:"NETWORK_LOADING"},networkNoSource:{id:3,name:"NETWORK_NO_SOURCE"}},types:{realTime:{id:0,name:"RealTime"},dash:{id:1,name:"dash"},hls:{id:2,name:"hls"},rtmp:{id:0,name:"rtmp"}},streamEvents:{playerEnded:{id:0,name:"playerended"},playerError:{id:1,name:"playererror"},stopped:{id:2,name:"stopped"}},rendererEvents:{ended:{id:0,name:"ended"},error:{id:1,name:"error"}}}}.apply(e,[]))||(t.exports=n)},function(t,e,i){var n,r;n=[i(24),i(78),i(77)],void 0===(r=function(t,e,i){"use strict";return{Observable:t,ObservableArray:e,ObservableMonitor:i}}.apply(e,n))||(t.exports=r)},function(t,e,i){var n,r;n=[i(75)],void 0===(r=function(t){"use strict";return t()}.apply(e,n))||(t.exports=r)},function(t,e,i){var n,r;n=[i(76),i(73),i(13)],void 0===(r=function(t,e,i){"use strict";return{createLogger:function(){return new t},Logger:t,ConsoleAppender:e,level:i.level}}.apply(e,n))||(t.exports=r)},function(t,e,i){var n;void 0===(n=function(){"use strict";return{isSupported:!1}}.apply(e,[]))||(t.exports=n)},function(t,e,i){var n,r;n=[i(0),i(1),i(4)],void 0===(r=function(t,e,i){"use strict";var n=500,r=15;function s(t,e){if(!t)throw new Error("'logger' must be specified.");this.z=t,this.G=new i.Event,this.J=null,this.H=!1,this.K=null,this.Q={pollFrequency:n,previousWidth:0,previousHeight:0},e&&e.pollFrequency&&(this.Q.pollFrequency=e.pollFrequency>=r?e.pollFrequency:r),this.X=null}function o(){if(this.H&&!this.J&&0!==this.G.size()){var t=this;this.Q.previousWidth=this.K.videoWidth,this.Q.previousHeight=this.K.videoHeight,this.J=setInterval(function(){t.K.videoWidth===t.Q.previousWidth&&t.K.videoHeight===t.Q.previousHeight||(t.Q.previousWidth=t.K.videoWidth,t.Q.previousHeight=t.K.videoHeight,t.G.fireAsync([t.X,{width:t.K.videoWidth,height:t.K.videoHeight}]))},t.Q.pollFrequency)}}return s.prototype.start=function(e,i){(function(e,i){i&&!t.isUndefined(i.videoWidth)||this.z.warn("Attempting to start dimensions changed monitor without providing proper 'video' element."),this.X=e,this.K=i,this.H=!0,o.call(this)}).call(this,e,i)},s.prototype.stop=function(){(function(){this.H=!1,this.J&&(clearInterval(this.J),this.J=null),this.G.dispose()}).call(this)},s.prototype.addVideoDisplayDimensionsChangedCallback=function(t){return e.S(t,"addVideoDisplayDimensionsChangedCallback"),o.call(this),this.G.listen(t)},s.prototype.toString=function(){return"DimensionsChangedMonitor[pollFrequency="+this.Q.pollFrequency+", previousHeight="+this.Q.previousHeight+", previousWidth="+this.Q.previousHeight+", state="+(this.J?"running":"stopped")+"]"},s}.apply(e,n))||(t.exports=r)},function(t,e,i){var n,r;n=[i(68),i(57),i(19)],void 0===(r=function(t,e,i){return{MQWebSocket:t,BatchHttpProto:e,MQService:i}}.apply(e,n))||(t.exports=r)},function(t,e,i){var n;void 0===(n=function(){"use strict";return{level:{TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,FATAL:5}}}.apply(e,[]))||(t.exports=n)},function(t,e,i){var n,r;n=[i(0),i(1),i(2),i(28)],void 0===(r=function(t,e,i,n){"use strict";function r(i,n){e.V(i,"pcast"),n&&e.V(n,"options"),n&&n.screenShare&&e.S(n.screenShare,"options.screenShare"),this.Z=i,this.z=i.getLogger(),this.$=n||{},this.Y=t.get(n,["onScreenShare"])}return r.prototype.getUserMedia=function(r,s){e.V(r,"deviceOptions");var o=new n(this.$),a=o.getDefaultResolution(),u=o.getDefaultFrameRate();(function e(n,r,s,o,a){var u=this.getVendorSpecificConstraints(n,r||{},s),c=!!u.video,h=this;this.Z.getUserMedia(u,function(u,d,f,l){if("ok"===d)return a(null,{userMedia:f,options:{frameRate:c?s:null,resolution:c?t.get(r,["height"],null):null,aspectRatio:c?t.get(r,["aspectRatio"],null):null}});var p=r,m=s,v=function(t){return t.constraintName?t.constraintName:t.constraint?t.constraint:""}(l);if(l&&("ConstraintNotSatisfiedError"===l.name||"OverconstrainedError"===l.name||"OverconstrainedError"===l.constructor.name||"unavailable"===l.code&&"Edge"===i.browser))switch(v.toLowerCase()){case"width":case"height":if(!r||!o.canResolveNextResolution())break;return h.z.warn("Unable to get user media with constraint [%s] with height [%s] and width [%s]. Retrying with next closest resolution.",v,p.height,p.width),p=o.getNextResolution(r.height,r.aspectRatio),e.call(h,n,p,m,o,a);case"framerate":default:if(s)return h.z.warn("Unable to get user media with constraint [%s] and framerate [%s]. Retrying without frame rate constraint.",v,s),e.call(h,n,p,m=null,o,a);if(!r||!o.canResolveNextResolution())break;return h.z.warn("Unable to get user media with constraint [%s] with height [%s] and width [%s]. Retrying with next closest resolution.",v,p.height,p.width),p=o.getNextResolution(r.height,r.aspectRatio),e.call(h,n,p,m,o,a)}return h.z.error("Unable to get user media with status [%s]",d,l),a(l)},function(e){var n=e;if(h.Y&&"Chrome"===i.browser){var r,s=function(e){var i=t.get(e,["video","mandatory","chromeMediaSource"]),n=t.get(e,["audio","mandatory","chromeMediaSource"]),r=t.get(e,["video","mandatory","chromeMediaSourceId"]),s=t.get(e,["audio","mandatory","chromeMediaSourceId"]),o={};return(i||s)&&(t.set(o,["screen","mediaSource"],i),t.set(o,["screen","mediaSourceId"],r)),(n||s)&&(t.set(o,["screenAudio","mediaSource"],n),t.set(o,["screenAudio","mediaSourceId"],s)),o}(e);(n=h.Y(s)).resolutionHeight&&n.aspectRatio&&(r={width:o.calculateWidthByAspectRatio(n.resolution,n.aspectRatio),height:n.resolutionHeight}),n=function(e,i,n){var r=this.getVendorSpecificConstraints(e,i,n);r.screen&&(r.video=r.screen,delete r.screen),r.screenAudio&&(r.audio=r.screenAudio,delete r.screenAudio);var s=t.get(r,["video","mandatory","mediaSource"]),o=t.get(r,["audio","mandatory","mediaSource"]),a=t.get(r,["video","mandatory","mediaSourceId"]),u=t.get(r,["audio","mandatory","mediaSourceId"]);return(s||a)&&(t.set(r,["video","mandatory","chromeMediaSource"],s),t.set(r,["video","mandatory","chromeMediaSourceId"],a),delete r.video.mandatory.mediaSource,delete r.video.mandatory.mediaSourceId),(o||u)&&(t.set(r,["audio","mandatory","chromeMediaSource"],o),t.set(r,["audio","mandatory","chromeMediaSourceId"],u),delete r.audio.mandatory.mediaSource,delete r.audio.mandatory.mediaSourceId),r}.call(h,s,r,n.frameRate)}return n})}).call(this,r,a,u,o,s)},r.prototype.getVendorSpecificConstraints=function(t,e,n){if(e=e||{},!t||!t.audio&&!t.video&&!t.screen&&!t.screenAudio)throw new Error("Invalid device options. Must pass in at least one device option.");return"Firefox"===i.browser&&i.browserVersion>38||"Chrome"===i.browser&&i.browserVersion>52&&!t.screen&&!t.screenAudio||"Safari"===i.browser&&i.browserVersion>10||"Opera"===i.browser&&i.browserVersion>40?function(t,e,i){var n=t.video,r=t.audio,s=t.screen,o=t.screenAudio,a=e.width,u=e.height,c={};return n&&(c.video={height:{min:u,ideal:u,max:u},width:{min:a,ideal:a,max:a},frameRate:{ideal:i,max:i}},n.deviceId&&(c.video.deviceId={exact:n.deviceId}),n.facingMode&&(c.video.facingMode=n.facingMode),a||delete c.video.width,u||delete c.video.height,i||delete c.video.frameRate,a||u||i||n.deviceId||n.facingMode||(c.video=!0)),r&&(c.audio={},r.deviceId&&(c.audio.deviceId={exact:r.deviceId}),r.mediaSource&&(c.audio.mediaSource=r.mediaSource),r.mediaSourceId&&(c.audio.mediaSourceId=r.mediaSourceId),r.deviceId||r.mediaSource||r.mediaSourceId||(c.audio=!0)),o&&(c.screenAudio={},o.deviceId&&(c.screenAudio.deviceId={exact:o.deviceId}),o.mediaSource&&(c.screenAudio.mediaSource=o.mediaSource),o.mediaSourceId&&(c.screenAudio.mediaSourceId=o.mediaSourceId),o.deviceId||o.mediaSource||o.mediaSourceId||(c.screenAudio=!0)),s&&(c.screen={height:{min:u,ideal:u,max:u},width:{min:a,ideal:a,max:a},frameRate:{ideal:i,max:i}},a||delete c.screen.width,u||delete c.screen.height,i||delete c.screen.frameRate,s.mediaSource&&(c.screen.mediaSource=s.mediaSource),a||u||i||s.mediaSource||(c.screen=!0)),s&&n&&(c.screen=!0),c}(t,e,n):"Edge"===i.browser?function(t,e,i){var n=t.video,r=t.audio,s=t.screen,o=e.width,a=e.height,u={};return n&&(u.video={height:{min:a,max:a,exact:a},width:{min:o,max:o,exact:o},frameRate:i},n.deviceId&&(u.video.deviceId=n.deviceId),n.facingMode&&(u.video.facingMode=n.facingMode),o||delete u.video.width,a||delete u.video.height,i||delete u.video.frameRate,o||a||i||n.deviceId||n.facingMode||(u.video=!0)),r&&(u.audio=!0,r.deviceId&&(u.audio={deviceId:r.deviceId})),s&&(u.screen=!0),u}(t,e,n):function(t,e,i){var n=t.video,r=t.audio,s=t.screen,o=t.screenAudio,a=e.width,u=e.height,c={};return n&&(c.video={mandatory:{minHeight:u,maxHeight:u,minWidth:a,maxWidth:a,maxFrameRate:i}},n.deviceId&&(c.video.mandatory.sourceId=n.deviceId),n.facingMode&&(c.video.facingMode=n.facingMode),n.mediaSource&&(c.video.mandatory.mediaSource=n.mediaSource),n.mediaSourceId&&(c.video.mandatory.mediaSourceId=n.mediaSourceId),a||(delete c.video.mandatory.minWidth,delete c.video.mandatory.maxWidth),u||(delete c.video.mandatory.minHeight,delete c.video.mandatory.maxHeight),i||delete c.video.mandatory.maxFrameRate,a||u||i||n.deviceId||n.facingMode||n.mediaSource||n.mediaSourceId||(c.video=!0)),r&&(c.audio={mandatory:{}},r.deviceId&&(c.audio.mandatory.sourceId=r.deviceId),r.mediaSource&&(c.audio.mandatory.mediaSource=r.mediaSource),r.mediaSourceId&&(c.audio.mandatory.mediaSourceId=r.mediaSourceId),r.deviceId||r.mediaSource||r.mediaSourceId||(c.audio=!0)),o&&(c.screenAudio={mandatory:{}},o.deviceId&&(c.screenAudio.mandatory.sourceId=o.deviceId),o.mediaSource&&(c.screenAudio.mandatory.mediaSource=o.mediaSource),o.mediaSourceId&&(c.screenAudio.mandatory.mediaSourceId=o.mediaSourceId),o.deviceId||o.mediaSource||o.mediaSourceId||(c.screenAudio=!0)),s&&(c.screen={mandatory:{minHeight:u,maxHeight:u,minWidth:a,maxWidth:a,maxFrameRate:i}},a||(delete c.screen.mandatory.minWidth,delete c.screen.mandatory.maxWidth),u||(delete c.screen.mandatory.minHeight,delete c.screen.mandatory.maxHeight),i||delete c.screen.mandatory.maxFrameRate,s.mediaSource&&(c.screen.mandatory.mediaSource=s.mediaSource),s.mediaSourceId&&(c.screen.mandatory.mediaSourceId=s.mediaSourceId),a||u||i||s.mediaSource||(c.screen=!0)),s&&n&&(c.screen=!0),c}(t,e,n)},r}.apply(e,n))||(t.exports=r)},function(t,e,i){var n,r;n=[i(0)],void 0===(r=function(t){"use strict";function e(){}return e.convertPeerConnectionStats=function(e,i){return function(e,i){if(!e)return null;var n=[],r=function(e,r,s,o,a,u){if(e){t.hasIndexOrKey(i,e)||(i[e]={timestamp:0});var c=parseFloat(s)-i[e].timestamp,h=function(t,e,i){if(t){var n=8e3*(t-(e||0))/i;return Math.round(n/1e3)}return 0}(parseFloat(o),i[e].bytesSent,c),d=function(t,e,i){if(t){var n=8e3*(t-(e||0))/i;return Math.round(n/1e3)}return 0}(parseFloat(a),i[e].bytesReceived,c);i[e].bytesSent=parseFloat(o),i[e].bytesReceived=parseFloat(a),i[e].timestamp=parseFloat(s),n.push({uploadRate:h,downloadRate:d,mediaType:r,ssrc:e,direction:u})}};return t.S(e.result)?t.forEach(e.result(),function(t){if("ssrc"===t.type){var e=t.stat("ssrc"),i=t.stat("bytesSent"),n=t.stat("bytesReceived"),s=t.stat("mediaType"),o=t.timestamp.getTime(),a=t.id.indexOf("send")>-1?"upload":"download";r(e,s,o,i,n,a)}}):t.S(e.values)?t.forEach(Array.from(e.values()),function(e){if(t.hasIndexOrKey(e,"ssrc")){if(!e.ssrc||t.includes(e.id,"rtcp"))return;var i=e.type.indexOf("outbound")>-1?"upload":"download";r(e.ssrc,e.mediaType,e.timestamp,e.bytesSent,e.bytesReceived,i)}}):t.forEach(e,function(e){if(t.hasIndexOrKey(e,"ssrc")){if(!e.ssrc||t.includes(e.id,"rtcp"))return;var i=e.type.indexOf("outbound")>-1?"upload":"download";r(e.ssrc,e.mediaType,e.timestamp,e.bytesSent,e.bytesReceived,i)}}),n}(e,i)},e}.apply(e,n))||(t.exports=r)},function(t,e,i){var n,r;n=[i(0),i(1),i(2)],void 0===(r=function(t,e,i){"use strict";function n(t,i,n){e.tt(t,"name"),e.V(i,"peerConnection"),e.V(n,"logger"),this.et=t,this.it=i,this.z=n}function r(e){this.time=t.now(),this.value=e||0}function s(e,n,r,s,o){if(!r())return this.z.info("[%s] Finished monitoring of peer connection",this.et);i.getStats(e,null,function(e){var n=function(e){var n={};switch(i.browser){case"Firefox":return e;case"IE":return t.forOwn(e,function(e,i){t.startsWith(i,"ssrc")&&(n[e.id]=e)}),n;case"Safari":case"Edge":return e.forEach(function(t){n[t.id]=t}),n;case"ReactNative":return(t.tt(e)?JSON.parse(e):e).forEach(function(e){var i={id:e.id,type:e.type};e.values.forEach(function(e){t.keys(e).forEach(function(t){i[t]=e[t]})}),n[i.id]=i}),n;case"Chrome":default:return e.result().forEach(function(t){var e={id:t.id,type:t.type};t.names().forEach(function(i){e[i]=t.stat(i)}),n[e.id]=e}),n}}(e);s(n)},function(t){o(t)})}function o(e){var i=e.getLocalStreams?e.getLocalStreams():[],n=e.getRemoteStreams?e.getRemoteStreams():[],r=[],s=[];if(t.forEach(i,function(t){r=r.concat(t.getTracks())}),t.forEach(n,function(t){s=s.concat(t.getTracks())}),0!==r.length&&0!==s.length)throw this.z.error("Invalid State. PeerConnection contains [%s] local and [%s] remote streams.",i.length,n.length),new Error("Invalid State. PeerConnection contains both local and remote streams.");return 0!==r.length?r:0!==s.length?s:[]}function a(e,i){var n=e.localDescription.sdp.split("m="),r=e.remoteDescription.sdp.split("m=");return n.length===r.length&&t.findIndex(n,function(t,e){return i(t,e,r)})}function u(t,e,i){return e?8*(t.value-e.value)/((t.time-e.time)/1e3):i}function c(e){var i=o(this.it),n=t.filter(i,function(t){return t.kind===e}),r=t.filter(this.nt,function(t){return t.kind===e});return t.reduce(n,function(e,i){if(!e)return e;var n=!!t.find(r,function(t){return t.id===i.id});return!i.enabled||n},!0)}return n.prototype.start=function(n,h,d){if(e.V(n,"options"),e.S(h,"activeCallback"),e.S(d,"monitorCallback"),"inbound"!==n.direction&&"outbound"!==n.direction)throw new Error("Invalid monitoring direction");if(this.rt=n.frameRateThreshold||2,this.st=n.videoBitRateThreshold||6e3,this.ot=n.audioBitRateThreshold||5e3,this.at=n.conditionCountForNotificationThreshold||3,this.ut=n.monitoringInterval||4e3,this.ct=n.monitoringInterval||1500,this.ht=!n.hasOwnProperty("monitorFrameRate")||n.monitorFrameRate,this.dt=!n.hasOwnProperty("monitorBitRate")||n.monitorBitRate,this.ft=!n.hasOwnProperty("monitorState")||n.monitorState,this.nt=[],"Edge"===i.browser){var f=this.ct*this.at;this.ut=Math.max(this.ut,6e3),this.ct=Math.max(this.ct,6e3),this.at=Math.max(Math.ceil(f/this.ut),2),this.z.info("Using modified options for optimal monitoring of PeerConnection on [Edge]. Monitor Interval [%s], Condition Monitor Interval [%s], Condition Count For Notification [%s]",this.ut,this.ct,this.at)}return function(e,n,h,d,f){var l=this,p=0,m=void 0,v=void 0,g=void 0,y={},w={},b={},S=null;setTimeout(function k(E){s.call(l,n,null,d,function(s){var I=!1,T=!1,R=!1,C=!1,x=!1;if(!d())return l.z.info("[%s] Finished monitoring of peer connection",e);function O(t,n){var s=t.id||t.ssrc,o=null;if(t.framesEncoded){var a=new r(t.framesEncoded);t.framerateMean=function(t,e,i){return e?(t.value-e.value)/((t.time-e.time)/1e3):i}(a,b[s],2*l.rt),b[s]=a}switch(i.browser){case"Safari":case"Firefox":case"Edge":case"IE":if(x=C|=t.selected&&"succeeded"===t.state||"IE"===i.browser||"Edge"===i.browser||"Safari"===i.browser,"outbound"===h.direction&&("outboundrtp"===t.type||"outbound-rtp"===t.type||"kOutboundRtp"===t.type))switch(o=new r(t.bytesSent),t.mediaType){case"video":l.z.debug("[%s] Outbound [%s] [%s] with bitrate [%s], droppedFrames [%s] and frame rate [%s]",e,t.mediaType,t.ssrc,t.bitrateMean,t.droppedFrames,t.framerateMean),I=!0,m=t.framerateMean||0,T=!0,v=u(o,w[s],2*l.st),w[s]=o,"Edge"===i.browser&&(I=!1);break;case"audio":l.z.debug("[%s] Outbound [%s] [%s]",e,t.mediaType,t.ssrc),R=!0,g=u(o,y[s],2*l.ot),y[s]=o}if("inbound"===h.direction&&("inboundrtp"===t.type||"inbound-rtp"===t.type||"kInboundRtp"===t.type))switch(o=new r(t.bytesReceived),t.mediaType){case"video":l.z.debug("[%s] Inbound [%s] [%s] with framerate [%s] and jitter [%s]",e,t.mediaType,t.ssrc,t.framerateMean,t.jitter),T=!0,v=u(o,w[s],2*l.st),w[s]=o;break;case"audio":l.z.debug("[%s] Inbound [%s] [%s] with jitter [%s]",e,t.mediaType,t.ssrc,t.jitter),R=!0,g=u(o,y[s],2*l.ot),y[s]=o}break;case"Chrome":default:if("true"===t.googWritable&&(x=!0),"true"===t.googReadable&&(C=!0),"ssrc"!==t.type)return;if("outbound"===h.direction)switch(o=new r(t.bytesSent),t.mediaType){case"video":l.z.debug("[%s] Outbound [%s] [%s] with average encoding time [%s] ms (CPU limited=[%s]) and RTT [%s]",e,t.mediaType,t.ssrc,t.googAvgEncodeMs,t.googCpuLimitedResolution,t.googRtt),I=!0,m=t.googFrameRateSent||0,T=!0,v=u(o,w[s],2*l.st),w[s]=o;break;case"audio":l.z.debug("[%s] Outbound [%s] [%s] with audio input level [%s] and RTT [%s] and jitter [%s]",e,t.mediaType,t.ssrc,t.audioInputLevel,t.googRtt,t.googJitterReceived),R=!0,g=u(o,y[s],2*l.ot),y[s]=o}else if("inbound"===h.direction)switch(o=new r(t.bytesReceived),t.mediaType){case"video":l.z.debug("[%s] Inbound [%s] [%s] with current delay [%s] ms and target delay [%s] ms",e,t.mediaType,t.ssrc,t.googCurrentDelayMs,t.googTargetDelayMs),I=!0,m=t.googFrameRateReceived||0,T=!0,v=u(o,w[s],2*l.st),w[s]=o;break;case"audio":l.z.debug("[%s] Inbound [%s] [%s] with output level [%s] and jitter [%s] and jitter buffer [%s] ms",e,t.mediaType,t.ssrc,t.audioOutputLevel,t.googJitterReceived,t.googJitterBufferMs),R=!0,g=u(o,y[s],2*l.ot),y[s]=o}}}if(!s)throw new Error("Report must be a valid PeerConnection.getStats Report");s.forEach?s.forEach(O):t.forOwn(s,function(t,e){O(t)});var M=function(e){var i=a(e,function(e,i,n){return!!t.startsWith(e,"audio")&&!t.includes(e,"a=inactive")&&!t.includes(n[i],"a=inactive")});return t.lt(i)}(n),P=function(e){var i=a(e,function(e,i,n){return!!t.startsWith(e,"video")&&!t.includes(e,"a=inactive")&&!t.includes(n[i],"a=inactive")});return t.lt(i)}(n);if((T&&0===v||R&&0===g||I&&0===m)&&(T=T&&P,R=R&&M,I=I&&P,C=C||!(P||M),x=x||!(P||M)),(R||T||I)&&l.z.debug("[%s] Current bit rate is [%s] bps for audio and [%s] bps for video with [%s] FPS",e,Math.ceil(g||0),Math.ceil(v||0),m||"?"),!l.ft||"closed"!==n.connectionState&&"failed"!==n.connectionState&&"failed"!==n.iceConnectionState)l.ht&&I&&m<=l.rt&&!c.call(l,"video")?p++:l.dt&&R&&g<=l.ot&&!c.call(l,"audio")?p++:l.dt&&T&&v<=l.st&&!c.call(l,"video")?p++:C&&x?p=0:p++;else{var q=M&&P,D=o.call(l,n);if(!q&&function(e){var i=a(e,function(e){return t.startsWith(e,"video")||t.startsWith(e,"audio")});return t.lt(i)}(n))return void l.z.info("[%s] Finished monitoring of peer connection with [%s] inactive tracks",e,D.length);p++}var A=!(0!==v&&T||0!==g&&R||function(){var e=this;return t.reduce(o(this.it),function(i,n){if(!i)return i;var r=!!t.find(e.nt,function(t){return t.id===n.id});return!n.enabled||r},!0)}.call(l));A&&!S?S=setTimeout(t.bind(k,this,!0),5e3):A||(clearTimeout(S),S=null);var N=E&&A&&S,F=function(){l.z.info("[%s] Failure has been acknowledged",e),p=Number.MIN_VALUE,setTimeout(k,l.ut)};if(p>=l.at||N){var j=N?"["+e+"] Failure detected with 0 bps audio and video for [5] seconds":"["+e+"] Failure detected with frame rate ["+m+"] FPS, audio bit rate ["+g+"] bps, and video bit rate ["+v+"] bps";f(null,{type:"condition",message:j,report:s,frameRate:m,videoBitRate:v,audioBitRate:g,acknowledgeFailure:F})?F():l.z.error(j+": [%s]",s)}else setTimeout(k,p>0?l.ct:l.ut)},function(t){f(t,{type:"error",message:"Unable to get Connection statistics. Connection may have failed."})})},l.ut)}.call(this,this.et,this.it,n,h,d)},n.prototype.setMonitorTrackState=function(i,n){e.V(i,"track"),e.pt(n,"state");var r=o(this.it);if(!t.find(r,function(t){return t.id===i.id}))return this.z.warn("[%s] Unable to find track [%s] [%s] in peer connection",this.et,i.kind,i.id);if(!n)return this.z.info("[%s] Pausing monitoring of track [%s] [%s]",this.et,i.kind,i.id),this.nt.push(i);var s=this.nt.length;this.nt=t.filter(this.nt,function(t){return t.id!==i.id}),s!==this.nt.length&&this.z.info("[%s] Starting monitoring of track [%s] [%s] after it was paused",this.et,i.kind,i.id)},n.prototype.toString=function(){return"PeerConnectionMonitor["+this.et+"]"},n}.apply(e,n))||(t.exports=r)},function(t,e,i){var n;void 0===(n=function(){"use strict";return{package:"telemetry",messages:[{name:"LogData",fields:[{rule:"required",type:"LogLevel",name:"level",id:1},{rule:"required",type:"string",name:"timestamp",id:2},{rule:"required",type:"string",name:"category",id:3},{rule:"required",type:"string",name:"message",id:4},{rule:"optional",type:"string",name:"source",id:5},{rule:"optional",type:"string",name:"fullQualifiedName",id:11},{rule:"optional",type:"string",name:"sessionId",id:6},{rule:"optional",type:"string",name:"userId",id:7},{rule:"optional",type:"string",name:"environment",id:8},{rule:"optional",type:"string",name:"version",id:9},{rule:"optional",type:"float",name:"runtime",id:10}]},{name:"StoreLogRecords",fields:[{rule:"repeated",type:"LogData",name:"records",id:1}]},{name:"StoreLogRecordsResponse",fields:[{rule:"required",type:"string",name:"status",id:1},{rule:"required",type:"uint64",name:"storedRecords",id:2}]},{name:"MetricValue",fields:[{rule:"optional",type:"string",name:"string",id:1},{rule:"optional",type:"float",name:"float",id:2},{rule:"optional",type:"uint64",name:"uint64",id:3},{rule:"optional",type:"int64",name:"int64",id:4},{rule:"optional",type:"bool",name:"boolean",id:5},{rule:"optional",type:"string",name:"timestamp",id:6}]},{name:"MetricData",fields:[{rule:"required",type:"string",name:"timestamp",id:1},{rule:"optional",type:"string",name:"sessionId",id:2},{rule:"optional",type:"string",name:"streamId",id:3},{rule:"optional",type:"string",name:"source",id:4},{rule:"optional",type:"string",name:"resource",id:5},{rule:"optional",type:"string",name:"kind",id:6},{rule:"required",type:"Metric",name:"metric",id:7},{rule:"optional",type:"MetricValue",name:"value",id:8},{rule:"optional",type:"MetricValue",name:"previousValue",id:9},{rule:"optional",type:"uint64",name:"elapsed",id:10},{rule:"optional",type:"string",name:"fullQualifiedName",id:11},{rule:"optional",type:"string",name:"environment",id:12},{rule:"optional",type:"string",name:"version",id:13},{rule:"optional",type:"string",name:"tool",id:14},{rule:"optional",type:"string",name:"toolVersion",id:15},{rule:"required",type:"float",name:"runtime",id:16}]},{name:"SubmitMetricRecords",fields:[{rule:"repeated",type:"MetricData",name:"records",id:1}]},{name:"SubmitMetricRecordsResponse",fields:[{rule:"required",type:"string",name:"status",id:1},{rule:"required",type:"uint64",name:"storedRecords",id:2}]}],enums:[{name:"LogLevel",values:[{name:"Trace",id:0},{name:"Debug",id:1},{name:"Info",id:2},{name:"Warn",id:3},{name:"Error",id:4},{name:"Fatal",id:5}]},{name:"Metric",values:[{name:"RoundTripTime",id:0},{name:"DownlinkThroughputCapacity",id:26},{name:"Initialized",id:1},{name:"Provisioned",id:2},{name:"SetupCompleted",id:3},{name:"Offset",id:4},{name:"TimeToFirstFrame",id:5},{name:"Playing",id:6},{name:"Stalled",id:7},{name:"Buffering",id:8},{name:"Seeking",id:22},{name:"Stopped",id:9},{name:"BitRateAdaptation",id:10},{name:"ResolutionChanged",id:11},{name:"DisplayResolutionChanged",id:23},{name:"VideoBitRate",id:28},{name:"AudioBitRate",id:29},{name:"FrameRateChanged",id:12},{name:"FramesDropped",id:13},{name:"PacketsLost",id:14},{name:"PictureLost",id:15},{name:"PlayoutDelayChanged",id:16},{name:"CodecChanged",id:17},{name:"PlayerEvent",id:21},{name:"MetricDropped",id:18},{name:"NetworkOffline",id:19},{name:"NetworkOnline",id:20},{name:"NetworkType",id:27},{name:"ApplicationForeground",id:24},{name:"ApplicationBackground",id:25}]}]}}.apply(e,[]))||(t.exports=n)},function(t,e,i){var n,r;n=[i(0),i(64),i(62),i(61)],void 0===(r=function(t,e,i,n){"use strict";function r(e,r){var s=this;this.mt={},this.mt[n.package]=new i(n),t.forEach(e,function(t){s.mt[t.package]=new i(t)}),this.vt=r||3}return r.prototype.getApiVersion=function(){return this.vt},r.prototype.encode=function(i,n){if("string"!=typeof i)throw new Error("'type' must be a string");if("object"!=typeof n)throw new Error("'data' must be an object");var r=i.split("."),s=t.get(r,[0]),o=t.get(r,[1]),a=t.get(this.mt,[s]),u=new e;return a.write(o,n,u),u.finish()},r.prototype.decode=function(i,n){if("string"!=typeof i)throw new Error("'type' must be a string");var r=i.split("."),s=t.get(r,[0]),o=t.get(r,[1]),a=t.get(this.mt,[s]),u=new e(n);return a.read(o,u)},r}.apply(e,n))||(t.exports=r)},function(t,e,i){var n,r;n=[i(0),i(1),i(4),i(3),i(18),i(60)],void 0===(r=function(t,e,i,n,r,s){"use strict";var o="continuation",a=2e3,u=3e5,c=18e3;function h(n,s,o,a,u){e.V(n,"logger"),e.S(s,"sendCallback"),e.S(o,"receiveCallback"),this.z=n,this.gt=new r(a,u),this.yt=0,this.wt=new i.NamedEvents,this.bt={},this.St={},this.kt={},this.Et={},this.It={},this.Tt={},this.Rt=o,this.Ct=s,o(t.bind(d,this))}function d(e){if(this.xt)return this.z.warn("Proto already disposed of. Unable process message");var i,n,r;try{i=this.gt.decode("mq.Message",s.toByteArray(e.data)),r=this.bt[i.requestId],this.z.info(">> [%s] [%s]",i.messageType,i.type),n=this.gt.decode(i.type,i.payload)}catch(t){if(this.z.error(t),r)return r(t);throw t}switch(function(e,i,n){var r=t.now(),s=this.It[e.requestId];if(t.lt(s)){var o=r-s;e.wallTime=[o].concat(e.wallTime)}this.wt.fireAsync("received",[{key:e.requestId,messageType:e.messageType,type:e.type,wallTime:e.wallTime,received:r,bytes:n,payload:i}]),delete this.It[e.requestId]}.call(this,i,n,e.data.length),i.messageType){case"Response":if(n.status!==o&&delete this.bt[i.requestId],clearTimeout(this.Et[i.requestId]),delete this.Et[i.requestId],!r)return;return"mq.Error"===i.type?r(n,null):r(null,n);case"Request":var a=t.bind(this.sendResponse,this,i.requestId,i.type+"Response"),u=this.kt[i.type];this.St[i.requestId]=t.now(),u?u(n,a):this.z.info("Received request without a subscribed listener");break;case"Event":return function(t,e){this.wt.fire(t,e,this)}.call(this,i.type,[n]);default:return this.z.warn(">> Unsupported message type [%s]",i.messageType)}}function f(e,i,n,r,s,c,h){return h&&h.status===o?(!this.Tt[e]&&this.bt[e]&&(this.Tt[e]=function(e,i){return setTimeout(t.bind(m,this,e,u,i),u)}.call(this,e,s)),function(e,i,n,r,s,o){if(!r||!r.continuationId&&!r.routeKey)return this.z.warn("Received request for continuation without a continuationId or routeKey"),o();var u=t.assign({},n,{continuationId:r.continuationId,routeKey:r.routeKey}),c={requestId:e,type:i,payload:this.gt.encode(i,u),messageType:"Request"},h=this;return setTimeout(function(){if(h.bt[e])return l.call(h,e,c,u,s,o)},a)}.call(this,e,i,n,h,r,s)):(clearTimeout(this.Tt[e]),delete this.Tt[e],s(c,h))}function l(e,i,n,r,s){this.Et[e]&&clearTimeout(this.Et[e]);var o=r||c;return this.Et[e]=setTimeout(t.bind(m,this,e,o,s),o),p.call(this,i,n)}function p(e,i){var n=s.toString(this.gt.encode("mq.Message",e));return function(e,i,n){var r=t.now();this.It[e.requestId]=r,this.wt.fireAsync("sent",[{key:e.requestId,messageType:e.messageType,type:e.type,received:r,bytes:n,payload:i}])}.call(this,e,i,n.length),this.Ct(n)}function m(t,e,i){if(this.bt[t])return function(t,e){this.wt.fireAsync("timeout",[{key:t,timeout:e}]),delete this.It[t]}.call(this,t,e),this.z.warn("Request [%s] has not completed in [%s] ms. Dropping request.",t,e),delete this.bt[t],i(null,{status:"timeout"})}return h.prototype.onEvent=function(t,i){return this.xt?this.z.warn("Proto already disposed of. Unable to listen for event"):(e.Ot(t,"eventName"),e.S(i,"handler"),this.wt.listen(t,i))},h.prototype.onRequest=function(t,i){if(this.xt)return this.z.warn("Proto already disposed of. Unable to listen for request");e.Ot(t,"requestName"),e.S(i,"handler"),this.kt[t]&&this.z.warn("May not set multiple handlers for the same request. Overriding existing handlers for request [%s]",t),this.kt[t]=i;var r=this;return new n.Disposable(function(){r.kt[t]=null})},h.prototype.sendRequest=function(i,n,r,s){if(this.xt)return this.z.warn("Proto already disposed of. Unable to send request"),r(null,{status:"proto-disposed"});s=s||{},e.Ot(i,"type"),e.V(n,"message"),e.V(s,"settings"),r&&e.S(r,"callback"),s.timeout&&e.lt(s.timeout,"settings.timeout");var o="C"+(this.yt++).toString(),a={requestId:o,type:i,payload:this.gt.encode(i,n),messageType:"Request"};return this.bt[o]=t.bind(f,this,o,i,n,s.timeout,r),l.call(this,o,a,n,s.timeout,r)},h.prototype.sendResponse=function(i,n,r,s){if(this.xt)return this.z.warn("Proto already disposed of. Unable to send response"),s(null,{status:"proto-disposed"});e.Ot(i,"requestId"),e.Ot(n,"type"),e.V(r,"message");var o=this.St[i];o||(this.z.error("Already responded to request [%s]",i),s(new Error("no-response-handler")));var a={requestId:i,type:n,payload:this.gt.encode(n,r),messageType:"Response",wallTime:[t.now()-o]};return p.call(this,a,r),delete this.St[i],s(null,{status:"ok"})},h.prototype.disposeOfRequests=function(){t.forOwn(this.Et,function(t){clearTimeout(t)}),t.forOwn(this.Tt,function(t){clearTimeout(t)}),this.bt={},this.St={},this.kt={},this.Et={},this.It={},this.Tt={}},h.prototype.dispose=function(){this.xt=!0,this.Rt=null,this.Ct=null,this.disposeOfRequests(),this.wt.dispose()},h.prototype.getApiVersion=function(){return this.gt.getApiVersion()},h.prototype.toString=function(){return"Proto["+this.Mt.toString()+"]"},h}.apply(e,n))||(t.exports=r)},function(t,e,i){var n,r;n=[i(65)],void 0===(r=function(t){"use strict";return t}.apply(e,n))||(t.exports=r)},function(t,e,i){var n,r;n=[i(0)],void 0===(r=function(t){"use strict";return{parseEnvFromPcastBaseUri:function(e){return e=e.toLowerCase(),t.includes(e,"local")?"local":t.includes(e,"stg")?"staging":"production"}}}.apply(e,n))||(t.exports=r)},function(t,e,i){var n,r;n=[i(0),i(1),i(3)],void 0===(r=function(t,e,i){"use strict";function n(){this.Pt=[]}function r(i,n,r){var s=this;t.isNullOrUndefined(i)&&(i=[]),e.isArray(i,"args");var o=function(){t.forEach(s.Pt,function(t){t.apply(n,i)})};r?setTimeout(function(){o(),r()},0):o()}return n.prototype.fire=function(t,e){r.call(this,t,e)},n.prototype.fireAsync=function(t,e,i){r.call(this,t,e,i||function(){})},n.prototype.listen=function(n){var r=this;return e.S(n,"listener"),r.Pt.push(n),new i.Disposable(function(){r.Pt=t.remove(r.Pt,function(t){return t===n})})},n.prototype.size=function(){return this.Pt.length},n.prototype.dispose=function(){this.Pt=[]},n.prototype.toString=function(){return"Event|"+this.size()},n}.apply(e,n))||(t.exports=r)},function(t,e,i){var n,r;n=[i(0),i(1),i(7),i(3),i(71),i(5),i(52),i(51),i(48),i(45),i(44),i(16),i(11),i(43),i(41),i(40),i(15),i(36),i(35),i(31),i(6),i(2),i(29)],void 0===(r=function(t,e,i,n,r,s,o,a,u,c,h,d,f,l,p,m,v,g,y,w,b,S,k){"use strict";var E="2018-06-11T21:40:43Z";function I(s){s=s||{},e.V(s,"options"),s.streamingSourceMapping&&(e.V(s.streamingSourceMapping,"options.streamingSourceMapping"),e.Ot(s.streamingSourceMapping.replacement,"options.streamingSourceMapping.replacement"),s.streamingSourceMapping.patternToReplace instanceof RegExp||e.Ot(s.streamingSourceMapping.patternToReplace,"options.streamingSourceMapping.patternToReplace")),t.isNullOrUndefined(s.disableMultiplePCastInstanceWarning)||e.pt(s.disableMultiplePCastInstanceWarning,"options.disableMultiplePCastInstanceWarning"),this.qt=new i.Observable("offline"),this.Dt=s.uri||u.DefaultPCastUri,this.At=s.deviceId||"",this.U=E,this.z=s.logger||r.createPCastLogger(this.Dt,s.disableConsoleLogging),this.Nt=s.metricsTransmitter||l.createMetricsTransmitter(this.Dt),this.Ft=new c(s,this.z),this.jt=s.shaka,this.Ut=s.videojs||S.global.videojs,this.Lt=s.rtmp||{},this.Bt="offline",this.Wt=s.streamingSourceMapping,this.h=new n.DisposableList,this.Vt=s.disableMultiplePCastInstanceWarning,this.zt=!0,this.Gt=[];var o=this;t.addEventListener(S.global,"unload",function(){return o.z.info("Window Unload Event Triggered"),o.stop()}),s.disableBeforeUnload||t.addEventListener(S.global,"beforeunload",function(){return o.z.info("Window Before Unload Event Triggered"),o.stop()}),S.webrtcSupported||"ReactNative"!==S.browser||S.shim(),S.webrtcSupported&&(function(){var t=this,e=new S.RTCPeerConnection;"Safari"===S.browser&&S.browserVersion>10&&(e.addTransceiver("audio"),e.addTransceiver("video"));try{e.createOffer(function(e){var i=k.getH264ProfileIds(e.sdp);if(0===i.length)return t.z.info("Unable to find local h264 profile level id");t.z.info("Found local h264 profile level ids [%s]",i,e.sdp),t.Gt=i},function(e){t.z.error("Unable to create offer to get local h264 profile level id",e)},{offerToReceiveAudio:!0,offerToReceiveVideo:!0})}catch(e){t.z.error("Failed to set environment defaults. Creating the Offer failed",e)}}.call(this),j.call(this),y.canPlaybackType(b.types.rtmp.name)&&this.z.info("Flash detected"))}function T(){if(O.call(this)&&"offline"===this.qt.getValue())return this.z.warn("[PCast] connected after being offline. Going offline."),W.call(this,"critical-network-issue"),this.stop();var t=this;this._t=!0,t.Jt||t.Ht.authenticate(t.Kt,function(e,i){t.Qt&&(e?(t.z.error("Failed to authenticate [%s]",e),W.call(t,"unauthorized"),t.Qt.call(t,t,"unauthorized","")):"ok"!==i.status?(t.z.warn("Failed to authenticate, status [%s]",i.status),W.call(t,"unauthorized"),t.Qt.call(t,t,"unauthorized","")):(W.call(t,"online"),t.Qt.call(t,t,i.status,i.sessionId)))})}function R(){W.call(this,"reconnecting")}function C(){W.call(this,"reconnected"),this.z.info("Attempting to re-authenticate after reconnect event"),function(){var t=this;t.Jt||t.Ht.authenticate(t.Kt,function(e,i){var n=!0===t._t;if(e)return t.z.error("Unable to authenticate after reconnect to WebSocket [%s]",e),W.call(t,"reconnect-failed");if("ok"!==i.status){t.z.warn("Unable to authenticate after reconnect to WebSocket, status [%s]",i.status);var r="capacity"===i.status?i.status:"reconnect-failed";return W.call(t,r)}return t._t=!0,t.z.info("Successfully authenticated after reconnect to WebSocket"),W.call(t,"online",null,n)})}.call(this)}function x(){if(O.call(this)&&"reconnecting"===this.qt.getValue())return this.z.warn("[PCast] disconnected after attempting to reconnect. Going offline."),W.call(this,"critical-network-issue"),this.stop();this._t=!1,W.call(this,"offline")}function O(){return t.reduce(this.Xt,function(t,e){return t?"closed"===e.iceConnectionState:t},!0)}function M(t){switch(t){case"":case"none":case"ended":return"ended";case"server-error":case"session-error":case"not-ready":case"error":case"died":return"failed";case"censored":return"censored";case"maintenance":return"maintenance";case"capacity":return"capacity";case"app-background":return"app-background";default:return"custom"}}function P(t){var e=t.streamId,i=t.reason;return D.call(this,e,i)}function q(t){var e=t.streamId,i=t.status,n=t.reason,r=this.Zt[e];r&&r.dataQualityChangedCallback(i,n);var s=this.$t[e];s&&"function"==typeof s.dataQualityChangedCallback&&s.dataQualityChangedCallback(s,i,n)}function D(t,e){this.z.info("[%s] Stream ended with reason [%s]",t,e);var i=this.Zt[t];i&&i.streamEndedCallback(M(e),e,!0),delete this.Zt[t];var n=this.$t[t];n&&"function"==typeof n.publisherEndedCallback&&n.publisherEndedCallback(n,M(e),e),delete this.$t[t];var r=this.Xt[t];r&&V.call(this,t,r,"ended"),delete this.Xt[t]}function A(e,i,n,r,s,o){var a=this;t.addEventListener(n,"addstream",function(u){if(!i.failed){var c=u.stream,h="real-time";if(!c)return i.failed=!0,a.z.warn("[%s] No remote stream",e),s.call(a,void 0,"failed");a.z.info("[%s] Got remote stream",e),r.setProperty("kind",h);var d=t.assign({networkLag:a.Yt},o),f=new w(e,c,n,r,d,a.z),l=new g(h,f,a.z);l.on(b.streamEvents.playerError.name,function(t,e){a.z.warn("Phenix Real-Time Stream Error [%s] [%s]",t,e),l.streamErrorCallback(h,e)}),l.on(b.streamEvents.stopped.name,function(t){i.stopped||(a.z.info("[%s] stop media stream",e),V.call(a,e,n,"stop"),a.Ht.destroyStream(e,t||"",function(t,i){t?a.z.error("[%s] failed to destroy stream [%s]",e,t):"ok"===i.status?a.z.info("[%s] destroyed stream",e):a.z.warn("[%s] failed to destroy stream, status [%s]",e,i.status)}),i.stopped=!0)}),a.Zt[e]=l,s.call(a,f)}})}function N(e,i,n){var r=this;t.addEventListener(i,"icecandidate",function(t){var i=t.candidate;i?r.z.debug("[%s] ICE candidate: [%s] [%s] [%s]",e,i.sdpMid,i.sdpMLineIndex,i.candidate):r.z.info("[%s] ICE candidate discovery complete",e),n&&n(i)})}function F(e,i){var n=this;t.addEventListener(i,"negotiationneeded",function(t){n.z.info("[%s] Negotiation needed")}),t.addEventListener(i,"iceconnectionstatechange",function(t){n.z.info("[%s] ICE connection state changed [%s]",e,i.iceConnectionState)}),t.addEventListener(i,"icegatheringstatechange ",function(t){n.z.info("[%s] ICE gathering state changed [%s]",e,i.iceGatheringState)}),t.addEventListener(i,"signalingstatechange",function(t){n.z.info("[%s] Signaling state changed [%s]",e,i.signalingState)}),t.addEventListener(i,"connectionstatechange",function(t){n.z.info("[%s] Connection state changed [%s]",e,i.connectionState)})}function j(e){var i=this;switch(S.browser){case"Edge":return S.getDestinations(function(n){0===t.filter(n,function(t){return"audio"===t.kind}).length?(i.zt&&i.z.info("Detected no audio devices attached to machine"),i.zt=!1):i.zt=!0,e&&e()});default:e&&e()}}function U(e,i,n,r,s,o){if("IE"===S.browser)throw new Error("Subscribing in real-time not supported on IE without the PhenixP2P Plugin");var a=this,u={failed:!1,stopped:!1},c=n.match(/a=crypto:/i),h=n.match(/m=application /i),d=new S.RTCPeerConnection(e,{optional:[{DtlsSrtpKeyAgreement:!c},{RtpDataChannels:h}]}),f=null;if(a.Xt[i]=d,"Firefox"===S.browser||"Edge"===S.browser){if(n.match(/(\nm=video)/g)&&n.match(/(\nm=audio)/g)){var l=/(a=candidate)((.|\n)*)(?=m=)/g;n=n.replace(l,n.match(l)+"a=end-of-candidates\n")}n=(n+="a=end-of-candidates").replace(/(\na=ice-options:trickle)/g,"")}"ReactNative"===S.browser&&(n=K(n));var p=function(t){u.failed||(u.failed=!0,u.stopped=!0,delete a.Xt[i],V.call(a,i,d,"failure"),s.call(a,void 0,t||"failed"))};A.call(a,i,u,d,r,s,o),N.call(a,i,d,function(t){f&&f(t)}),F.call(a,i,d);var m=new S.RTCSessionDescription({type:"offer",sdp:n});d.setRemoteDescription(m,function(){a.z.debug("Set remote description (offer)");var e={mandatory:{}};"Chrome"===S.browser||"ReactNative"===S.browser?(e.mandatory.OfferToReceiveVideo=!1!==o.receiveVideo,e.mandatory.OfferToReceiveAudio=!1!==o.receiveAudio):(e.mandatory.offerToReceiveVideo=!1!==o.receiveVideo,e.mandatory.offerToReceiveAudio=!1!==o.receiveAudio),d.createAnswer(function(e){a.z.info("Created answer [%s]",e.sdp),a.Ht.setAnswerDescription(i,e.sdp,function(e,n){if(e)return a.z.error("Failed to set answer description [%s]",e),p();if("ok"!==n.status)return a.z.warn("Failed to set answer description, status [%s]",n.status),p(n.status);t.includes(n.options,"ice-candidates")&&(f=function(e){var n=[];e?[].push(e):n.push("completed"),a.Ht.addIceCandidates(i,e,n,function(e,i){e?a.z.error("Failed to add ICE candidate [%s]",e):"ok"===i.status?t.includes(i.options,"cancel")&&(f=null):a.z.warn("Failed to add ICE candidate, status [%s]",i.status)})});var r=n.sessionDescription.sdp;if(H()){var s=t.get(function(){var e=t.get(S,["global","navigator","userAgent"],"");if(/iP(hone|od|ad)/.test(e)){var i=e.match(/.*OS (\d+)_(\d+)_?(\d+)? like Mac OS X/);return{major:parseInt(t.get(i,[1],0),10),minor:parseInt(t.get(i,[2],0),10),patch:parseInt(t.get(i,[3],0),10)}}}(),["major"]);a.z.info("iOS Version is [%s]",s),s<11&&(r=r.replace("BUNDLE audio video","BUNDLE video audio"))}var o=new S.RTCSessionDescription({type:"answer",sdp:r});d.setLocalDescription(o,function(){a.z.debug("Set local description (answer)")},p)})},p,e)},p)}function L(i,n,r,s,o){var a=/a=x-rtmp:(rtmp:\/\/[^\n]*)/m,u=n.match(a),c=n.match(/a=x-playlist:([^\n]*[.]mpd\??[^\s]*)/m),h=n.match(/a=x-playlist:([^\n]*[.]m3u8\??[^\s]*)/m),d=t.get(c,[1],""),f=t.get(h,[1],""),l=c&&2===c.length,p=h&&2===h.length,m=H()||"Safari"===S.browser,v=y.canPlaybackType(b.types.rtmp.name),g=y.canPlaybackType(b.types.dash.name),w=y.canPlaybackType(b.types.hls.name);if(this.Wt&&(d=d.replace(this.Wt.patternToReplace,this.Wt.replacement),f=f.replace(this.Wt.patternToReplace,this.Wt.replacement)),u&&v){for(var k=[];u;){var E=t.get(u,[1],""),I=t.get(E.match(/(rtmp:\/\/[^\n\s]*)/),[0]),T=t.get(E.match(/bitrate=([^\n\s;]*)/),[1]),R=t.get(E.match(/resolution=([^\n\s;]*)/),[1]);n=n.replace(E,""),I&&k.push({uri:I,bitrate:T,resolution:R}),u=n.match(a)}return B.call(this,i,k,b.types.rtmp.name,r,s,t.assign({},this.Lt,o))}return l&&g&&!m?(o.isDrmProtectedContent=/[?&]drmToken=([^&]*)/.test(d)||/x-widevine-service-certificate/.test(n),o.isDrmProtectedContent&&(o.widevineServiceCertificateUrl=n.match(/a=x-widevine-service-certificate:([^\n][^\s]*)/m)[1],o.playreadyLicenseUrl=n.match(/a=x-playready-license-url:([^\n][^\s]*)/m)[1]),this.jt&&!this.jt.Player.isBrowserSupported()?(this.z.warn("[%s] Shaka does not support this browser",i),s.call(this,void 0,"browser-unsupported")):B.call(this,i,d,b.types.dash.name,r,s,o)):p&&w?(o.isDrmProtectedContent=/[?&]drmToken=([^&]*)/.test(f),o.hlsTargetDuration&&(e.lt(o.hlsTargetDuration,"options.hlsTargetDuration"),f=f+(f.indexOf("?")>-1?"&":"?")+"targetDuration="+o.hlsTargetDuration),B.call(this,i,f,b.types.hls.name,r,s,t.assign({preferNative:m},o))):(l||p?g||w?g?w||this.z.warn("[%s] Device does not support Hls playback. Creating live viewer stream failed.",i):this.z.warn("[%s] Device does not support Dash playback. Creating live viewer stream failed.",i):this.z.warn("[%s] Device does not support either Dash or Hls playback. Creating live viewer stream failed.",i):this.z.warn("[%s] Offer does not contain a supported manifest [%s]. Creating live viewer stream failed.",i,n),s.call(this,void 0,"failed"))}function B(t,e,i,n,r,s){var o=this,a=new y(i,t,e,n,s,this.jt,this.z),u=new g(i,a,this.z);n.setProperty("kind",i),u.on(b.streamEvents.playerError.name,function(t,e){o.z.warn("Phenix Live Stream Player Error [%s] [%s]",t,e),u.streamErrorCallback(t,e)}),u.on(b.streamEvents.stopped.name,function(e){o.Ht.destroyStream(t,e||"",function(e,i){e?o.z.error("[%s] failed to destroy stream, [%s]",t,e):"ok"===i.status||o.z.warn("[%s] failed to destroy stream, status [%s]",t,i.status)})}),this.Zt[t]=u,r.call(this,u.getPhenixMediaStream())}function W(t,e,i){var n,r=this.getStatus();if(r!==t&&("critical-network-issue"!==(n=r)&&"offline"!==n||"offline"!==t)){if(this.qt.setValue(t),i)return;switch(t){case"connecting":case"reconnecting":case"reconnected":break;case"critical-network-issue":case"unauthorized":case"reconnect-failed":case"offline":return this.te.call(this);case"online":return this.ee.call(this)}}}function V(t,e,i){"closed"===e.signalingState||e.__closing||(this.z.debug("[%s] close peer connection [%s]",t,i),e.close(),e.__closing=!0)}function z(e){if(!e)return e;var i=t.isArray(e)?[]:{},n=t.bind(G,null,i);return t.isArray(e)?t.forEach(e,n):t.forOwn(e,n),i}function G(e,i,n){if(null!==i){if(t.V(i)||t.isArray(i))return e[n]=z(i);if(!t.tt(i)||!t.tt(n))return e[n]=i;var r=t.startsWith(i.toLowerCase(),n.toLowerCase())?i.substring(n.length,i.length).toLowerCase():i;e[n]=r}}function _(e){return"Firefox"===S.browser&&function(e){if(!e)return e;t.forEach(e.iceServers,function(e){e.urls=t.filter(e.urls,function(e){return!t.startsWith(e,"turns")})})}(e),e}I.prototype.getBaseUri=function(){return this.Dt},I.prototype.getStatus=function(){return this.qt.getValue()},I.prototype.getObservableStatus=function(){return this.qt},I.prototype.isStarted=function(){return this.ie},I.prototype.reAuthenticate=function(t){if(e.Ot(t,"authToken"),"online"===this.qt.getValue())return this.z.warn("Already authenticated. Denying request to re-authenticate");this.z.info("Attempting to re-authenticate with new auth token [%s]",t),this.Kt=t,C.call(this)},I.prototype.start=function(e,i,n,r){if("string"!=typeof e)throw new Error('"authToken" must be a string');if("function"!=typeof i)throw new Error('"authenticationCallback" must be a function');if("function"!=typeof n)throw new Error('"onlineCallback" must be a function');if("function"!=typeof r)throw new Error('"offlineCallback" must be a function');if(this.ie)throw new Error('"Already started"');t.lt(S.global.__phenixInstantiatedPCastCount)?S.global.__phenixInstantiatedPCastCount++:S.global.__phenixInstantiatedPCastCount=1,S.global.__phenixInstantiatedPCastCount>1&&!this.Vt&&this.z.warn("Avoid using multiple instances of PCast as this uses unnecessary resources and will reduce performance. This is your [%s] simultaneous instance. Remember to dispose all resources when done with them by calling .stop() or .dispose()",S.global.__phenixInstantiatedPCastCount),this.Jt=!1,this.ie=!0,this.Kt=e,this.Qt=i,this.ee=n,this.te=r,this.ne=new m(this.z,this.Nt),this.re=new u(this.U,this.Dt,this.z,this.ne),W.call(this,"connecting"),this.Xt={},this.Zt={},this.$t={},this.se=[],this.h.add(this.re),this.h.add(this.ne);var s=this;s.re.resolveUri(function(e,i){if(e){switch(s.z.error("Failed to connect to [%s]",s.Dt,e),W.call(s,"offline"),e.code){case 0:s.Qt.call(s,s,"network-unavailable","");break;case 503:s.Qt.call(s,s,"capacity","");break;default:s.Qt.call(s,s,"failed","")}return s.Jt=!0,void(s.ie=!1)}s.z.info("Discovered end point [%s] with RTT [%s]",i.uri,i.roundTripTime),s.Yt=i.roundTripTime/2,s.oe=i.uri,function(e){this.Ht=new a(e,this.At,this.U,this.z),this.Ht.onEvent("connected",t.bind(T,this)),this.Ht.onEvent("reconnecting",t.bind(R,this)),this.Ht.onEvent("reconnected",t.bind(C,this)),this.Ht.onEvent("disconnected",t.bind(x,this)),this.Ht.onEvent("pcast.StreamEnded",t.bind(P,this)),this.Ht.onEvent("pcast.StreamDataQuality",t.bind(q,this)),this.z.setObservableSessionId&&this.z.setObservableSessionId(this.Ht.getObservableSessionId()),this.ae&&(this.ae.dispose(),this.ne.setSessionId(null)),this.ae=this.Ht.getObservableSessionId().subscribe(t.bind(this.ne.setSessionId,this.ne))}.call(s,i.uri)})},I.prototype.stop=function(){if(this.ie){this.Jt=!0,this.ie=!1,delete this.Qt;try{var e=this;t.forOwn(this.Zt,function(t,i){D.call(e,i,"")}),t.forOwn(this.$t,function(i,n){D.call(e,n,""),t.includes(i.getOptions(),"detached")||i.stop("",!0)}),t.forOwn(this.Xt,function(t,i){D.call(e,i,"")}),t.forEach(this.se,function(e){var i=e.getTracks();t.forEach(i,function(t){t.stop()})})}finally{this.Ht&&(this.Ht.disconnect(),this.Ht=null),this.z.setObservableSessionId&&this.z.setObservableSessionId(null),this.ae&&(this.ae.dispose(),this.ne.setSessionId(null)),S.global.__phenixInstantiatedPCastCount--,this.h.dispose()}}},I.prototype.getUserMedia=function(t,i,n){if("IE"===S.browser)throw new Error("Publishing not supported on IE");return e.V(t,"options"),e.S(i,"callback"),n&&e.S(n,"onScreenShare"),new h(this.z,this.Ft,n).getUserMedia(t,i)},I.prototype.publish=function(i,n,r,s,o){if("IE"===S.browser)throw new Error("Publishing not supported on IE");if(!this.ie)throw new Error("PCast not started. Unable to publish. Please start pcast first.");if("string"!=typeof i)throw new Error('"streamToken" must be a string');if("object"!=typeof n&&"string"!=typeof n)throw new Error('"streamToPublish" must be an object or URI');if("function"!=typeof r)throw new Error('"callback" must be a function');if(s=s||[],!Array.isArray(s))throw new Error('"tags" must be an array');if("object"!=typeof(o=o||{}))throw new Error('"options" must be an object');var a=this,u=t.assign({},o,{negotiate:!0});"string"==typeof n?(u.negotiate=!1,u.connectUri=n):u.connectUri=o.connectUri,s.length>0&&(u.tags=s);var c=new p(this.getProtocol().getSessionId(),this.z,this.Nt);c.setProperty("resource","upload"),this.Ht.setupStream("upload",i,u,2*a.Yt,function(i,s){if(i)return a.z.error("Failed to create uploader [%s]",i),r.call(a,a,"failed");if("ok"===s.status){var h=s.createStreamResponse.streamId;if(c.setStreamId(h),c.setStartOffset(s.createStreamResponse.offset),c.recordMetric("Provisioned"),c.recordMetric("RoundTripTime",{uint64:2*a.Yt},null,{resource:a.oe,kind:"https"}),!0===u.negotiate){var f=s.createStreamResponse.createOfferDescriptionResponse.sessionDescription.sdp,l=_(z(s.createStreamResponse.rtcConfiguration));if("Opera"===S.browser&&a.Gt.length>0){var p=t.get(k.getH264ProfileIds(f),[0]),m=k.getH264ProfileIdWithSameProfileAndEqualToOrHigherLevel(a.Gt,p);m?p!==m&&(a.z.info("[%s] Replacing publisher h264 profile level id [%s] with new value [%s] in offer sdp",h,p,m),f=k.replaceH264ProfileId(f,p,m)):a.z.warn("[%s] Unable to find new publisher h264 profile level id to replace [%s]. Rejected environment defaults of [%s]",h,p,a.Gt)}return function(i,n,r,s,o,a,u,c){var h=this,f={failed:!1,stopped:!1},l=s.match(/a=crypto:/i),p=s.match(/m=application /i),m=new S.RTCPeerConnection(i,{optional:[{DtlsSrtpKeyAgreement:!l},{RtpDataChannels:p}]}),g=null,y=null,w=null;if(h.Xt[r]=m,m.addStream(n),"Firefox"===S.browser||"Edge"===S.browser){if(s.match(/(\nm=video)/g)&&s.match(/(\nm=audio)/g)){var b=/(a=candidate)((.|\n)*)(?=m=)/g;s=s.replace(b,s.match(b)+"a=end-of-candidates\n")}s=(s+="a=end-of-candidates").replace(/(\na=ice-options:trickle)/g,"")}var k=function(t){f.failed||(f.failed=!0,f.stopped=!0,delete h.Xt[r],V.call(h,r,m,"failure"),a.call(h,void 0,t||"failed"))};A.call(h,r,f,m,o,function(t){var e=h.$t[r];g=t,e&&e.remoteMediaStreamCallback&&e.remoteMediaStreamCallback(e,t)},u),N.call(h,r,m,function(t){y&&y(t)}),F.call(h,r,m);var E=new S.RTCSessionDescription({type:"offer",sdp:s});m.setRemoteDescription(E,function(){h.z.info("Set remote description (offer)");var i={mandatory:{}};"Chrome"===S.browser||"ReactNative"===S.browser?(i.mandatory.OfferToReceiveVideo=!0===u.receiveVideo,i.mandatory.OfferToReceiveAudio=!0===u.receiveAudio):(i.mandatory.offerToReceiveVideo=!0===u.receiveVideo,i.mandatory.offerToReceiveAudio=!0===u.receiveAudio),m.createAnswer(function(i){h.z.info("Created answer [%s]",i.sdp),h.Ht.setAnswerDescription(r,i.sdp,function(i,o){if(i)return h.z.error("Failed to set answer description [%s]",i),k();if("ok"!==o.status)return h.z.warn("Failed to set answer description, status [%s]",o.status),k(o.status);t.includes(o.options,"ice-candidates")&&(y=function(e){var i=[],n=[];e?i.push(e):n.push("completed"),h.Ht.addIceCandidates(r,i,n,function(e,i){e?h.z.error("Failed to add ICE candidate [%s]",e):"ok"===i.status?t.includes(i.options,"cancel")&&(y=null):h.z.warn("Failed to add ICE candidate, status [%s]",i.status)})});var u=new S.RTCSessionDescription({type:"answer",sdp:o.sessionDescription.sdp});m.setLocalDescription(u,function(){var i=/(b=AS:([0-9]*)[\n\r]*)/gi,o=/(mid:video)([\n\r]*)/gi;h.z.info("Set local description (answer)");var u=0,l=i.exec(s);l&&l.length>=3&&(u=1e3*l[2]);var p={getStreamId:function(){return r},getStream:function(){return n},isActive:function(){return!f.stopped},hasEnded:function(){switch(m.iceConnectionState){case"new":case"checking":case"connected":case"completed":return!1;case"disconnected":case"failed":case"closed":default:return!0}},stop:function(t){f.stopped||(V.call(h,r,m,"closed"),h.Ht.destroyStream(r,t||"",function(t,e){t?h.z.error("[%s] failed to destroy stream [%s]",r,t):"ok"===e.status?h.z.info("[%s] destroyed stream",r):h.z.warn("[%s] failed to destroy stream, status [%s]",r,e.status)}),f.stopped=!0)},setPublisherEndedCallback:function(t){if("function"!=typeof t)throw new Error('"callback" must be a function');this.publisherEndedCallback=t},setDataQualityChangedCallback:function(t){if("function"!=typeof t)throw new Error('"callback" must be a function');this.dataQualityChangedCallback=t},limitBandwidth:function(t){if("Edge"===S.browser)return h.z.warn("Limit bandwidth not support on [%s]",S.browser);if("number"!=typeof t)throw new Error('"bandwidthLimit" must be a number');var e=u?Math.min(t,u):t,n=m.remoteDescription;h.z.info("Changing bandwidth limit to [%s]",e);var r=n.sdp.replace(i,"");r=r.replace(o,function(t,i,n,r,s){return[i,n,"b=AS:",Math.ceil(e/1e3),n].join("")});var s=new S.RTCSessionDescription({type:n.type,sdp:r});return m.setRemoteDescription(s),{dispose:function(){m.setRemoteDescription(n)}}},getMonitor:function(){return w},monitor:function(e,i){if("object"!=typeof e)throw new Error('"options" must be an object');if("function"!=typeof i)throw new Error('"callback" must be a function');var s=new d(r,m,h.z);return e.direction="outbound",s.start(e,function(){return h.$t[r]===p&&!f.stopped},function(t,e){return t&&h.z.warn("[%s] Publisher monitor triggered unrecoverable error [%s]",t),h.z.warn("[%s] Publisher triggered monitor condition for [%s]",r,e.type),i(p,"client-side-failure",e)}),t.forEach(n.getTracks(),function(e){t.addEventListener(e,"readystatechange",function(){if("ended"===e.readyState)return h.z.warn("[%s] Publisher track has failed [%s]",r,e),i(p,"camera-track-failure",{type:e.kind+"-track-ended",message:"Publisher "+e.kind+" track has ended in an unrecoverable way. This may require reconfiguring your camera or microphone."})})}),w=s,s},setRemoteMediaStreamCallback:function(t){if("function"!=typeof t)throw new Error('"callback" must be a function');this.remoteMediaStreamCallback=t,g&&t(p,g)},getOptions:function(){return c},getStats:function(t){e.S(t,"callback"),this.ue||(this.ue={});var i=this;return S.getStats(m,null,function(e){t(v.convertPeerConnectionStats(e,i.ue))})}};h.$t[r]=p,a.call(h,p)},k)})},k,i)},k)}.call(a,l,n,h,f,c,function(t,e){c.recordMetric("SetupCompleted",{string:e?"failed":"ok"}),e?r.call(a,a,"failed",null):r.call(a,a,"ok",t)},o,s.createStreamResponse.options)}return function(t,e,i){var n=this,r={stopped:!1},s={getStreamId:function(){return t},getStream:function(){return n.z.debug("[%s] Unable to get stream on publisher of remote origin.",t),null},getStats:function(){return n.z.debug("[%s] Unable to get stream stats on publisher of remote origin.",t),null},isActive:function(){return!r.stopped},hasEnded:function(){return r.stopped},stop:function(e){r.stopped||(n.Ht.destroyStream(t,e||"",function(e,i){e?n.z.error("[%s] failed to destroy stream [%s]",t,e):"ok"===i.status?n.z.info("[%s] destroyed stream",t):n.z.warn("[%s] failed to destroy stream, status [%s]",t,i.status)}),r.stopped=!0)},setPublisherEndedCallback:function(t){if("function"!=typeof t)throw new Error('"callback" must be a function');this.publisherEndedCallback=t},setDataQualityChangedCallback:function(t){if("function"!=typeof t)throw new Error('"callback" must be a function');this.dataQualityChangedCallback=t},getOptions:function(){return i},monitor:function(t,e){if("object"!=typeof t)throw new Error('"options" must be an object');if("function"!=typeof e)throw new Error('"callback" must be a function')},getMonitor:function(){return null}};n.$t[t]=s,e(s)}.call(a,h,function(t,e){c.recordMetric("SetupCompleted",{string:e?"failed":"ok"}),e?r.call(a,a,"failed",null):r.call(a,a,"ok",t)},s.createStreamResponse.options)}switch(a.z.warn("Failed to create uploader, status [%s]",s.status),s.status){case"timeout":case"capacity":case"unauthorized":return r.call(a,a,s.status);default:return r.call(a,a,"failed")}})},I.prototype.subscribe=function(e,i,n){if(!this.ie)throw new Error("PCast not started. Unable to subscribe. Please start pcast first.");if("string"!=typeof e)throw new Error('"streamToken" must be a string');if("function"!=typeof i)throw new Error('"callback" must be a function');if("object"!=typeof(n=n||{}))throw new Error('"options" must be an object');var r=this;j.call(r,function(){var s=t.assign({},n,{negotiate:!1!==n.negotiate}),o=new p(r.getProtocol().getSessionId(),r.z,r.Nt),a=t.assign({},n);a.canPlaybackAudio=r.zt,!r.zt&&n.disableAudioIfNoOutputFound&&!1!==n.receiveAudio&&(s.receiveAudio=!1,a.receiveAudio=!1,a.forcedAudioDisabled=!0),o.setProperty("resource","download"),r.Ht.setupStream("download",e,s,2*r.Yt,function(e,n){if(e)return r.z.error("Failed to create downloader [%s]",e),i.call(r,r,"failed");if("ok"===n.status){var s=n.createStreamResponse.streamId,u=n.createStreamResponse.createOfferDescriptionResponse.sessionDescription.sdp,c=_(z(n.createStreamResponse.rtcConfiguration)),h=t.bind(U,r,c),d=u.match(/a=x-playlist:/);if(d&&(h=L),o.setStreamId(s),o.setStartOffset(n.createStreamResponse.offset),o.recordMetric("Provisioned"),o.recordMetric("RoundTripTime",{uint64:2*r.Yt},null,{resource:r.getBaseUri(),kind:"https"}),a.originStartTime=t.now()-n.createStreamResponse.offset+r.Yt,!d&&("Chrome"===S.browser&&S.browserVersion>=62&&J()||"Opera"===S.browser)&&r.Gt.length>0){var f=t.get(k.getH264ProfileIds(u),[0]),l=k.getH264ProfileIdWithSameOrHigherProfileAndEqualToOrHigherLevel(r.Gt,f);l?f!==l&&(r.z.info("[%s] Replacing subscriber h264 profile level id [%s] with new value [%s] in offer sdp",s,f,l),u=k.replaceH264ProfileId(u,f,l)):r.z.warn("[%s] Unable to find new subscriber h264 profile level id to replace [%s]. Rejected environment defaults of [%s]",s,f,r.Gt)}return h.call(r,s,u,o,function(t,e){o.recordMetric("SetupCompleted",{string:e?"failed":"ok"}),e?i.call(r,r,"failed",null):i.call(r,r,"ok",t)},a)}switch(r.z.warn("Failed to create downloader, status [%s]",n.status),n.status){case"capacity":case"stream-ended":case"origin-stream-ended":case"streaming-not-available":case"unauthorized":case"timeout":return i.call(r,r,n.status);default:return i.call(r,r,"failed")}})})},I.prototype.getProtocol=function(){return this.Ht},I.prototype.getLogger=function(){return this.z},I.prototype.toString=function(){var t=this.getProtocol();return"PCast["+(t?t.getSessionId():"")||"unauthenticated,"+(t?t.toString():"uninitialized")+"]"};var J=function(){var e=t.get(S,["global","navigator","userAgent"],"");return H()||/Android|webOS|BlackBerry|IEMobile|Opera Mini|Mobile|mobile|CriOS/i.test(e)},H=function(){var e=t.get(S,["global","navigator","userAgent"],"");return/iPad|iPhone|iPod/.test(e)&&!S.global.MSStream},K=function(e){var i=e.match(/(?=a=group:BUNDLE).*/),n=t.get(t.get(i,[0],"").split("a=group:BUNDLE "),[1],""),r=n.split(" ").sort(function(t,i){return e.indexOf("m="+t)>e.indexOf("m="+i)});return r.length>0&&(e=e.replace(n,r.join(" "))),e};return I}.apply(e,n))||(t.exports=r)},function(t,e,i){var n,r;n=[i(0),i(1),i(3)],void 0===(r=function(t,e,i){"use strict";function n(t,e){this.latestValue=null,this.subscribeCallbacks={},this.subscriptionTimeout=100,this.subscriptionCount=0,this.resetOnChange=!1,this.lastChangeTime=0,this.isPendingChanges=!1,this.beforeChange=e,s.call(this,t)}function r(e){return void 0===e||null===e?e:t.isArray(e)?e.slice():e}function s(t){var e=t;this.beforeChange&&(e=this.beforeChange(t)),this.latestValue=r(e)}function o(e,i){if(this.lastChangeTime=t.now(),!this.isPendingChanges&&0!==this.subscriptionCount){if(this.isPendingChanges=!0,i)return a.call(this);(function e(i){var n=this;setTimeout(function(){var i=t.now()-n.lastChangeTime;n.resetOnChange&&i<n.subscriptionTimeout?e.call(n,n.subscriptionTimeout-i):a.call(n)},i)}).call(this,e)}}function a(){try{(function(){var e=this;t.forOwn(e.subscribeCallbacks,function(i){t.S(i)&&i(e.latestValue)})}).call(this)}finally{this.isPendingChanges=!1}}return n.prototype.getValue=function(){return r(this.latestValue)},n.prototype.setValue=function(t){t!==this.latestValue&&(s.call(this,t),o.call(this,this.subscriptionTimeout))},n.prototype.subscribe=function(n,r){e.S(n,"callback"),r&&e.V(r,"options");var s,a=this,u=t.uniqueId();return a.subscribeCallbacks[u]=n,a.subscriptionCount+=1,r&&("notify"===r.initial&&o.call(a,a.subscriptionTimeout,!0),r.listenForChanges&&(s=setInterval(function(){var t=r.listenForChanges.callback();t!==a.latestValue&&a.setValue(t)},r.listenForChanges.timeout))),new i.Disposable(function(){delete a.subscribeCallbacks[u],s&&(clearInterval(s),s=null),a.subscriptionCount-=1})},n.prototype.extend=function(i){switch(e.V(i,"options"),i.method){case"notifyWhenChangesStop":this.subscriptionTimeout=i.timeout,this.resetOnChange=!0;break;case"notifyAtFixedRate":this.subscriptionTimeout=i.timeout}return t.lt(i.rateLimit)&&(this.subscriptionTimeout=i.rateLimit),this},n}.apply(e,n))||(t.exports=r)},function(t,e,i){var n;void 0===(n=function(){"use strict";return{errorSeverity:{recoverable:{id:1,name:"RECOVERABLE"},critical:{id:2,name:"CRITICAL"}}}}.apply(e,[]))||(t.exports=n)},function(t,e,i){var n,r;n=[i(0),i(1),i(5),i(3)],void 0===(r=function(t,e,i,n){"use strict";var r=2e4,s={timeout:r,retryOptions:{backoff:1.5,delay:1e3,maxAttempts:3,additionalRetryErrorCodes:[0]}};function o(t,i){e.Ot(t,"backendUri"),e.V(i,"authenticationData"),this.ce=t,this.he=i,this.h=new n.DisposableList}function a(e,i){var s=null,o=e(t.bind(c,this,function(t,e){clearTimeout(s),i(t,e)}));s=setTimeout(function(){o.dispose(),i(new Error("timeout"))},r),this.h.add(o),this.h.add(new n.Disposable(function(){clearTimeout(s)}))}function u(e){return t.assign({},e,this.he)}function c(t,e,i){if(e)return t(e,{});var n=JSON.parse(i.data);return"ok"!==n.status?t(null,{status:n.status}):t(null,n)}return o.prototype.dispose=function(){return this.h.dispose()},o.prototype.createAuthenticationToken=function(e){var n=u.call(this,{}),r=t.bind(i.postWithRetry,i,this.ce+"/auth",JSON.stringify(n),s);return a.call(this,r,e)},o.prototype.createStreamTokenForPublishing=function(n,r,o){e.Ot(n,"sessionId"),e.V(r,"capabilities");var c=u.call(this,{sessionId:n,capabilities:r}),h=t.bind(i.postWithRetry,i,this.ce+"/stream",JSON.stringify(c),s);return a.call(this,h,o)},o.prototype.createStreamTokenForSubscribing=function(n,r,o,c,h){e.Ot(n,"sessionId"),e.V(r,"capabilities"),t.isNullOrUndefined(c)||(e.isArray(c,"additionalStreamIds"),t.forEach(c,function(t){e.Ot(t,"alternateOriginStreamId")}));var d=u.call(this,{sessionId:n,capabilities:r,originStreamId:o});c&&c.length>0&&(d.alternateOriginStreamIds=c);var f=t.bind(i.postWithRetry,i,this.ce+"/stream",JSON.stringify(d),s);return a.call(this,f,h)},o.prototype.getStreams=function(e){var n=t.bind(i.getWithRetry,i,this.ce+"/streams",s);return a.call(this,n,e)},o}.apply(e,n))||(t.exports=r)},function(t,e,i){var n,r;n=[i(0),i(1),i(7),i(10),i(26),i(14),i(23),i(2),i(25)],void 0===(r=function(t,e,i,n,r,s,o,a,u){"use strict";var c="unauthorized",h=1e3,d=2e4,f={maxOfflineTime:18e4,maxReconnectFrequency:6e4};function l(n){if(e.V(n,"options"),e.Ot(n.backendUri,"options.backendUri"),e.V(n.authenticationData,"options.authenticationData"),n.authToken&&e.Ot(n.authToken,"options.authToken"),n.onError&&e.S(n.onError,"options.onError"),!t.isNullOrUndefined(n.onlineTimeout)&&(e.lt(n.onlineTimeout,"options.onlineTimeout"),n.onlineTimeout<0))throw new Error('"options.onlineTimeout" must be a positive number');n.reconnectOptions&&(e.V(n.reconnectOptions,"options.reconnectOptions"),e.lt(n.reconnectOptions.maxOfflineTime,"options.reconnectOptions.maxOfflineTime"),e.lt(n.reconnectOptions.maxReconnectFrequency,"options.reconnectOptions.maxReconnectFrequency")),this.de=new i.Observable(null).extend({rateLimit:0}),this.fe={},this.$t={},this.le=new r(n.backendUri,n.authenticationData),this.pe=!1,this.me=0,this.ve=0,this.Kt=n.authToken,this.ge=n.onError,this.$=n,this.ye=t.lt(n.onlineTimeout)?n.onlineTimeout:d,this.we=n.reconnectOptions||f,this.z=null,m.call(this)}l.prototype.dispose=function(){this.be&&(this.be.dispose(),this.be=null),this.de.getValue()&&(this.de.getValue().stop(),this.de.setValue(null)),t.lt(this.Se)&&(clearTimeout(this.Se),this.Se=null),this.le.dispose(),this.ve=0,this.me=0,this.z.info("Disposed PCast Express Instance")},l.prototype.getPCast=function(){return this.de.getValue()},l.prototype.getPCastObservable=function(){return this.de},l.prototype.getAdminAPI=function(){return this.le},l.prototype.getUserMedia=function(t,i){var n=this;if(e.V(t.mediaConstraints,"options.mediaConstraints"),e.S(i,"callback"),t.resolution&&e.lt(t.resolution,"options.resolution"),t.frameRate&&e.lt(t.frameRate,"options.frameRate"),t.aspectRatio&&e.Ot(t.aspectRatio,"options.aspectRatio"),t.onResolveMedia&&e.S(t.onResolveMedia,"options.onResolveMedia"),t.onScreenShare&&e.S(t.onScreenShare,"options.onScreenShare"),n.de.getValue())return b.call(n,n.de.getValue(),t,i);var r=n.de.subscribe(function(e){e&&(r.dispose(),b.call(n,e,t,i))})},l.prototype.publish=function(t,i){e.V(t,"options"),e.S(i,"callback"),t.capabilities&&e.isArray(t.capabilities,"options.capabilities"),t.connectOptions&&e.isArray(t.connectOptions,"options.connectOptions"),t.mediaConstraints?e.V(t.mediaConstraints,"options.mediaConstraints"):e.V(t.userMediaStream,"options.userMediaStream"),t.videoElement&&e.V(t.videoElement,"options.videoElement"),t.monitor&&(e.V(t.monitor,"options.monitor"),e.S(t.monitor.callback,"options.monitor.callback"),t.monitor.options&&e.V(t.monitor.options,"options.monitor.options")),t.streamToken&&e.Ot(t.streamToken,"options.streamToken");var n=this;this.waitForOnline(function(e){return e?i(e):t.userMediaStream?S.call(n,t.userMediaStream,t,!1,i):void n.getUserMedia(t,function(e,r){return e?i(e):"ok"!==r.status?i(null,r):void S.call(n,r.userMedia,t,!0,i)})},t.isContinuation)};var p=["streaming","low-latency","on-demand","uld","vvld","vld","ld","sd","hd","fhd","uhd"];function m(){var e=this;if(!this.de.getValue()){var i=t.assign({logger:this.z},this.$);this.de.setValue(new o(i))}if(this.z||(this.z=this.de.getValue().getLogger()),this.ke||(this.ke=this.de.getValue().getObservableStatus().subscribe(t.bind(v,this))),this.Kt)return this.de.getValue().start(this.Kt,t.noop,t.noop,t.noop);this.le.createAuthenticationToken(function(i,n){return i&&"timeout"===i.message?v.call(e,i.message):i?w.call(e,i):"ok"!==n.status?v.call(e,n.status):e.de.getValue()?void e.de.getValue().start(n.authenticationToken,t.noop,t.noop,t.noop):e.z.warn("Unable to authenticate. PCast not instantiated.")})}function v(t){switch(t){case"timeout":case"critical-network-issue":return this.de.getValue()&&(this.de.getValue().stop("express-recovery"),this.de.setValue(null)),this.ke&&(this.ke.dispose(),this.ke=null),this.ve++,g.call(this);case"reconnect-failed":case"unauthorized":return delete this.Kt,this.me++,this.me>1?w.call(this,new Error(t)):(this.z.info("[Express] Attempting to create new authToken and re-connect after [%s] response",c),y.call(this));case"capacity":case"network-unavailable":return this.ve++,g.call(this);case"online":return this.me=0,this.ve=0,this.pe||this.z.info("Express API successfully instantiated"),void(this.pe=!0);case"reconnecting":case"reconnected":case"connecting":break;case"offline":return;case"failed":default:return w.call(this,new Error(t))}}function g(){var t=this,e=Math.min(h*t.ve*t.ve,this.we.maxReconnectFrequency),i=Math.min(e/1e4,5),n=e+Math.random()*i*1e3;this.z.info("Waiting for [%s] ms before continuing to attempt to reconnect to PCast",n),this.Se=setTimeout(function(){return t.de.getValue()&&t.de.getValue().isStarted()?y.call(t):m.call(t)},n)}function y(){var t=this;this.le.createAuthenticationToken(function(e,i){return e&&"timeout"===e.message?v.call(t,e.message):e?w.call(t,e):"ok"!==i.status?v.call(t,i.status):t.de.getValue()?void t.de.getValue().reAuthenticate(i.authenticationToken):t.z.warn("Unable to authenticate. PCast not instantiated.")})}function w(t){if(!this.ge)throw t;this.ge(t)}function b(i,n,r){new s(i,{aspectRatio:n.aspectRatio,resolutionHeight:n.resolution,frameRate:n.frameRate,resolutionSelectionStrategy:n.resolutionSelectionStrategy,onScreenShare:function(i){return(i=n.onScreenShare?n.onScreenShare(i):i).resolution&&e.lt(i.resolution,"clientOptions.resolution"),i.frameRate&&e.lt(i.frameRate,"screenOptions.frameRate"),i.aspectRatio&&e.Ot(i.aspectRatio,"screenOptions.aspectRatio"),t.assign({resolutionHeight:i.resolution},i)}}).getUserMedia(n.mediaConstraints,function(e,i){if(e)return r(e);n.onResolveMedia&&n.onResolveMedia(i.options),r(null,t.assign({status:"ok"},i))})}function S(t,i,n,r){var s=this;if(e.isArray(i.capabilities,"options.capabilities"),i.streamToken)return k.call(s,i.streamToken,t,i,n,r);s.waitForOnline(function(e){if(e)return s.z.error("Failed to create stream token for publishing after waiting for online status",e),r(e);var o=s.de.getValue().getProtocol().getSessionId();s.z.info("[%s] Creating stream token for publishing",o),s.le.createStreamTokenForPublishing(o,i.capabilities,function(e,a){return e?(s.z.error("[%s] Failed to create stream token for publishing",o,e),r(e)):"ok"!==a.status?(s.z.warn("[%s] Failed to create stream token for publishing with status [%s]",o,a.status),r(null,a)):void k.call(s,a.streamToken,t,i,n,r)})},i.isContinuation)}function k(i,n,r,s,o){var u=this,h=!1;r.tags&&e.isArray(r.tags,"options.tags"),r.connectOptions&&e.isArray(r.connectOptions,"options.connectOptions");var d=function(e,d,f){var l=function(e){var a=t.uniqueId(),c=t.assign({streamToken:i,isContinuation:!0},r);u.$t[a]=!0,u.z.warn("Retrying publisher after failure with reason [%s]",e),"camera-track-failure"===e?(f.stop(e,!1),u.publish(r,o)):(f.stop(e,!0),S.call(u,n,c,s,o)),delete u.$t[a]};if(d===c&&r.streamToken||"timeout"===d){u.z.info("[Express] Attempting to create new streamToken and re-publish after [%s] response",c);var p=t.assign({isContinuation:!0},r);return delete p.streamToken,S.call(u,n,p,s,o)}if("ok"!==d)return u.z.warn("Failure to publish with status [%s]",d),o(null,{status:d});u.$t[f.getStreamId()]=f,r.videoElement&&!h&&(a.attachMediaStream(r.videoElement,n),h=!0);var m=t.bind(x,u,function(){},l,!0);if(r.monitor){var v=t.bind(C,u,r.monitor.callback,l);f.monitor(r.monitor.options||{},v),m=t.bind(x,u,r.monitor.callback,l,!0)}f.setPublisherEndedCallback(m);var g=function(e,i,n){var r=t.bind(e.stop,e);return e.stop=function(t,s){if(r(t),i&&(i.src="",i.srcObject=null),n&&e.getStream()&&!s){var o=e.getStream();o&&o.getTracks().forEach(function(t){t.stop()})}},e.enableAudio=function(){return I(e.getStream(),!0)},e.disableAudio=function(){return I(e.getStream(),!1)},e.enableVideo=function(){return T(e.getStream(),!0)},e.disableVideo=function(){return T(e.getStream(),!1)},e.setPublisherEndedCallback=function(){},e}.call(u,f,r.videoElement,s);o(null,{status:"ok",publisher:g})};u.waitForOnline(function(t){if(t)return o(t);u.de.getValue().publish(i,n,d,r.tags,{connectOptions:r.connectOptions})},r.isContinuation)}function E(e,i,r){var s=this,o=function(o,a,h){var d,f=function(n){var o=t.uniqueId(),a=t.assign({isContinuation:!0},i);s.fe[o]=!0,h.stop(n),s.z.warn("[%s] Stream failure occurred with reason [%s]. Attempting to recover from failure.",i.streamId,n),E.call(s,e,a,r),delete s.fe[o]};if(a===c&&i.streamToken||"timeout"===a){s.z.info("[%s] [Express] Attempting to create new streamToken and re-subscribe after [%s] response",i.streamId,c);var l=t.assign({isContinuation:!0},i);return delete l.streamToken,s.subscribe(l,r)}if("streaming-not-ready"===a)return s.z.warn("Failure to subscribe with status [%s]. Try again in a few seconds.",a),r(null,{status:a,retry:t.bind(f,s,a)});if("ok"!==a)return s.z.warn("Failure to subscribe with status [%s]",a),r(null,{status:a});s.fe[h.getStreamId()]=h,i.videoElement&&(d=h.createRenderer()).start(i.videoElement);var p=t.noop,m=t.bind(x,s,p,f,!1);if(i.monitor){var v=t.bind(C,s,i.monitor.callback,f);h.monitor(i.monitor.options||{},v),m=t.bind(x,s,i.monitor.callback,f,!1)}h.setStreamEndedCallback(m);var g=function(e,i){var n=t.bind(e.stop,e);return e.stop=function(t){i&&i.stop(),n(t)},e.enableAudio=function(){return I(e.getStream(),!0)},e.disableAudio=function(){return I(e.getStream(),!1)},e.enableVideo=function(){return T(e.getStream(),!0)},e.disableVideo=function(){return T(e.getStream(),!1)},e.setStreamEndedCallback=function(){},e}.call(s,h,d),y={status:"ok",mediaStream:g};h.setStreamErrorCallback(function(e,o,a){if("real-time"===o&&"connection-timeout"===a.message)return f.call(s,a.message);if("shaka"!==o||a.severity===u.errorSeverity.critical.id){if("phenix-player"===o&&a.severity===n.errors.severity.RECOVERABLE){s.z.warn("[%s] Recoverable error occurred while playing stream with Express API. Attempting to subscribe again.",g.getStreamId(),a);var c=t.assign({isContinuation:!0},i);return delete c.streamToken,s.subscribe(c,r)}return s.z.warn("[%s] Error occurred while playing stream with Express API. Stopping stream.",g.getStreamId(),a),g.stop(),r(a)}}),d&&(y.renderer=d),r(null,y)};s.waitForOnline(function(t){if(t)return r(t);s.de.getValue().subscribe(e,o,i.subscriberOptions)},i.isContinuation)}function I(t,e){if(t)return R(t.getAudioTracks(),e),e}function T(t,e){if(t)return R(t.getVideoTracks(),e),e}function R(i,n){e.isArray(i,"tracks"),t.forEach(i,function(t){t.enabled=n})}function C(e,i,n,r,s){switch(r){case"camera-track-failure":case"client-side-failure":e(null,t.assign({status:r,retry:t.bind(i,null,r)},s))}}function x(t,e,i,n,r,s){var o={status:"stream-ended",reason:r,description:s};switch(r){case"ended":case"censored":var a={status:r,reason:r,description:s};return i?a.publisher=n:a.mediaStream=n,t(null,a);case"custom":return t(null,o);case"capacity":return setTimeout(function(){return e(r)},h);case"failed":case"maintenance":return e(r);case"app-background":default:return o.retry=e,t(null,o)}}return l.prototype.publishRemote=function(i,n){if(e.V(i,"options"),e.S(n,"callback"),e.Ot(i.streamUri,"options.streamUri"),i.capabilities&&e.isArray(i.capabilities,"options.capabilities"),i.connectOptions&&e.isArray(i.connectOptions,"options.connectOptions"),i.mediaConstraints)throw new Error("Invalid argument, Media Constraints, for publishing remote.");if(i.videoElement)throw new Error("May not view remote stream publisher. Please subscribe to view.");i.prerollSkipDuration&&e.lt(i.prerollSkipDuration,"options.prerollSkipDuration"),i.monitor&&(e.V(i.monitor,"options.monitor"),e.S(i.monitor.callback,"options.monitor.callback"),i.monitor.options&&e.V(i.monitor.options,"options.monitor.options")),i.frameRate&&(e.V(i.frameRate,"options.frameRate"),i.frameRate.exact&&e.lt(i.frameRate.exact,"options.frameRate.exact"),i.frameRate.max&&e.lt(i.frameRate.max,"options.frameRate.max")),i.streamToken&&e.Ot(i.streamToken,"options.streamToken");var r=this;this.waitForOnline(function(e){if(e)return n(e);var s=t.assign({connectOptions:[],capabilities:[]},i);t.includes(s.capabilities,"publish-uri")||s.capabilities.push("publish-uri"),t.forEach(p,function(e){t.includes(s.capabilities,e)&&s.connectOptions.push("publisher-capability="+e)}),i.frameRate&&i.frameRate.exact&&s.connectOptions.push("source-uri-video-fps="+i.frameRate.exact),i.frameRate&&i.frameRate.max&&s.connectOptions.push("source-uri-video-fps-max="+i.frameRate.max),s.connectOptions.push("source-uri-preroll-skip-duration="+(t.lt(i.prerollSkipDuration)?i.prerollSkipDuration:500).toString()),S.call(r,s.streamUri,s,!1,n)})},l.prototype.publishScreen=function(e,i){var n=t.assign({mediaConstraints:{screen:!0}},e);return t.set(n,["monitor","options"],t.assign({},{monitorFrameRate:!1,videoBitRateThreshold:100,conditionCountForNotificationThreshold:8},t.get(n,["monitor","options"],{}))),this.publish(n,i)},l.prototype.subscribe=function(t,i){e.V(t,"options"),e.S(i,"callback"),e.Ot(t.streamId,"options.streamId"),e.V(t.capabilities,"options.capabilities"),t.videoElement&&e.V(t.videoElement,"options.videoElement"),t.monitor&&(e.V(t.monitor,"options.monitor"),e.S(t.monitor.callback,"options.monitor.callback"),t.monitor.options&&e.V(t.monitor.options,"options.monitor.options")),t.streamToken&&e.Ot(t.streamToken,"options.streamToken"),t.subscriberOptions&&e.V(t.subscriberOptions,"options.subscriberOptions");var n=this;this.waitForOnline(function(e){return e?(n.z.error("Failed to subscribe after error waiting for online status",e),i(e)):t.streamToken?E.call(n,t.streamToken,t,i):void n.le.createStreamTokenForSubscribing(n.de.getValue().getProtocol().getSessionId(),t.capabilities,t.streamId,null,function(e,r){return e?(n.z.error("Failed to create stream token for subscribing",e),i(e)):"ok"!==r.status?(n.z.warn("Failed to create stream token for subscribing with status [%s]",r.status),i(null,r)):void E.call(n,r.streamToken,t,i)})},t.isContinuation)},l.prototype.subscribeToScreen=function(e,i){var n=t.assign({},e);return t.set(n,["monitor","options"],t.assign({},{monitorFrameRate:!1,videoBitRateThreshold:100,conditionCountForNotificationThreshold:8},t.get(n,["monitor","options"],{}))),this.subscribe(n,i)},l.prototype.waitForOnline=function(i,n){if(e.S(i,"callback"),this.de.getValue()&&"online"===this.de.getValue().getStatus())return i();var r=this,s=n?t.get(r.we,["maxOfflineTime"]):this.ye,o=null,a=null,u=setTimeout(function(){r.z.info("Disposing of Express Online listener after [%s] ms",s),o&&o.dispose(),a&&a.dispose(),i(new Error("timeout"))},s);this.z.info("Waiting for Online status before continuing. Timeout set to [%s]",s);var c=function(t){a&&a.dispose(),t&&(a=t.getObservableStatus().subscribe(function(t){if("online"===t)return clearTimeout(u),a.dispose(),o.dispose(),i()},{initial:"notify"}))};this.de.getValue()&&c(this.de.getValue()),o=this.de.subscribe(c)},l}.apply(e,n))||(t.exports=r)},function(t,e,i){var n,r;n=[i(0),i(1)],void 0===(r=function(t,e){"use strict";var i=[{"16x9":[{2160:3840},{1080:1920},{768:1366},{720:1280},{576:1024},{480:853},{360:640},{180:320}]},{"4x3":[{1200:1600},{1080:1440},{720:960},{600:800},{576:768},{480:640},{360:480},{288:352},{240:320},{144:176},{120:160}]}],n={fallbackToLower:{id:0,name:"fallbackToLower"},fallbackToHigher:{id:1,name:"fallbackToHigher"},fallbackToLowerThenHigher:{id:2,name:"fallbackToLowerThenHigher"},exact:{id:3,name:"exact"}};function r(t){e.V(t,"options"),t.resolutionSelectionStrategy&&e.Ee(t.resolutionSelectionStrategy,n,"options.resolutionSelectionStrategy"),t.aspectRatio&&e.Ot(t.aspectRatio,"options.aspectRatio"),t.resolutionHeight&&e.lt(t.resolutionHeight,"options.resolutionHeight"),t.frameRate&&e.lt(t.frameRate,"options.frameRate"),this.Ie=t.resolutionSelectionStrategy||n.fallbackToLowerThenHigher.name,this.Te=t.aspectRatio||"16x9",this.Re=t.resolutionHeight||720,this.Ce=t.frameRate||15}function s(t){return e.lt(t,"value"),2*Math.floor((t+1)/2)}function o(e,n){var r,s,o,a,l=u(n,i),p=c(n,i),m=c(e.toString(),l),v=0===m,g=i.length-1===p;if(t.lt(m)){if(v)return g?null:(s=u(r=h(++p,i),i),o=h(m=f(this.Re,s),l),a=this.calculateWidthByAspectRatio(o,r),{aspectRatio:r,height:parseInt(o),width:parseInt(a)});m--}else if(!(m=f(e,l)))return;return r=h(p,i),o=h(m,s=d(p,i)),a=s[m][o],{aspectRatio:r,height:parseInt(o),width:parseInt(a)}}function a(e,n){var r,s,o,a,f,l,p=u(n,i),m=c(n,i),v=c(e.toString(),p),g=v===p.length-1,y=i.length-1===m;if(t.lt(v)){if(g)return y?null:(r=h(++m,i),o=this.Re,a=this.calculateWidthByAspectRatio(o,r),{aspectRatio:r,height:parseInt(o),width:parseInt(a)});v++}else if(f=e,l=p,!(v=t.keys(l[l.length-1])[0]>f?null:t.reduce(l,function(e,i,n){if(!e)return n;var r=t.keys(l[e])[0],s=t.keys(i)[0];return s>f?e:Math.abs(f-s)<Math.abs(f-r)?n:e})))return;return r=h(m,i),o=h(v,s=d(m,i)),a=s[v][o],{aspectRatio:r,height:parseInt(o),width:parseInt(a)}}function u(e,i){var n=t.find(i,function(t){return t.hasOwnProperty(e)});return n?n[e]:null}function c(e,i){return t.findIndex(i,function(t){return t.hasOwnProperty(e)})}function h(e,i){return t.keys(i[e])[0]}function d(e,i){var n=t.keys(i[e]);return i[e][n[0]]}function f(e,i){return t.keys(i[0])[0]<e?null:t.reduce(i,function(n,r,s){if(!n)return s;var o=t.keys(i[n])[0],a=t.keys(r)[0];return a<e?n:Math.abs(e-a)<Math.abs(e-o)?s:n})}return r.prototype.getDefaultResolution=function(){var t=u(this.Te,i),e=u(this.Re,t)||this.calculateWidthByAspectRatio(this.Re,this.Te);return{height:this.Re,width:e,aspectRatio:this.Te}},r.prototype.getDefaultFrameRate=function(){return this.Ce},r.prototype.getNextResolution=function(t,i){switch(e.lt(t,"height"),e.Ot(i,"aspectRatio"),this.Ie){case n.fallbackToLower.name:return a.call(this,t,i);case n.fallbackToHigher.name:return o.call(this,t,i);case n.fallbackToLowerThenHigher.name:var r=null;return t>this.Re?r=o.call(this,t,i):(r=a.call(this,t,i))&&r.height||(r=o.call(this,this.Re,this.Te)),r;case n.exact.name:default:return}},r.prototype.canResolveNextResolution=function(){return this.Ie!==n.exact.name},r.prototype.calculateWidthByAspectRatio=function(t,e){switch(e){case"16x9":return s(16/9*t);case"4x3":return s(4/3*t);default:throw new Error("Aspect Ratio not supported")}},r}.apply(e,n))||(t.exports=r)},function(t,e,i){var n,r;n=[i(0),i(1),i(2)],void 0===(r=function(t,e){"use strict";var i=/profile-level-id=[^;\n]*/;function n(){}return n.prototype.getH264ProfileIds=function(n){e.Ot(n,"offerSdp");for(var r=[],s=n.match(i),o=n;s;){var a=t.get(s,"0","");r.push(a.split("=")[1]),s=(o=o.substring(s.index+a.length,n.length)).match(i)}return r},n.prototype.replaceH264ProfileId=function(i,n,r){e.Ot(i,"offerSdp"),e.Ot(r,"newProfileId");var s=this.getH264ProfileIds(i);return t.includes(s,n)?i.replace("profile-level-id="+n,"profile-level-id="+r):i},n.prototype.getH264ProfileIdWithSameProfileAndEqualToOrHigherLevel=function(e,i){if(t.includes(e,i))return i;var n=t.reduce(e,function(t,e){var i=parseInt(t.substring(0,2),16),n=parseInt(t.substring(4,6),16),r=parseInt(e.substring(0,2),16),s=parseInt(e.substring(4,6),16);return i!==r?t:n>=s?t:e},i);return n===i?null:n},n.prototype.getH264ProfileIdWithSameOrHigherProfileAndEqualToOrHigherLevel=function(e,i){var n=this.getH264ProfileIdWithSameProfileAndEqualToOrHigherLevel(e,i);if(n)return n;var r=t.reduce(e,function(t,e){var i=parseInt(t.substring(0,2),16),n=parseInt(t.substring(4,6),16),r=parseInt(e.substring(0,2),16),s=parseInt(e.substring(4,6),16);return i<r?e:r<i?t:n>s?t:e},i);return r===i?null:r},new n}.apply(e,n))||(t.exports=r)},function(t,e,i){var n,r;n=[i(0),i(1),i(4),i(5),i(2),i(11),i(6)],void 0===(r=function(t,e,i,n,r,s,o){"use strict";function a(e,n,r,o,a){this.z=a,this.xe=e,this.Oe=n,this.Me=r,this.$=o,this.X=null,this.Pe=null,this.qe=new s(a),this.wt=new i.NamedEvents,this.De=t.bind(u,this),this.Ae=t.bind(c,this)}function u(t){this.z.info("[%s] Loading Phenix Real-Time stream player stalled caused by [%s] event.",this.xe,t.type)}function c(){this.z.info("[%s] Phenix Real-Time stream ended.",this.xe)}return a.prototype.on=function(t,e){return this.wt.listen(t,e)},a.prototype.start=function(e){var i=!!t.find(this.Oe.getTracks(),function(t){return"audio"===t.kind});return this.$.canPlaybackAudio||(this.$.disableAudioIfNoOutputFound&&this.$.forcedAudioDisabled?this.z.warn("[%s] Missing audio playback device. Audio has been disabled on stream. Try setting up an audio device and re-subscribe in order to receive audio.",this.xe):!this.$.disableAudioIfNoOutputFound&&i&&this.z.warn("[%s] Missing audio playback device. May experience audio and/or video failure. Try setting up an audio device OR pass the [disableAudioIfNoOutputFound] option when subscribing to disable audio playback when no devices are attached.",this.xe)),this.Pe=r.attachMediaStream(e,this.Oe),this.Me.recordTimeToFirstFrame(e),this.Me.recordRebuffering(e),this.Me.recordVideoResolutionChanges(this,e),this.Me.recordVideoPlayingAndPausing(e),!1===this.$.receiveAudio&&(e.muted=!0),t.addEventListener(e,"stalled",this.De,!1),t.addEventListener(e,"pause",this.De,!1),t.addEventListener(e,"suspend",this.De,!1),t.addEventListener(e,"ended",this.Ae,!1),this.qe.start(this,e),e},a.prototype.stop=function(e){this.qe.stop(),this.Me.stop(),this.Pe&&(t.removeEventListener(this.Pe,"stalled",this.De,!1),t.removeEventListener(this.Pe,"pause",this.De,!1),t.removeEventListener(this.Pe,"suspend",this.De,!1),t.removeEventListener(this.Pe,"ended",this.Ae,!1),"function"==typeof this.Pe.pause&&this.Pe.pause(),"Edge"===r.browser&&(this.Pe.src=""),this.Pe.src&&"IE"===r.browser?this.Pe.src=null:this.Pe.src&&(this.Pe.src=""),this.Pe.srcObject&&(this.Pe.srcObject=null),this.Pe=null),this.z.info("[%s] Phenix real-time renderer has been destroyed",this.xe),this.wt.fire(o.rendererEvents.ended.name,[e])},a.prototype.getStats=function(){if(!this.Pe)return{width:0,height:0,currentTime:0,lag:0,networkState:o.networkStates.networkNoSource.id};var e=(t.now()-this.$.originStartTime)/1e3,i=this.$.networkLag/1e3;return{width:this.Pe.videoWidth||this.Pe.width,height:this.Pe.videoHeight||this.Pe.height,currentTime:e,lag:i,networkState:this.Pe.networkState}},a.prototype.setDataQualityChangedCallback=function(t){e.S(t,"callback"),this.dataQualityChangedCallback=t},a.prototype.addVideoDisplayDimensionsChangedCallback=function(t,e){this.qe.addVideoDisplayDimensionsChangedCallback(t,e)},a}.apply(e,n))||(t.exports=r)},function(t,e,i){var n,r;n=[i(0),i(1),i(4),i(2),i(15),i(16),i(30),i(6)],void 0===(r=function(t,e,i,n,r,s,o,a){"use strict";var u=5e3;function c(e,n,r,s,o,a){this.xe=e,this.Oe=n,this.it=r,this.Me=s,this.$=o,this.z=a,this.X=null,this.qe=null,this.wt=new i.NamedEvents,this.Ne=[],t.addEventListener(r,"iceconnectionstatechange",t.bind(d,this))}function h(i){return t.reduce(i.getTracks(),function(t,i){return t&&function(t){return e.V(t,"track"),"ended"===t.readyState}(i)},!0)}function d(){var e=this;switch(this.it.iceConnectionState){case"checking":case"connecting":if(t.lt(this.Fe))return;this.je=t.now(),this.Fe=setTimeout(function(){e.z.warn("[%s] Stream has not connected withing [%s] ms.",e.xe,u),e.wt.fire(a.streamEvents.playerError.name,["real-time",new Error("connection-timeout")])},u);break;case"connected":t.lt(this.Fe)&&(clearTimeout(this.Fe),this.Fe=null),this.z.info("[%s] Ice Connection completed after [%s] ms",this.xe,t.now()-this.je),this.je=null}}return c.prototype.on=function(t,e){this.wt.listen(t,e)},c.prototype.createRenderer=function(){var t=this;return this.X=new o(this.xe,this.Oe,this.Me,this.$,this.z),this.X.on(a.rendererEvents.error.name,function(e,i){t.wt.fire(a.streamEvents.playerError.name,[e,i])}),this.X.on(a.rendererEvents.ended.name,function(e){t.wt.fire(a.streamEvents.playerEnded.name,[e])}),this.X},c.prototype.select=function(t){e.S(t,"trackSelectCallback"),e.S(n.global.MediaStream,"rtc.global.MediaStream");for(var i=this.Oe.getTracks(),r=new n.global.MediaStream,s=0;s<i.length;s++)t(i[s],s)&&r.addTrack(i[s]);if(0===r.getTracks().length)return this.z.warn("No tracks selected");var o=this,u=new c(this.xe,r,this.it,this.Me,this.$,this.z);return u.on(a.streamEvents.stopped.name,function(t){h(o.Oe)&&o.wt.fire(a.streamEvents.stopped.name,[t])}),this.Ne.push(u),u},c.prototype.setStreamEndedCallback=function(t){e.S(t,"callback"),this.Ue=t},c.prototype.setStreamErrorCallback=function(t){e.S(t,"callback"),this.Le=t},c.prototype.streamEndedCallback=function(e,i,n){t.forEach(this.Ne,function(t){t.streamEndedCallback(i,n)}),t.S(this.Ue)&&this.Ue(this,i,n)},c.prototype.streamErrorCallback=function(e,i,n){t.forEach(this.Ne,function(t){t.streamErrorCallback(i,n)}),t.S(this.Le)&&this.Le(e,i,n)},c.prototype.stop=function(e){var i;this.isActive()&&((i=this.Oe)&&t.S(i.stop,"stream.stop")&&i.stop(),t.forEach(i&&i.getTracks?i.getTracks():[],function(t){t.stop()}),this.z.info("[%s] stop media stream",this.xe),this.wt.fire(a.streamEvents.stopped.name,[e]),this.Be=!0)},c.prototype.monitor=function(t,i){e.V(t,"options"),e.S(i,"callback");var n=this,r=new s(n.xe,n.it,n.z);return t.direction="inbound",r.start(t,function(){return n.isActive()},function(t,e){return t&&n.z.warn("[%s] Media stream monitor triggered unrecoverable error [%s]",t),n.z.warn("[%s] Media stream triggered monitor condition for [%s]",n.xe,e.type),i(n,"client-side-failure",e)}),this.We=r,r},c.prototype.getMonitor=function(){return this.We},c.prototype.getStream=function(){return this.Oe},c.prototype.isActive=function(){return!this.Be&&!h(this.Oe)},c.prototype.getStreamId=function(){return this.xe},c.prototype.getStats=function(t){e.S(t,"callback"),this.ue||(this.ue={});var i=this;return n.getStats(this.it,null,function(e){t(r.convertPeerConnectionStats(e,i.ue))})},c.prototype.getRenderer=function(){return this.X},c}.apply(e,n))||(t.exports=r)},function(t,e,i){var n,r;n=[i(0),i(1),i(9),i(4),i(5),i(10),i(2),i(6)],void 0===(r=function(t,e,i,n,r,s,o,a){"use strict";var u=6e3,c=15e3,h=function(){var e=[10,0,0],i=[0,0,0];if(t.get(o.global.navigator,["plugins","Shockwave Flash"])){var n=o.global.navigator.plugins["Shockwave Flash"].description;if(n&&t.get(o.global.navigator,["mimeTypes","application/x-shockwave-flash","enabledPlugin"],!1))for(var r=0,s=(i=n.replace("Shockwave Flash","").replace(/^\s+/,"").replace(/\sr/gi,".").split(".")).length;r<s;r++)i[r]=parseInt(i[r].match(/\d+/),10)}else if(o.global.ActiveXObject)try{var a=new o.global.ActiveXObject("ShockwaveFlash.ShockwaveFlash");if(a){var u=a.GetVariable("$version")||"",c=t.get(u.split(" "),[1],i).split(",");i=[parseInt(c[0],10),parseInt(c[1],10),parseInt(c[2],10)]}}catch(t){console.error(t)}return i[0]>e[0]||i[0]===e[0]&&i[1]>0||i[0]===e[0]&&0===i[1]&&i[2]>=0}(),d="https://phenixrts.com/public/rtmp/rtmp-flash-renderer.swf";function f(e,i,r,s,a){this.z=a,this.xe=e,this.Ve=t.map(i,function(t){return t.uri=encodeURI(t.uri).replace(/[#]/g,"%23"),t}),this.Me=r,this.$=s,this.X=null,this.ze=null,this.wt=new n.NamedEvents,this.De=t.bind(v,this),this.Ae=t.bind(g,this),this.ge=t.bind(p,this),this.Ge=s.MediaElement||o.global.MediaElement,this._e=s.swfSrc||d,this.Je=this._e.substring(0,this._e.lastIndexOf("/")+1),this.He=this._e.substring(this._e.lastIndexOf("/")+1)}function l(){this.Ke.pause(),this.Ke.setSrc({src:"",type:"video/mp4"}),this.Ke.load&&this.Ke.load(),this.Qe&&this.Qe.parentNode&&this.Qe.parentNode.replaceChild(this.ze.getElement(),this.Qe),this.ze&&(this.ze.destroy(),this.ze.src=""),this.Qe&&(t.removeEventListener(this.Qe,"stalled",this.De,!1),t.removeEventListener(this.Qe,"pause",this.De,!1),t.removeEventListener(this.Qe,"suspend",this.De,!1),t.removeEventListener(this.Qe,"ended",this.Ae,!1)),this.Ke=null,this.ze=null,this.Qe=null}function p(t){this.wt.fire(a.rendererEvents.error.name,["flash-player",t])}function m(){var e=!this.Xe||t.now()-this.Xe>c;return this.Qe&&!this.Ze&&this.Ke&&0!==this.Qe.buffered.length&&e}function v(e){var i=this;i.z.info("[%s] Loading flash player stalled caused by [%s] event.",i.xe,e.type);var n=i.Qe.currentTime;setTimeout(function(){i.Qe&&i.Qe.currentTime===n&&!i.Qe.paused&&m.call(i)&&(i.z.warn("Reloading stream after being stalled for [%s] seconds",u/1e3),function(){m.call(this)&&(this.z.warn("Reloading unhealthy stream that was active for at least [%s] seconds",c/1e3),this.Xe=t.now(),function(){this.Ke.dispose(),this.Ke=null;var t=this.ze.getElement();l.call(this),this.start(t)}.call(this))}.call(i))},u)}function g(){this.z.info("[%s] Flash player ended.",this.xe)}return f.isSupported=function(){return h},f.prototype.on=function(t,e){return this.wt.listen(t,e)},f.prototype.start=function(e){if(!this.Ge)throw new Error("MediaElement must exist. Please include mediaelement.js library");var i=this,n=t.map(this.Ve,function(t){return{src:t.uri,type:"video/rtmp"}}),r=t.get(this.Ve,[0,"uri"],""),s=r.substring(0,r.lastIndexOf("/"));return this.ze=new o.PhenixVideo(e),this.ze.hookUpEvents(),this.Ke=new this.Ge(this.ze.getElement(),{flashStreamer:s,plugins:["flash","silverlight"],alwaysShowControls:!1,success:function(t){i.Qe=t},pluginPath:this.Je,filename:this.He,renderers:["flash_video"],error:i.ge}),this.Me.recordTimeToFirstFrame(this.Qe),this.Me.recordRebuffering(this.Qe),this.Me.recordVideoResolutionChanges(this,this.Qe),this.Me.recordVideoPlayingAndPausing(this.Qe),this.Ke.setSrc(n),this.Qe&&this.Qe.play(),t.addEventListener(this.Qe,"stalled",i.De,!1),t.addEventListener(this.Qe,"pause",i.De,!1),t.addEventListener(this.Qe,"suspend",i.De,!1),t.addEventListener(this.Qe,"ended",i.Ae,!1),e},f.prototype.stop=function(t){var e=this;if(this.Me.stop(),this.Ke){var i=function(){l.call(e),e.wt.fire(a.rendererEvents.ended.name,[t])};try{i(),this.z.info("[%s] Flash player has been destroyed",this.xe)}catch(t){e.z.error("[%s] Error while destroying Flash player [%s]",e.xe,t.code,t),i(),e.wt.fire(a.rendererEvents.error.name,["flash-player",t])}}},f.prototype.getStats=function(){if(!this.Qe)return{width:0,height:0,currentTime:0,lag:0,networkState:a.networkStates.networkNoSource.id};var e={},i=this.Qe.currentTime,n=(t.now()-this.$.originStartTime)/1e3;return e.lag=Math.max(0,n-i),e.estimatedBandwidth>0?e.networkState=a.networkStates.networkLoading.id:e.playTime>0?e.networkState=a.networkStates.networkIdle.id:e.video?e.networkState=a.networkStates.networkEmpty.id:e.networkState=a.networkStates.networkNoSource.id,e},f.prototype.setDataQualityChangedCallback=function(t){e.S(t,"callback"),this.dataQualityChangedCallback=t},f.prototype.getPlayer=function(){return this.Ke},f.prototype.addVideoDisplayDimensionsChangedCallback=function(){this.z.warn("Unable to detect dimensions changes")},f}.apply(e,n))||(t.exports=r)},function(t,e,i){var n,r;n=[i(0),i(1),i(9),i(4),i(5),i(10),i(2),i(11),i(6)],void 0===(r=function(t,e,i,n,r,s,o,a,u){"use strict";var c=6e3,h=15e3;function d(e,i,r,s,o){this.z=o,this.xe=e,this.$e=encodeURI(i).replace(/[#]/g,"%23"),this.Me=r,this.$=s,this.X=null,this.Pe=null,this.qe=new a(o),this.Ye={time:0,buffered:null,averageLength:0,count:0,lastCurrentTime:0,lastCurrentTimeOccurenceTimestamp:0},this.wt=new n.NamedEvents,this.De=t.bind(v,this),this.ti=t.bind(m,this),this.Ae=t.bind(y,this)}function f(t){if(p.call(this)&&t&&(3===t.code||t.severity===s.errors.severity.RECOVERABLE))return this.z.warn("Reloading unhealthy stream after error event [%s]",t),l.call(this);this.wt.fire(u.rendererEvents.error.name,["phenix-player",t])}function l(){p.call(this)&&(this.z.warn("Reloading unhealthy stream that was active for at least [%s] seconds",h/1e3),this.Xe=t.now(),function(){this.Ke.dispose(),this.Ke=null,this.start(this.Pe)}.call(this))}function p(){var e=!this.Xe||t.now()-this.Xe>h;return this.Pe&&!this.Ze&&this.Ke&&0!==this.Pe.buffered.length&&e}function m(){if(this.Ye.time=t.now(),0===this.Pe.buffered.length)return this.z.debug("[%s] Phenix live stream player progress event fired without any buffered content",this.xe);var e=this.Pe.buffered.end(this.Pe.buffered.length-1);if(this.Ye.buffered!==e){if(null!==this.Ye.buffered){var i=this.Ye.averageLength*this.Ye.count+(e-this.Ye.buffered),n=this.Ye.lastCurrentTime===this.Pe.currentTime;this.Ye.count+=1,this.Ye.averageLength=i/this.Ye.count,n||(this.Ye.lastCurrentTimeOccurenceTimestamp=t.now());var r=this.Ye.lastCurrentTimeOccurenceTimestamp&&t.now()-this.Ye.lastCurrentTimeOccurenceTimestamp>c;n&&r&&this.Pe&&!this.Pe.paused&&p.call(this)&&(this.z.warn("Reloading stream after current time has not changed for [%s] seconds due to unregistered stall.",c/1e3),l.call(this))}this.Ye.buffered=e,this.Ye.lastCurrentTime=this.Pe.currentTime}}function v(e){var i=this;if(i.z.info("[%s] Loading Phenix Live stream player stalled caused by [%s] event.",i.xe,e.type),0!==i.Ye.time&&!i.Pe.paused){var n=i.Pe.currentTime;setTimeout(function(){t.now()-i.Ye.time>g.call(i)&&i.Ze&&i.stop("ended")},g.call(i)),setTimeout(function(){i.Pe&&i.Pe.currentTime===n&&!i.Pe.paused&&p.call(i)&&(i.z.warn("Reloading stream after being stalled for [%s] seconds",c/1e3),l.call(i))},c)}}function g(){return 1.5*this.Ye.averageLength<2e3?2e3:1.5*this.Ye.averageLength}function y(){this.z.info("[%s] Phenix live stream player ended.",this.xe)}return d.isSupported=function(){return s.isSupported},d.prototype.on=function(t,e){return this.wt.listen(t,e)},d.prototype.start=function(e){var n,r,o,a=(r=(n=this.z).getAppenders(),o=new i.Logger,t.forEach(r,function(t){t instanceof i.ConsoleAppender&&(t=new i.ConsoleAppender).setThreshold(i.level.INFO),o.addAppender(t)}),o.setUserId(n.getUserId()),o.setEnvironment(n.getEnvironment()),o.setApplicationVersion(n.getApplicationVersion()),o.setObservableSessionId(n.getObservableSessionId()),o);return this.ei=a,this.Pe=e,this.Me.recordTimeToFirstFrame(e),this.Me.recordRebuffering(e),this.Me.recordVideoResolutionChanges(this,e),this.Me.recordVideoPlayingAndPausing(e),function(){var e=t.assign({bandwidthToStartAt:3e6},this.$);t.lt(this.$.targetMinBufferSize)&&(e.targetMinBufferSize=this.$.targetMinBufferSize,e.targetBufferSizeInMS=1e3*this.$.targetMinBufferSize),t.includes(this.$e,".mpd")&&this.$.isDrmProtectedContent&&(e.drm={"com.widevine.alpha":{serverCertificateUrl:this.$.widevineServiceCertificateUrl,mediaKeySystemConfiguration:{persistentState:"required"}},"com.microsoft.playready":{licenseServerUrl:this.$.playreadyLicenseUrl}});var i=new s.WebPlayer(this.ei,this.Pe,e);t.now()-this.$.originStartTime<6e3&&this.$.isDrmProtectedContent&&t.includes(this.$e,".m3u8")?setTimeout(t.bind(i.start,i,this.$e),6e3):i.start(this.$e),this.Ke=i,t.addEventListener(this.Ke,"error",t.bind(f,this))}.call(this),!1===this.$.receiveAudio&&(e.muted=!0),t.addEventListener(e,"stalled",this.De,!1),t.addEventListener(e,"pause",this.De,!1),t.addEventListener(e,"suspend",this.De,!1),t.addEventListener(e,"progress",this.ti,!1),t.addEventListener(e,"ended",this.Ae,!1),this.qe.start(this,e),e},d.prototype.stop=function(e,i){var n=this;if(!n.ii){if(i)return n.Ze=!0;if(this.qe.stop(),this.Me.stop(),this.Ke){var r=function(){n.Pe&&(t.removeEventListener(n.Pe,"stalled",n.De,!1),t.removeEventListener(n.Pe,"pause",n.De,!1),t.removeEventListener(n.Pe,"suspend",n.De,!1),t.removeEventListener(n.Pe,"progress",n.ti,!1),t.removeEventListener(n.Pe,"ended",n.Ae,!1),"Edge"===o.browser&&(n.Pe.src="")),n.wt.fire(u.rendererEvents.ended.name,[""]),n.Ke=null,n.Pe=null};n.ii=!0;try{n.Ke.dispose(),n.z.info("[%s] Phenix live stream has been destroyed",n.xe),r()}catch(t){n.z.error("[%s] Error while destroying Phenix live stream player [%s]",n.xe,t.code,t),r(),n.wt.fire(u.rendererEvents.error.name,["phenix-player",t])}}}},d.prototype.getStats=function(){if(!this.Ke)return{width:0,height:0,currentTime:0,lag:0,networkState:u.networkStates.networkNoSource.id};var e=this.Ke.getStats(),i=e.currentTime||this.Pe.currentTime,n=(t.now()-this.$.originStartTime)/1e3;return e.isNative&&"Hls"===e.deliveryType&&(e.currentTime=n-e.lag),e.isNative||(e.lag=Math.max(0,n-i)),e.estimatedBandwidth>0?e.networkState=u.networkStates.networkLoading.id:e.playTime>0?e.networkState=u.networkStates.networkIdle.id:e.video?e.networkState=u.networkStates.networkEmpty.id:e.networkState=u.networkStates.networkNoSource.id,e},d.prototype.setDataQualityChangedCallback=function(t){e.S(t,"callback"),this.dataQualityChangedCallback=t},d.prototype.getPlayer=function(){return this.Ke},d.prototype.addVideoDisplayDimensionsChangedCallback=function(t,e){this.qe.addVideoDisplayDimensionsChangedCallback(t,e)},d}.apply(e,n))||(t.exports=r)},function(t,e,i){var n,r;n=[i(0),i(1),i(4),i(5),i(2),i(11),i(6)],void 0===(r=function(t,e,i,n,r,s,o){"use strict";var a=null;function u(e,n,r,o,a,u){this.z=u,this.xe=e,this.$e=encodeURI(n).replace(/[#]/g,"%23"),this.Me=r,this.$=o,this.X=null,this.Pe=null,this.qe=new s(u),this.Ye={time:0,buffered:null,averageLength:0,count:0},this.wt=new i.NamedEvents,this.jt=a,this.De=t.bind(h,this),this.ti=t.bind(c,this),this.Ae=t.bind(f,this)}function c(){if(this.Ye.time=t.now(),0===this.Pe.buffered.length)return this.z.debug("[%s] Shaka live stream player progress event fired without any buffered content",this.xe);var e=this.Pe.buffered.end(this.Pe.buffered.length-1);if(this.Ye.buffered!==e){if(null!==this.Ye.buffered){var i=this.Ye.averageLength*this.Ye.count+(e-this.Ye.buffered);this.Ye.count+=1,this.Ye.averageLength=i/this.Ye.count}this.Ye.buffered=e}}function h(){var e=this;e.z.info("[%s] Loading Shaka live stream player stream stalled.",e.xe),0!==e.Ye.time&&setTimeout(function(){t.now()-e.Ye.time>d.call(e)&&e.Ze&&e.stop("ended")},d.call(e))}function d(){return 1.5*this.Ye.averageLength<2e3?2e3:1.5*this.Ye.averageLength}function f(){this.z.info("[%s] Shaka live stream player ended.",this.xe)}return u.prototype.on=function(t,e){return this.wt.listen(t,e)},u.prototype.start=function(e){var i=this;i.Ke=new this.jt.Player(e),i.Me.recordTimeToFirstFrame(e),i.Me.recordRebuffering(e),i.Me.recordVideoResolutionChanges(this,e);var s={abr:{defaultBandwidthEstimate:2e6},manifest:{retryParameters:{timeout:1e4}},streaming:{rebufferingGoal:2,bufferingGoal:10,bufferBehind:30,retryParameters:{timeout:1e4,maxAttempts:10,backoffFactor:1.1}}};function u(n){i.Ke.configure(n),!1===i.$.receiveAudio&&(e.muted=!0),t.addEventListener(i.Ke,"error",function(t){i.wt.fire(o.rendererEvents.error.name,["player",t])}),t.addEventListener(e,"stalled",i.De,!1),t.addEventListener(e,"pause",i.De,!1),t.addEventListener(e,"suspend",i.De,!1),t.addEventListener(e,"progress",i.ti,!1),t.addEventListener(e,"ended",i.Ae,!1),i.Ke.load(i.$e).then(function(){i.z.info("[%s] DASH live stream has been loaded",i.xe),t.S(e.play)&&e.play()}).catch(function(t){i.z.error("[%s] Error while loading DASH live stream [%s]",i.xe,t.code,t),i.wt.fire(o.rendererEvents.error.name,["shaka",t])}),i.qe.start(this,e),i.Pe=e}return this.$.isDrmProtectedContent?(function(){var e;if(!t.S(Uint8Array))throw e="Uint8Array support required for DRM",this.z.error(e),new Error(e);if(!t.S(r.global.atob))throw e="rtc.global.atob support required for DRM",this.z.error(e),new Error(e)}.call(i),function(t){var e=this;t.getNetworkingEngine().registerResponseFilter(function(i,n){if(i.toString()===e.jt.net.NetworkingEngine.RequestType.LICENSE.toString()){var s=new Uint8Array(n.data),o=String.fromCharCode.apply(null,s),a=JSON.parse(o),u=a.license,c=r.global.atob(u);n.data=new Uint8Array(c.length);for(var h=0;h<c.length;++h)n.data[h]=c.charCodeAt(h);a.trackRestrictions&&t.configure({restrictions:a.trackRestrictions})}})}.call(i,i.Ke),function(t,e,i){t.drm||(t.drm={}),t.drm.advanced||(t.drm.advanced={}),t.manifest||(t.manifest={}),t.manifest.dash||(t.manifest.dash={}),function(t,e,i){function r(e,n){e?i(e):(a=n.data,t.drm.advanced["com.widevine.alpha"]={serverCertificate:function(t){for(var e=t.length,i=new Uint8Array(e),n=0;n<e;n++)i[n]=t.charCodeAt(n);return i}(n.data),persistentStateRequired:!0,distinctiveIdentifierRequired:!1},i(null,t))}t.manifest.dash.customScheme=function(t){if("com.phenixrts.widevine"===t.getAttribute("schemeIdUri")||"com.phenixp2p.widevine"===t.getAttribute("schemeIdUri"))return[{keySystem:"com.widevine.alpha",licenseServerUri:decodeURIComponent(t.getAttribute("widevineLicenseServerUrl"))}]},a?r(null,a):n.get(e.widevineServiceCertificateUrl,{mimeType:"text/plain; charset=x-user-defined"},r)}.call(this,t,e,i)}.call(i,s,i.$,function(t,e){if(t)throw i.z.error("Failed to add DRM configuration to shaka player",t),t;u(e)})):u(s),e},u.prototype.stop=function(e,i){var n=this;if(!n.ii){if(i)return n.Ze=!0;if(this.qe.stop(),this.Me.stop(),this.Ke){var s=function(){n.Pe&&(t.removeEventListener(n.Pe,"stalled",n.De,!1),t.removeEventListener(n.Pe,"pause",n.De,!1),t.removeEventListener(n.Pe,"suspend",n.De,!1),t.removeEventListener(n.Pe,"progress",n.ti,!1),t.removeEventListener(n.Pe,"ended",n.Ae,!1),"Edge"===r.browser&&(n.Pe.src="")),n.wt.fire(o.rendererEvents.ended.name,[""]),n.Ke=null,n.Pe=null};n.Ke.destroy().then(function(){n.z.info("[%s] Shaka live stream player has been destroyed",n.xe)}).then(function(){s()}).catch(function(t){n.z.error("[%s] Error while destroying shaka live stream player [%s]",n.xe,t.code,t),s(),n.wt.fire(o.rendererEvents.error.name,["shaka",t])}),n.ii=!0}}},u.prototype.getStats=function(){if(!this.Ke)return{width:0,height:0,currentTime:0,lag:0,networkState:o.networkStates.networkNoSource.id};var e=t.assign(this.Ke.getStats(),{currentTime:0,lag:0}),i=t.get(this.Pe,["currentTime"],0),n=(t.now()-this.$.originStartTime)/1e3,r=Math.max(0,n-i);return this.Pe&&(e.currentTime=i,e.lag=r),e.estimatedBandwidth>0?e.networkState=o.networkStates.networkLoading.id:e.playTime>0?e.networkState=o.networkStates.networkIdle.id:e.video?e.networkState=o.networkStates.networkEmpty.id:e.networkState=o.networkStates.networkNoSource.id,e},u.prototype.setDataQualityChangedCallback=function(t){e.S(t,"callback"),this.dataQualityChangedCallback=t},u.prototype.getPlayer=function(){return this.Ke},u.prototype.addVideoDisplayDimensionsChangedCallback=function(t,e){this.qe.addVideoDisplayDimensionsChangedCallback(t,e)},u}.apply(e,n))||(t.exports=r)},function(t,e,i){var n,r;n=[i(0),i(1),i(4),i(2),i(10),i(34),i(33),i(32),i(6)],void 0===(r=function(t,e,i,n,r,s,o,a,u){"use strict";function c(t,e,n,r,s,o,a){this.ni=t,this.xe=e,this.ri=n,this.Me=r,this.$=s,this.jt=o,this.z=a,this.X=null,this.qe=null,this.wt=new i.NamedEvents}return c.prototype.on=function(t,e){this.wt.listen(t,e)},c.prototype.createRenderer=function(){switch(this.ni){case u.types.dash.name:this.jt?this.X=new s(this.xe,this.ri,this.Me,this.$,this.jt,this.z):this.X=new o(this.xe,this.ri,this.Me,this.$,this.z);break;case u.types.hls.name:this.X=new o(this.xe,this.ri,this.Me,this.$,this.z);break;case u.types.rtmp.name:this.X=new a(this.xe,this.ri,this.Me,this.$,this.z);break;default:throw new Error("Unsupported Live stream Type "+this.ni)}var t=this;return this.X.on(u.rendererEvents.error.name,function(e,i){t.wt.fire(u.streamEvents.playerError.name,[e,i])}),this.X.on(u.rendererEvents.ended.name,function(e){t.wt.fire(u.streamEvents.playerEnded.name,[e])}),this.X},c.prototype.select=function(t){return this.z.warn("[%s] selection of tracks not supported for [%s] live streams",this.xe,this.ni),this},c.prototype.setStreamEndedCallback=function(t){e.S(t,"callback"),this.streamEndedCallback=t},c.prototype.setStreamErrorCallback=function(t){e.S(t,"callback"),this.streamErrorCallback=t},c.prototype.stop=function(t){this.isActive()&&(this.z.info("[%s] stop media stream",this.xe),this.wt.fire(u.streamEvents.stopped.name,[t]),this.Be=!0)},c.prototype.monitor=function(t,i){e.V(t,"options"),e.S(i,"callback")},c.prototype.getMonitor=function(){return null},c.prototype.getStream=function(){return this.z.debug("[%s] stream not available for [%s] live streams",this.xe,this.ni),null},c.prototype.isActive=function(){return!this.Be},c.prototype.getStreamId=function(){return this.xe},c.prototype.getStats=function(){return this.z.debug("[%s] stats not available for [%s] live streams",this.xe,this.ni),null},c.prototype.getRenderer=function(){return this.X},c.canPlaybackType=function(t){switch(t){case u.types.dash.name:return r.WebPlayer.deviceSupportsHlsPlayback;case u.types.hls.name:return r.WebPlayer.deviceSupportsDashPlayback;case u.types.rtmp.name:return a.isSupported();default:return!1}},c}.apply(e,n))||(t.exports=r)},function(t,e,i){var n,r;n=[i(0),i(1),i(6)],void 0===(r=function(t,e,i){"use strict";function n(t,n,r){e.Ot(t,"type"),e.V(n,"stream"),e.V(r,"logger"),this.ni=t,this.e=n,this.z=r,this.si=null;var s=this;this.e.on(i.streamEvents.playerEnded.name,function(t){if(s.z.info("[%s] [%s] player ended.",s.e.getStreamId(),s.ni),s.oi=!0,s.si)return s.si();s.streamEndedCallback(function(e){switch(t){case"":case"none":case"ended":return"ended";case"server-error":case"session-error":case"not-ready":case"error":case"died":return"failed";case"censored":return"censored";case"maintenance":return"maintenance";case"capacity":return"capacity";case"app-background":return"app-background";default:return"custom"}}(),t)})}return n.prototype.on=function(t,e){return this.e.on(t,e)},n.prototype.streamErrorCallback=function(e,i){t.S(this.e.streamErrorCallback)?(this.z.debug("[%s] [%s] live stream error event [%s]",this.e.getStreamId(),this.ni,i),this.e.streamErrorCallback(this.e,e,i)):this.z.error("[%s] [%s] live stream error event [%s]",this.e.getStreamId(),this.ni,i)},n.prototype.streamEndedCallback=function(e,i,n){var r=this.e.getRenderer();if(!this.ai){if(n&&!this.si&&this.e.isActive()&&r&&!this.oi)return this.si=t.bind(this.streamEndedCallback,this,e,i),this.z.info("[%s] [%s] stream ended. Waiting for end of player.",this.e.getStreamId(),this.ni),void(r&&r.stop(i,n));this.ai=!0,t.S(this.e.streamEndedCallback)&&this.e.streamEndedCallback(this.e,e,i),this.e.stop(),r&&r.stop(i,n)}},n.prototype.dataQualityChangedCallback=function(t,e){var i=this.e.getRenderer();i&&"function"==typeof i.dataQualityChangedCallback&&i.dataQualityChangedCallback(i,t,e)},n.prototype.getPhenixMediaStream=function(){return this.e},n}.apply(e,n))||(t.exports=r)},function(t,e,i){var n,r;n=[i(0),i(1),i(4),i(3),i(2)],void 0===(r=function(t,e,i,n,r){function s(t){if(e.V(t,"logger"),this.z=t,this.wt=new i.NamedEvents,this.h=new n.DisposableList,this.h.add(this.wt),!this.isSupported())return this.z.info("Network monitor is not supported.");this.ui=o.call(this),function(){var t=this;navigator.connection.addEventListener("change",function(){t.wt.fireAsync("NetworkChange",[o.call(t),t.ui]),t.ui=o.call(t)})}.call(this)}function o(){return{downlinkThroughputCapacity:this.getDownlinkThroughputCapacity(),effectiveType:this.getEffectiveType(),rtt:this.getRoundTripTime()}}return s.prototype.isSupported=function(){return r.global.navigator&&r.global.navigator.connection},s.prototype.getDownlinkThroughputCapacity=function(){return this.isSupported()?r.global.navigator.connection.downlink||r.global.navigator.connection.downlinkMax:-1},s.prototype.getEffectiveType=function(){return this.isSupported()?r.global.navigator.connection.effectiveType||r.global.navigator.connection.type:"Unknown"},s.prototype.getRoundTripTime=function(){return this.isSupported()?r.global.navigator.connection.rtt||r.global.navigator.connection.type:-1},s.prototype.onNetworkChange=function(t){if(this.isSupported())return e.S(t,"callback"),this.wt.listen("NetworkChange",t)},s.prototype.dispose=function(){this.h.dispose()},s}.apply(e,n))||(t.exports=r)},function(t,e,i){var n,r;n=[i(0),i(1),i(4),i(3)],void 0===(r=function(t,e,i,n){"use strict";var r=3e3;function s(){this.wt=new i.NamedEvents,this.ci=t.now(),this.h=new n.DisposableList,this.hi=!0,this.h.add(this.wt),function(){if(o())return function(){if(o()){var t=this;chrome.extension.onRequest.addListener(function(e,i,n){"is_selected"===e&&chrome.tabs.getSelected(null,function(e){var r=e.id===i.tab.id;a.call(t,r),n(!!r)})})}}.call(this);(function(){var e,i,s=this;function o(){var t=!document[e];a.call(s,t)}"object"==typeof document&&(void 0!==document.msHidden?(e="msHidden",i="msvisibilitychange"):void 0!==document.webkitHidden?(e="webkitHidden",i="webkitvisibilitychange"):void 0!==document.hidden&&(e="hidden",i="visibilitychange"),void 0!==document.addEventListener&&void 0!==document[e]?(t.addEventListener(document,i,o,!1),s.h.add(new n.Disposable(function(){t.removeEventListener(document,i,o,!1)}))):function(){var e=this;e.di=setInterval(function(){var t=document.hasFocus();a.call(e,t)},r),e.h.add(new n.Disposable(function(){t.lt(e.di)&&clearInterval(e.di),e.di=null}))}.call(s))}).call(this)}.call(this)}function o(){return"undefined"!=typeof chrome&&chrome.extension&&chrome.extension.onRequest}function a(t){if(e.pt(t,"isForeground"),this.hi!==t)return t?(this.hi=!0,u.call(this,"foreground")):(this.hi=!1,u.call(this,"background"))}function u(e){var i=t.now(),n=i-this.ci;this.ci=i,this.wt.fire(e,[n])}return s.prototype.isForeground=function(){return this.hi},s.prototype.getTimeSinceLastChange=function(){return t.now()-this.ci},s.prototype.onForeground=function(t){return e.S(t,"callback"),this.wt.listen("foreground",t)},s.prototype.onBackground=function(t){return e.S(t,"callback"),this.wt.listen("background",t)},s}.apply(e,n))||(t.exports=r)},function(t,e,i){var n,r;n=[i(38)],void 0===(r=function(t){"use strict";return new t}.apply(e,n))||(t.exports=r)},function(t,e,i){var n,r;n=[i(0),i(1),i(3),i(39),i(37),i(2)],void 0===(r=function(t,e,i,n,r,s){"use strict";var o=s.global.__phenixPageLoadTime||s.global.__pageLoadTime||t.now(),a="production",u="2018-06-11T21:40:43Z";function c(e,s){this.fi=a,this.U=u,this.li=null,this.pi={resource:"Session",kind:"Event"},this.z=e,this.Nt=s,this.mi=new r(this.z),this.vi=t.now(),this.h=new i.DisposableList,this.gi=[],this.h.add(n.onBackground(t.bind(h,this,!1))),this.h.add(n.onForeground(t.bind(h,this,!0))),this.mi.isSupported()&&(this.h.add(this.mi.onNetworkChange(t.bind(p,this))),this.h.add(this.mi),d.call(this),l.call(this),f.call(this))}function h(t,e){var i=t?"ApplicationForeground":"ApplicationBackground";this.recordMetric(i,{uint64:e}),m.call(this,"Application has gone into the [%s] after [%s] ms",t?"foreground":"background",e)}function d(){var t=this.mi.getEffectiveType();this.recordMetric("NetworkType",{string:t},null,{resource:s.browser}),m.call(this,"[%s] has started with Network effective type of [%s]",this.li?"Session":"Application",t)}function f(e,i){var n=e||this.mi.getRoundTripTime(),r=i||-1;if(this.recordMetric("RoundTripTime",{uint32:n},{uint32:r},{resource:s.browser}),t.isNullOrUndefined(i))return m.call(this,"Network RTT [%s]",n);m.call(this,"Network RTT changed to [%s] from [%s]",n,r)}function l(e,i){var n=e||this.mi.getDownlinkThroughputCapacity(),r=i||-1;if(this.recordMetric("DownlinkThroughputCapacity",{uint64:n},{uint64:r},{resource:s.browser}),t.isNullOrUndefined(i))return m.call(this,"Network downlink throughput capacity [%s]",n);m.call(this,"Network downlink throughput capacity changed to [%s] from [%s]",n,r)}function p(t,e){e.downlinkThroughputCapacity!==t.downlinkThroughputCapacity&&l.call(this,t.downlinkThroughputCapacity,e.downlinkThroughputCapacity),e.rtt!==t.rtt&&f.call(this,t.rtt,e.rtt),e.effectiveType!==t.effectiveType&&function(t,e){var i=t||this.mi.getEffectiveType(),n=e;this.recordMetric("NetworkType",{string:i},{string:n},{resource:s.browser}),m.call(this,"Network effective type has changed to [%s] from [%s]",i,n||"New")}.call(this,t.effectiveType,e.effectiveType)}function m(){var e=Array.prototype.slice.call(arguments);if(0===e.length)throw new Error("Invalid logging arguments.");var i="[%s] [SessionTelemetry] [%s] "+e[0],n=e.slice(1),r=[i,this.li,t.now()-this.vi].concat(n);this.z.debug.apply(this.z,r)}function v(){return(t.now()-o)/1e3}function g(i,n){if(e.Ot(i.metric,"record.metric"),!this.li)return this.gi.push({record:i,since:n});var r=t.assign({},this.pi,i);this.Nt.submitMetric(i.metric,n,this.li,null,this.fi,this.U,r)}return c.prototype.setSessionId=function(t){!t&&this.li&&g.call(this,{metric:"Stopped",elapsed:this.elapsed()},v()),this.li=t,t&&(g.call(this,{metric:"Initialized",elapsed:this.elapsed()},v()),function(){if(this.li)for(var t=this.gi.length;t>0;){var e=this.gi.splice(t-1,1);1===e.length&&g.call(this,e[0].record,e[0].since),t--}}.call(this),function(){var t=n.isForeground(),e=n.getTimeSinceLastChange(),i=t?"ApplicationForeground":"ApplicationBackground";this.recordMetric(i,{uint64:e}),m.call(this,"Session has started in the [%s] after [%s] ms",t?"foreground":"background",e)}.call(this),this.mi.isSupported()&&(d.call(this),l.call(this),f.call(this)))},c.prototype.setProperty=function(t,i){e.Ot(t,"name"),e.Ot(i,"value"),this.pi[t]=i},c.prototype.recordMetric=function(i,n,r,s){e.Ot(i,"metric");var o=t.assign({},{metric:i,elapsed:this.elapsed(),value:n,previousValue:r},s||{});g.call(this,o,v())},c.prototype.elapsed=function(){return t.now()-this.vi},c.prototype.dispose=function(){this.h.dispose(),this.recordMetric("Stopped"),m.call(this,"Session telemetry stopped")},c}.apply(e,n))||(t.exports=r)},function(t,e,i){var n,r;n=[i(0),i(1),i(3),i(2)],void 0===(r=function(t,e,i,n){"use strict";var r=n.global.__phenixPageLoadTime||n.global.__pageLoadTime||t.now(),s="production",o="2018-06-11T21:40:43Z";function a(n,r,a){e.Ot(n,"sessionId"),this.fi=s,this.U=o,this.li=n,this.pi={},this.z=r,this.Nt=a,this.vi=t.now(),this.h=new i.DisposableList,u.call(this,"Stream initializing")}function u(){var e=Array.prototype.slice.call(arguments);if(0===e.length)throw new Error("Invalid logging arguments.");var i="[%s] [StreamTelemetry] [%s] "+e[0],n=e.slice(1),r=[i,this.xe,t.now()-this.vi].concat(n);this.z.debug.apply(this.z,r)}function c(){return(t.now()-r)/1e3}function h(i,n){e.Ot(i.metric,"record.metric");var r=t.assign({},this.pi,i);this.Nt.submitMetric(i.metric,n,this.li,this.xe,this.fi,this.U,r)}return a.prototype.setProperty=function(t,i){e.Ot(t,"name"),e.Ot(i,"value"),this.pi[t]=i},a.prototype.recordMetric=function(i,n,r,s){e.Ot(i,"metric");var o=t.assign({},{metric:i,elapsed:this.elapsed(),value:n,previousValue:r},s||{});h.call(this,o,c())},a.prototype.setStreamId=function(i){if(e.Ot(i,"streamId"),this.xe)throw new Error("Stream ID can only be set once.");this.xe=i;var n=t.now();h.call(this,{metric:"Initialized",elapsed:this.elapsed()-n+this.vi},c()-(n-this.vi)/1e3)},a.prototype.setStartOffset=function(t){if(e.lt(t,"startOffset"),this.yi)throw new Error("Start offset can only be set once.");this.yi=t,this.recordMetric("Offset",{uint64:t})},a.prototype.getStartOffset=function(){return this.yi},a.prototype.elapsed=function(){return t.now()-this.vi},a.prototype.stop=function(){this.h.dispose(),this.recordMetric("Stopped"),u.call(this,"Stream stopped")},a.prototype.recordTimeToFirstFrame=function(e){var n,r=this,s=t.now(),o=function(){n||(n=t.now()-s,r.recordMetric("TimeToFirstFrame",{uint64:n}),u.call(r,"First frame [%s]",n),a.dispose())};t.addEventListener(e,"loadeddata",o),t.addEventListener(e,"loadedmetadata",o);var a=new i.Disposable(function(){t.removeEventListener(e,"loadeddata",o),t.removeEventListener(e,"loadedmetadata",o)});this.h.add(a)},a.prototype.recordVideoResolutionChanges=function(t,e){var i=this,n={width:e.videoWidth,height:e.videoHeight};t.addVideoDisplayDimensionsChangedCallback(function(t,e){n.width===e.width&&n.height===e.height||(i.recordMetric("ResolutionChanged",{string:e.width+"x"+e.height},{string:n.width+"x"+n.height}),n={width:e.width,height:e.height},u.call(i,"Resolution changed: width [%s] height [%s]",e.width,e.height))})},a.prototype.recordRebuffering=function(e){var r,s,o=this,a=function(){r||(o.recordMetric("Stalled"),r=t.now(),u.call(o,"[buffering] Stream has stalled"))},c=function(i){var a=e.buffered.length,c=!("playing"===i.type||a>0)||("progress"===i.type||"timeupdate"===i.type)&&e.buffered.end(a-1)===s;if(r&&(a||"Edge"===n.browser)&&!c){"progress"===i.type&&(s=e.buffered.end(a-1));var h=t.now()-r;o.recordMetric("Buffering",{uint64:h}),u.call(o,"[buffering] Stream has recovered from stall after [%s] milliseconds",h),r=null}};t.addEventListener(e,"stalled",a),t.addEventListener(e,"pause",a),t.addEventListener(e,"suspend",a),t.addEventListener(e,"play",c),t.addEventListener(e,"playing",c),t.addEventListener(e,"progress",c),t.addEventListener(e,"timeupdate",c),this.h.add(new i.Disposable(function(){t.removeEventListener(e,"stalled",a),t.removeEventListener(e,"pause",a),t.removeEventListener(e,"suspend",a),t.removeEventListener(e,"play",c),t.removeEventListener(e,"playing",c),t.removeEventListener(e,"progress",c),t.removeEventListener(e,"timeupdate",c)}))},a.prototype.recordVideoPlayingAndPausing=function(e){var n=this,r=function(){e.paused?n.recordMetric("Playing",{boolean:!1}):n.recordMetric("Playing",{boolean:!0})};t.addEventListener(e,"pause",r),t.addEventListener(e,"playing",r),this.h.add(new i.Disposable(function(){t.removeEventListener(e,"pause",r),t.removeEventListener(e,"playing",r)}))},a}.apply(e,n))||(t.exports=r)},function(t,e,i){var n,r;n=[i(0),i(1),i(12),i(2),i(17)],void 0===(r=function(t,e,i,n,r){function s(s){e.tt(s,"uri"),this.wi="/telemetry/metrics",this.bi="object"==typeof location?location.hostname:n.browser+"-"+n.browserVersion+"-unknown",this.Si=!0,this.ki=(n.browser||"Browser")+"/"+(n.browserVersion||"?"),this.Ei=new i.BatchHttpProto(s+this.wi,[r],"telemetry.SubmitMetricRecords",{maxAttempts:3,maxBufferedRecords:1e3,maxBatchSize:512}),this.Ei.on("capacity",t.bind(o,this))}function o(e){this.Ei.addRecordToBeginning({metric:"MetricDropped",value:{uint64:e},timestamp:t.isoString(),sessionId:this.Ii,streamId:this.Ti,source:this.ki,fullQualifiedName:this.bi,environment:this.Ri,version:this.Ci,runtime:this.xi})}return s.prototype.isEnabled=function(){return this.Si},s.prototype.setEnabled=function(t){e.pt(t,"enabled"),this.Si=t},s.prototype.submitMetric=function(i,n,r,s,o,a,u){this.Si&&(e.Ot(i,"metric"),e.V(u,"value"),this.xi=n,this.Ii=r,this.Ti=s,this.Ri=o,this.Ci=a,function(e,i){var n=t.assign({},i,{metric:e,timestamp:t.isoString(),sessionId:this.Ii,streamId:this.Ti,source:this.ki,fullQualifiedName:this.bi,environment:this.Ri,version:this.Ci,runtime:this.xi});this.Ei.addRecord(n)}.call(this,i,u))},s}.apply(e,n))||(t.exports=r)},function(t,e,i){var n,r;n=[i(0),i(1),i(21),i(42)],void 0===(r=function(t,e,i,n){var r={urls:{local:"",staging:"https://telemetry-stg.phenixrts.com",production:"https://telemetry.phenixrts.com"}};function s(){this.Oi={}}return s.prototype.createMetricsTransmitter=function(t){var e=i.parseEnvFromPcastBaseUri(t||""),s=r.urls[e];return this.Oi[e]||(this.Oi[e]=function(t){var e=new n(t);return t||e.setEnabled(!1),e}.call(this,s)),this.Oi[e]},new s}.apply(e,n))||(t.exports=r)},function(t,e,i){var n,r;n=[i(0),i(1),i(2)],void 0===(r=function(t,e,i){"use strict";var n=2e3;function r(t,i,n){e.V(t,"logger"),e.V(i,"screenShareExtensionManager"),n&&e.S(n,"onScreenShare"),this.z=t,this.Ft=i,this.Y=n}function s(r,s,a){var u=this,c=function(t){a(o(t),void 0,t)},h=function(r){(function(r){var s={},o={},a=this;setTimeout(function u(){(function(i){return t.reduce(i.getTracks(),function(t,i){return t&&function(t){return e.Mi(t,"track"),"ended"===t.readyState}(i)},!0)})(r)||(t.forEach(r.getTracks(),function(e){if(i.global.Event&&t.hasIndexOrKey(s,e.id)&&s[e.id]!==e.enabled){var n=new i.global.Event("trackenabledchange");n.data=e,e.dispatchEvent(n),a.z.info("[%s] Detected track [%s] enabled change to [%s]",r.id,e.id,e.enabled)}if(i.global.Event&&t.hasIndexOrKey(o,e.id)&&o[e.id]!==e.readyState){var u=new i.global.Event("readystatechange");u.data=e,e.dispatchEvent(u),a.z.info("[%s] Detected track [%s] Ready State change to [%s]",r.id,e.id,e.readyState)}s[e.id]=e.enabled,o[e.id]=e.readyState}),setTimeout(u,n))},n)}).call(u,r),s("ok",r)};return function(t,e){var i=this;if(t.screen)return i.Ft.isScreenSharingEnabled(function(n){return n?i.Ft.getScreenSharingConstraints(t,e):i.Ft.installExtension(function(n,r){return n||r&&"ok"!==r.status?e(n,r):i.Ft.getScreenSharingConstraints(t,e)})});var n={audio:t.audio||!1,video:t.video||!1};e(null,{status:"ok",constraints:n})}.call(this,r,function(e,n){if("ok"!==t.get(n,["status"]))return c(e);if("cancelled"!==n.status){var s=n.constraints;if(u.Y&&(r.screen||r.screenAudio)&&"Chrome"===i.browser&&!(s=u.Y(s)))throw new Error("onScreenShare must return an object of user media constraints");try{i.getUserMedia(s,h,c)}catch(t){c(t)}}else a("cancelled",null)})}r.prototype.getUserMedia=function(i,n){e.V(i,"options"),e.S(n,"callback"),function(e,i){var n=this,r=function(t,e){n.se&&n.se.push(e),i(n,t,e)},o=function(t,r,s){e.screenAudio&&n.z.warn("Screen capture with audio is only supported on Windows or Chrome OS."),i(n,t,r,s)},a=e.screen||e.screenAudio,u=e.video||e.audio;return a&&u?s.call(n,{screen:e.screen},function(i,a){return s.call(n,{audio:e.audio,video:e.video},function(e,i){!function(e,i){e&&t.S(e.addTrack)&&t.forEach(i,function(t){e.addTrack(t)})}(i,a.getTracks()),r(e,i)},function(e,i,n){!function(e){if(e&&t.S(e.stop)&&e.stop(),e&&t.S(e.getTracks))for(var i=e.getTracks(),n=0;n<i.length;n++){i[n].stop()}}(a),o(e,i,n)})},o):s.call(n,e,r,o)}.call(this,i,n)};var o=function(t){return"unavailable"===t.code?"conflict":"permission-denied"===t.message?"permission-denied":"PermissionDeniedError"===t.name?"permission-denied":"InternalError"===t.name&&"Starting video failed"===t.message?"conflict":"SourceUnavailableError"===t.name?"conflict":"SecurityError"===t.name&&"The operation is insecure."===t.message?"permission-denied":"failed"};return r}.apply(e,n))||(t.exports=r)},function(t,e,i){var n,r;n=[i(0),i(1),i(7),i(2)],void 0===(r=function(t,e,i,n){"use strict";var r="icngjadgidcmifnehjcielbmiapkhjpn",s=t.freeze({url:"https://addons.mozilla.org/firefox/downloads/file/474686/pcast_screen_sharing-1.0.3-an+fx.xpi",iconUrl:"https://phenixp2p.com/public/images/phenix-logo-unicolor-64x64.png",hash:"sha256:4972e9718ea7f7c896abc12d1a9e664d5f3efe498539b082ab7694f9d7af4f3b"}),o=100,a=450,u=52;function c(o,a){o=o||{},e.V(o,"options"),e.V(a,"logger"),this.z=a,this.Pi=o.screenSharingExtensionId||function(){switch(n.browser){case"Chrome":return r;case"Firefox":default:return""}}(),this.qi=o.screenSharingAddOn||s,this.Di=!1,this.Ai=new i.Observable(!1),"Chrome"===n.browser&&this.Pi&&function(){var t=l.call(this);if("object"==typeof document){for(var e=document.getElementsByTagName("link"),i=0;i<e.length;i++)if(e[i].href===t)return;this.z.debug("Adding Chrome Web Store link [%s]",t);var n=document.createElement("link");n.rel="chrome-webstore-item",n.href=t,document.getElementsByTagName("head")[0].appendChild(n)}}.call(this),d.call(this,t.bind(h,this))}function h(t){this.Ai.setValue(!0),this.Di=t}function d(t){var e=this;if("Chrome"===n.browser&&e.Pi){var i=v.call(this);if(!i)return t(!1);try{i.sendMessage(e.Pi,{type:"version"},function(i){i&&"ok"===i.status?(e.z.info("Screen sharing enabled using version [%s]",i.version),t(!0)):(e.z.info("Screen sharing NOT available"),t(!1))})}catch(i){i.message&&e.z.warn(i.message,i),t(!1)}}else"Firefox"===n.browser&&n.browserVersion>=u?t(!0):"Firefox"===n.browser&&"object"==typeof n.global.PCastScreenSharing?t(!0):t(!1)}function f(t){if(this.Ai.getValue())return t();var e=this.Ai.subscribe(function(){return e.dispose(),t()})}function l(){return"https://chrome.google.com/webstore/detail/"+this.Pi}function p(e,i){switch(n.browser){case"Chrome":return function(t){var e=this,i=v.call(this);if(!i)return t(new Error("not-available"));try{i.sendMessage(e.Pi,{type:"get-desktop-media",sources:["screen","window","tab","audio"]},function(i){return!i?d.call(e,function(i){return h.call(e,i),t(new Error("extension-failure"))}):"ok"!==i.status?t(new Error(i.status),i):void t(null,i)})}catch(i){i.message&&e.z.warn(i.message),t(i,{status:"failed"})}}.call(this,function(n,r){if(n||r&&"ok"!==r.status)return i(n,r);r.data||r.options||(r.options={canRequestAudioTrack:!0}),r.data&&t.hasIndexOrKey(r.data,"hasAudio")&&!r.options&&(r.options={canRequestAudioTrack:r.data.hasAudio}),i(null,{status:"ok",constraints:function(e,i,n){var r={};return t.V(e)&&t.V(e.screen)&&(r.video=e.screen),t.V(e)&&t.V(e.screenAudio)&&n.canRequestAudioTrack&&(r.audio=e.screenAudio),e.screen&&t.set(r,["video","mandatory"],{chromeMediaSource:"desktop",chromeMediaSourceId:i}),e.screenAudio&&n.canRequestAudioTrack&&t.set(r,["audio","mandatory"],{chromeMediaSource:"system",chromeMediaSourceId:i}),r}(e,r.streamId,r.options)})});case"Firefox":i(null,{status:"ok",constraints:function(t,e){var i={video:{}};return"object"==typeof t&&"object"==typeof t.screen&&(i.video=t.screen),i.video.mediaSource=i.video.mediaSource||"window",i}(e)});break;default:i(new Error("not-supported"),{status:"not-supported"})}}function m(t){var e=this;if(!e.Di){var i=function(i,n){return"cancelled"===n?t(null,{status:"cancelled"}):"ok"!==n?t(new Error("screen-sharing-installation-failed"),{status:n}):void d.call(e,function(i){if(e.Di=i,!e.Di)return t(new Error("screen-sharing-installation-failed"),{status:n});t(null,{status:"ok"})})};switch(n.browser){case"Chrome":(function(t){var e=this,i=l.call(this);try{chrome.webstore.install(i,function(){return t(null,"ok")},function(i){if(i){if(i.match(/cancelled/gi))return e.z.info("User cancelled screen sharing"),t(new Error(i),"cancelled");e.z.warn(i)}return t(new Error(i||"failed"),"failed")})}catch(i){i.message&&e.z.warn(i.message),t(i,"failed")}}).call(e,i);break;case"Firefox":(function(t){try{var e,i={"PCast Screen Sharing":{URL:this.qi.url,IconURL:this.qi.iconUrl,Hash:this.qi.hash,toString:function(){return this.URL}}},r=a,s=function(){e&&clearInterval(e),t(null,"ok")},u=function(){e&&clearInterval(e),t(new Error("failed"),"failed")};e=setInterval(function(){return"object"==typeof n.global.PCastScreenSharing?s():r--<0?u():void 0},o),InstallTrigger.install(i,function(t,e){0===e?s():u()})}catch(e){e.message&&this.z.warn(e.message),t("failed",e)}}).call(e,i);break;default:t(new Error("not-supported"),{status:"not-supported"})}}}function v(){switch(n.browser){case"Chrome":return"undefined"!=typeof chrome&&chrome.runtime&&chrome.runtime.sendMessage?chrome.runtime:(this.z.info("Screen sharing NOT available. Runtime not supported"),null);case"Firefox":default:return null}}return c.prototype.isScreenSharingEnabled=function(t){var e=this;return f.call(this,function(){return t(e.Di)})},c.prototype.installExtension=function(e){return f.call(this,t.bind(m,this,e))},c.prototype.getScreenSharingConstraints=function(e,i){return f.call(this,t.bind(p,this,e,i))},c.prototype.toString=function(){return"ScreenShareExtensionManager["+n.browser+"]"},c}.apply(e,n))||(t.exports=r)},function(t,e,i){var n,r;n=[i(0),i(1),i(5),i(3)],void 0===(r=function(t,e,i,n){"use strict";function r(t,i,r,s){e.V(t,"logger"),e.Ot(i,"version"),e.S(r,"onClosestEndpointFound"),s&&e.S(s,"onAnEndpointResolved"),this.z=t,this.U=i,this.Ni=r,s&&(this.Fi=s),this.ji=!1,this.Ui=Number.MAX_VALUE,this.Li="",this.h=new n.DisposableList}return r.prototype.isResolved=function(){return this.ji},r.prototype.dispose=function(){this.h.dispose()},r.prototype.measurementCallback=function(t,e,i){return e<this.Ui&&(this.z.info("Current closest end point is [%s] with latency of [%s] ms",i,e),this.Ui=e,this.Li=i),this.isResolved()},r.prototype.completeCallback=function(t){if(this.Li&&this.Ui<Number.MAX_VALUE&&!this.isResolved())return this.ji=!0,this.Ni(null,{uri:this.Li,roundTripTime:this.Ui})},r.prototype.resolveAll=function(t){for(var e=0;e<t.length;e++)this.resolve(t[e],4)},r.prototype.resolve=function(e,n){var r=this,s=1,o=0;!function e(a){var u=t.now();r.z.info("[%s] Checking end point [%s]",s,a);var c=i.getWithRetry(a,{timeout:15e3,queryParameters:{version:r.U,_:t.now()},retryOptions:{maxAttempts:1}},function(i,c){var h=t.now()-u,d=h>30;if(r.Fi&&(i?r.Fi(i):r.Fi(null,{time:h,endPoint:a})),s++,!i){if(r.measurementCallback(a,h,c.data))return;o++}return s<=n&&!r.isResolved()&&(d||i)?(i&&r.z.info("Retrying after failure to resolve end point [%s] with [%s]",a,i),e(a)):0===o?r.z.warn("Unable to resolve end point [%s] with [%s]",a,i):r.completeCallback(a)});r.h.add(c)}(e)},r}.apply(e,n))||(t.exports=r)},function(t,e,i){var n,r;n=[i(46)],void 0===(r=function(t){return t}.apply(e,n))||(t.exports=r)},function(t,e,i){var n,r;n=[i(0),i(5),i(3),i(47)],void 0===(r=function(t,e,i,n){"use strict";function r(t,e,n,r){if("string"!=typeof t)throw new Error('Must pass a valid "version"');if("string"!=typeof e)throw new Error('Must pass a valid "baseUri"');if("object"!=typeof n)throw new Error('Must pass a valid "logger"');this.U=t,this.Dt=e,this.z=n,this.h=new i.DisposableList,this.ne=r}return r.DefaultPCastUri="https://pcast.phenixrts.com",r.prototype.getBaseUri=function(){return this.Dt},r.prototype.resolveUri=function(i){return function(i,r){if(0===i.lastIndexOf("wss:",0))r(void 0,{uri:i+"/ws",roundTripTime:0});else if(0===i.lastIndexOf("https:",0)){var s=this;(function(i,n){var r=e.getWithRetry(i+"/pcast/endPoints",{timeout:15e3,queryParameters:{version:"2018-06-11T21:40:43Z",_:t.now()},retryOptions:{maxAttempts:4}},function(t,e){if(t)return n(new Error("Failed to resolve an end point",t));var i=e.data.split(",");i.length<1&&n(new Error("Failed to discover end points")),n(void 0,i)});this.h.add(r)}).call(s,i,function(t,e){if(t)return r(t);var i=new n(s.z,s.U,r,function(t,e){t?s.z.warn("An error occured in resolving an endpoint",t):s.ne.recordMetric("RoundTripTime",{uint64:e.time},null,{resource:e.endPoint,kind:"https"})});i.resolveAll(e),s.h.add(i)})}else r(new Error("Uri not supported"))}.call(this,this.Dt,i)},r.prototype.dispose=function(){this.h.dispose()},r.prototype.toString=function(){return"PCastEndPoint["+this.Dt+"]"},r}.apply(e,n))||(t.exports=r)},function(t,e,i){var n;void 0===(n=function(){"use strict";return{package:"shim",messages:[]}}.apply(e,[]))||(t.exports=n)},function(t,e,i){var n;void 0===(n=function(){"use strict";return{package:"pcast",options:{optimize_for:"LITE_RUNTIME"},messages:[{name:"Authenticate",fields:[{rule:"optional",type:"uint32",name:"apiVersion",id:9,options:{default:0}},{rule:"required",type:"string",name:"clientVersion",id:1},{rule:"optional",type:"string",name:"device",id:12},{rule:"required",type:"string",name:"deviceId",id:2},{rule:"optional",type:"string",name:"manufacturer",id:13},{rule:"required",type:"string",name:"platform",id:3},{rule:"required",type:"string",name:"platformVersion",id:4},{rule:"required",type:"string",name:"authenticationToken",id:5},{rule:"optional",type:"string",name:"connectionId",id:6},{rule:"optional",type:"string",name:"connectionRouteKey",id:10},{rule:"optional",type:"string",name:"remoteAddress",id:11},{rule:"optional",type:"string",name:"sessionId",id:7},{rule:"optional",type:"string",name:"applicationId",id:8}]},{name:"AuthenticateResponse",fields:[{rule:"required",type:"string",name:"status",id:1},{rule:"optional",type:"string",name:"sessionId",id:2},{rule:"optional",type:"string",name:"redirect",id:3},{rule:"repeated",type:"string",name:"roles",id:4}]},{name:"Bye",fields:[{rule:"required",type:"string",name:"sessionId",id:1},{rule:"required",type:"string",name:"reason",id:2}]},{name:"ByeResponse",fields:[{rule:"required",type:"string",name:"status",id:1}]},{name:"SessionDescription",fields:[{rule:"required",type:"Type",name:"type",id:1,options:{default:"Offer"}},{rule:"required",type:"string",name:"sdp",id:2}],enums:[{name:"Type",values:[{name:"Offer",id:0},{name:"Answer",id:1}]}]},{name:"CreateStream",fields:[{rule:"required",type:"string",name:"sessionId",id:1},{rule:"optional",type:"string",name:"originStreamId",id:2},{rule:"repeated",type:"string",name:"originStreamIds",id:10},{rule:"repeated",type:"string",name:"options",id:3},{rule:"optional",type:"string",name:"connectUri",id:8},{rule:"repeated",type:"string",name:"connectOptions",id:9},{rule:"repeated",type:"string",name:"tags",id:4},{rule:"optional",type:"string",name:"userAgent",id:11},{rule:"optional",type:"SetRemoteDescription",name:"setRemoteDescription",id:5},{rule:"optional",type:"CreateOfferDescription",name:"createOfferDescription",id:6},{rule:"optional",type:"CreateAnswerDescription",name:"createAnswerDescription",id:7}]},{name:"IceServer",fields:[{rule:"repeated",type:"string",name:"urls",id:1},{rule:"optional",type:"string",name:"username",id:2},{rule:"optional",type:"string",name:"credential",id:3}]},{name:"RtcConfiguration",fields:[{rule:"optional",type:"BundlePolicy",name:"bundlePolicy",id:1},{rule:"optional",type:"uint32",name:"iceCandidatePoolSize",id:3},{rule:"repeated",type:"IceServer",name:"iceServers",id:4},{rule:"optional",type:"IceTransportPolicy",name:"iceTransportPolicy",id:5},{rule:"optional",type:"string",name:"peerIdentity",id:6},{rule:"optional",type:"RtcpMuxPolicy",name:"rtcpMuxPolicy",id:7}],enums:[{name:"BundlePolicy",values:[{name:"BundlePolicyBalanced",id:1},{name:"BundlePolicyMaxCompat",id:2},{name:"BundlePolicyMaxBundle",id:3}]},{name:"IceTransportPolicy",values:[{name:"IceTransportPolicyAll",id:1},{name:"IceTransportPolicyPublic",id:2},{name:"IceTransportPolicyRelay",id:3}]},{name:"RtcpMuxPolicy",values:[{name:"RtcpMuxPolicyNegotiate",id:1},{name:"RtcpMuxPolicyRequire",id:2}]}]},{name:"CreateStreamResponse",fields:[{rule:"required",type:"string",name:"status",id:1},{rule:"optional",type:"string",name:"streamId",id:2},{rule:"optional",type:"string",name:"instanceRouteKey",id:5},{rule:"repeated",type:"string",name:"streamUris",id:8},{rule:"optional",type:"RtcConfiguration",name:"rtcConfiguration",id:9},{rule:"optional",type:"SetRemoteDescriptionResponse",name:"setRemoteDescriptionResponse",id:3},{rule:"optional",type:"CreateOfferDescriptionResponse",name:"createOfferDescriptionResponse",id:4},{rule:"optional",type:"CreateAnswerDescriptionResponse",name:"createAnswerDescriptionResponse",id:6},{rule:"repeated",type:"string",name:"options",id:7},{rule:"optional",type:"uint64",name:"offset",id:10,options:{default:0}}]},{name:"SetLocalDescription",fields:[{rule:"required",type:"string",name:"streamId",id:1},{rule:"required",type:"SessionDescription",name:"sessionDescription",id:2},{rule:"optional",type:"uint32",name:"apiVersion",id:3,options:{default:0}}]},{name:"SetLocalDescriptionResponse",fields:[{rule:"required",type:"string",name:"status",id:1},{rule:"repeated",type:"string",name:"options",id:2}]},{name:"SetRemoteDescription",fields:[{rule:"required",type:"string",name:"streamId",id:1},{rule:"required",type:"SessionDescription",name:"sessionDescription",id:2},{rule:"optional",type:"uint32",name:"apiVersion",id:3,options:{default:0}}]},{name:"SetRemoteDescriptionResponse",fields:[{rule:"required",type:"string",name:"status",id:1},{rule:"optional",type:"SessionDescription",name:"sessionDescription",id:2},{rule:"repeated",type:"string",name:"options",id:3}]},{name:"CreateOfferDescription",fields:[{rule:"required",type:"string",name:"streamId",id:1},{rule:"repeated",type:"string",name:"options",id:2},{rule:"optional",type:"uint32",name:"apiVersion",id:3,options:{default:0}}]},{name:"CreateOfferDescriptionResponse",fields:[{rule:"required",type:"string",name:"status",id:1},{rule:"optional",type:"SessionDescription",name:"sessionDescription",id:2},{rule:"repeated",type:"string",name:"options",id:3}]},{name:"CreateAnswerDescription",fields:[{rule:"required",type:"string",name:"streamId",id:1},{rule:"repeated",type:"string",name:"options",id:2},{rule:"optional",type:"uint32",name:"apiVersion",id:3,options:{default:0}}]},{name:"CreateAnswerDescriptionResponse",fields:[{rule:"required",type:"string",name:"status",id:1},{rule:"optional",type:"SessionDescription",name:"sessionDescription",id:2},{rule:"repeated",type:"string",name:"options",id:3}]},{name:"IceCandidate",fields:[{rule:"required",type:"string",name:"candidate",id:1},{rule:"required",type:"uint32",name:"sdpMLineIndex",id:2},{rule:"required",type:"string",name:"sdpMid",id:3}]},{name:"AddIceCandidates",fields:[{rule:"required",type:"string",name:"streamId",id:1},{rule:"repeated",type:"IceCandidate",name:"candidates",id:2},{rule:"repeated",type:"string",name:"options",id:3},{rule:"optional",type:"uint32",name:"apiVersion",id:4,options:{default:0}}]},{name:"AddIceCandidatesResponse",fields:[{rule:"required",type:"string",name:"status",id:1},{rule:"repeated",type:"string",name:"options",id:2}]},{name:"UpdateStreamState",fields:[{rule:"required",type:"string",name:"streamId",id:1},{rule:"required",type:"string",name:"signalingState",id:2},{rule:"required",type:"string",name:"iceGatheringState",id:3},{rule:"required",type:"string",name:"iceConnectionState",id:4},{rule:"optional",type:"uint32",name:"apiVersion",id:5,options:{default:0}}]},{name:"UpdateStreamStateResponse",fields:[{rule:"required",type:"string",name:"status",id:1},{rule:"repeated",type:"string",name:"options",id:2}]},{name:"DestroyStream",fields:[{rule:"required",type:"string",name:"streamId",id:1},{rule:"optional",type:"string",name:"reason",id:2},{rule:"repeated",type:"string",name:"options",id:3}]},{name:"DestroyStreamResponse",fields:[{rule:"required",type:"string",name:"status",id:1}]},{name:"ConnectionDisconnected",fields:[{rule:"required",type:"string",name:"connectionId",id:1},{rule:"required",type:"uint32",name:"reasonCode",id:2},{rule:"optional",type:"string",name:"description",id:3}]},{name:"ConnectionDisconnectedResponse",fields:[{rule:"required",type:"string",name:"status",id:1}]},{name:"StreamStarted",fields:[{rule:"required",type:"string",name:"sessionId",id:1},{rule:"required",type:"string",name:"streamId",id:2},{rule:"repeated",type:"string",name:"tags",id:3}]},{name:"SourceStreamStarted",fields:[{rule:"required",type:"string",name:"sessionId",id:1},{rule:"required",type:"string",name:"streamId",id:2},{rule:"repeated",type:"string",name:"capabilities",id:3},{rule:"repeated",type:"string",name:"tags",id:4}]},{name:"StreamEnded",fields:[{rule:"required",type:"string",name:"sessionId",id:1},{rule:"required",type:"string",name:"streamId",id:2},{rule:"required",type:"string",name:"reason",id:3},{rule:"repeated",type:"string",name:"tags",id:4},{rule:"optional",type:"string",name:"continuationId",id:5},{rule:"optional",type:"string",name:"routeKey",id:6}]},{name:"SourceStreamEnded",fields:[{rule:"required",type:"string",name:"sessionId",id:1},{rule:"required",type:"string",name:"streamId",id:2},{rule:"required",type:"string",name:"reason",id:3},{rule:"repeated",type:"string",name:"capabilities",id:4},{rule:"repeated",type:"string",name:"tags",id:5}]},{name:"StreamEndedResponse",fields:[{rule:"required",type:"string",name:"status",id:1},{rule:"optional",type:"string",name:"continuationId",id:2},{rule:"optional",type:"string",name:"routeKey",id:3}]},{name:"StreamIdle",fields:[{rule:"required",type:"string",name:"sessionId",id:1},{rule:"required",type:"string",name:"streamId",id:2},{rule:"repeated",type:"string",name:"options",id:3},{rule:"repeated",type:"string",name:"tags",id:4}]},{name:"StreamArchived",fields:[{rule:"required",type:"string",name:"sessionId",id:1},{rule:"required",type:"string",name:"streamId",id:2},{rule:"required",type:"uint64",name:"startTime",id:4},{rule:"required",type:"string",name:"uri",id:3}]},{name:"SessionEnded",fields:[{rule:"required",type:"string",name:"sessionId",id:1},{rule:"required",type:"string",name:"reason",id:2},{rule:"required",type:"float",name:"duration",id:3}]},{name:"ResourceIdle",fields:[{rule:"required",type:"string",name:"sessionId",id:1},{rule:"required",type:"string",name:"routeKey",id:2}]},{name:"ResourceIdleResponse",fields:[{rule:"required",type:"string",name:"status",id:1}]},{name:"StreamPlaylist",fields:[{rule:"required",type:"string",name:"sessionId",id:1},{rule:"required",type:"string",name:"streamId",id:2},{rule:"required",type:"PlaylistType",name:"playlistType",id:3},{rule:"required",type:"string",name:"uri",id:4},{rule:"required",type:"bool",name:"isVariant",id:5,options:{default:!0}}],enums:[{name:"PlaylistType",values:[{name:"Live",id:0},{name:"OnDemand",id:1}]}]},{name:"StreamRtmp",fields:[{rule:"required",type:"string",name:"streamId",id:1},{rule:"required",type:"string",name:"uri",id:2},{rule:"required",type:"uint32",name:"height",id:3},{rule:"required",type:"uint32",name:"bitrate",id:4}]},{name:"SendEventToClient",fields:[{rule:"required",type:"string",name:"connectionId",id:1},{rule:"required",type:"string",name:"type",id:2},{rule:"required",type:"bytes",name:"payload",id:3}]},{name:"SendEventToClientResponse",fields:[{rule:"required",type:"string",name:"status",id:1}]},{name:"SendRequestToClient",fields:[{rule:"required",type:"string",name:"connectionId",id:1},{rule:"required",type:"string",name:"type",id:2},{rule:"required",type:"bytes",name:"payload",id:3}]},{name:"SendRequestToClientResponse",fields:[{rule:"required",type:"string",name:"status",id:1},{rule:"optional",type:"string",name:"type",id:2},{rule:"optional",type:"bytes",name:"payload",id:3}]},{name:"SetupStream",fields:[{rule:"required",type:"string",name:"streamToken",id:1},{rule:"required",type:"CreateStream",name:"createStream",id:2}]},{name:"SetupStreamResponse",fields:[{rule:"required",type:"string",name:"status",id:1},{rule:"optional",type:"CreateStreamResponse",name:"createStreamResponse",id:2}]},{name:"SetupPlaylistStream",fields:[{rule:"required",type:"string",name:"sessionId",id:1},{rule:"required",type:"string",name:"streamToken",id:2},{rule:"repeated",type:"string",name:"options",id:3},{rule:"repeated",type:"string",name:"tags",id:4}]},{name:"PlaylistStreamManifest",fields:[{rule:"required",type:"string",name:"manifest",id:1},{rule:"required",type:"bool",name:"isProtectedContent",id:2},{rule:"optional",type:"string",name:"drmToken",id:3}]},{name:"SetupPlaylistStreamResponse",fields:[{rule:"required",type:"string",name:"status",id:1},{rule:"repeated",type:"PlaylistStreamManifest",name:"manifests",id:2},{rule:"optional",type:"uint64",name:"offset",id:3,options:{default:0}}]},{name:"StreamDataQuality",fields:[{rule:"required",type:"string",name:"sessionId",id:1},{rule:"required",type:"string",name:"streamId",id:2},{rule:"required",type:"uint64",name:"timestamp",id:3},{rule:"required",type:"DataQualityStatus",name:"status",id:4},{rule:"required",type:"DataQualityReason",name:"reason",id:5}],enums:[{name:"DataQualityStatus",values:[{name:"NoData",id:0},{name:"AudioOnly",id:1},{name:"All",id:2}]},{name:"DataQualityReason",values:[{name:"None",id:0},{name:"UploadLimited",id:1},{name:"DownloadLimited",id:2},{name:"PublisherLimited",id:3},{name:"NetworkLimited",id:4}]}]},{name:"StreamDataQualityResponse",fields:[{rule:"required",type:"string",name:"status",id:1}]},{name:"CallbackEvent",fields:[{rule:"optional",type:"uint32",name:"apiVersion",id:1,options:{default:0}},{rule:"required",type:"string",name:"entity",id:2},{rule:"required",type:"string",name:"what",id:3},{rule:"required",type:"string",name:"data",id:4},{rule:"optional",type:"string",name:"sessionId",id:5}]},{name:"Uri",fields:[{rule:"optional",type:"string",name:"protocol",id:1,options:{default:"http"}},{rule:"required",type:"string",name:"host",id:2},{rule:"optional",type:"uint32",name:"port",id:3,options:{default:80}},{rule:"optional",type:"string",name:"method",id:4,options:{default:"POST"}},{rule:"optional",type:"string",name:"path",id:5,options:{default:"/"}}]},{name:"SetApplicationCallback",fields:[{rule:"required",type:"string",name:"applicationId",id:1},{rule:"required",type:"string",name:"secret",id:2},{rule:"required",type:"Uri",name:"callback",id:3}]},{name:"SetApplicationCallbackResponse",fields:[{rule:"required",type:"string",name:"status",id:1},{rule:"optional",type:"string",name:"endpoint",id:2}]},{name:"IssueAuthenticationToken",fields:[{rule:"required",type:"string",name:"applicationId",id:1},{rule:"required",type:"string",name:"secret",id:2},{rule:"repeated",type:"string",name:"capabilities",id:3}]},{name:"IssueAuthenticationTokenResponse",fields:[{rule:"required",type:"string",name:"status",id:1},{rule:"optional",type:"string",name:"authenticationToken",id:2}]},{name:"IssueStreamToken",fields:[{rule:"required",type:"string",name:"applicationId",id:1},{rule:"required",type:"string",name:"secret",id:2},{rule:"required",type:"string",name:"sessionId",id:3},{rule:"optional",type:"string",name:"originStreamId",id:4},{rule:"repeated",type:"string",name:"alternateOriginStreamIds",id:6},{rule:"repeated",type:"string",name:"capabilities",id:5},{rule:"optional",type:"bool",name:"permissive",id:7,options:{default:!1}}]},{name:"IssueStreamTokenResponse",fields:[{rule:"required",type:"string",name:"status",id:1},{rule:"optional",type:"string",name:"streamToken",id:2}]},{name:"IssueDrmToken",fields:[{rule:"required",type:"string",name:"applicationId",id:1},{rule:"required",type:"string",name:"secret",id:2},{rule:"optional",type:"string",name:"sessionId",id:3},{rule:"required",type:"string",name:"originStreamId",id:4},{rule:"repeated",type:"string",name:"capabilities",id:5}]},{name:"IssueDrmTokenResponse",fields:[{rule:"required",type:"string",name:"status",id:1},{rule:"optional",type:"string",name:"drmToken",id:2}]},{name:"TerminateStream",fields:[{rule:"required",type:"string",name:"applicationId",id:1},{rule:"required",type:"string",name:"secret",id:2},{rule:"optional",type:"string",name:"streamId",id:3,oneof:"streamOrToken"},{rule:"optional",type:"string",name:"streamToken",id:5,oneof:"streamOrToken"},{rule:"optional",type:"string",name:"reason",id:4}],oneofs:{streamOrToken:[3,5]}},{name:"TerminateStreamResponse",fields:[{rule:"required",type:"string",name:"status",id:1}]},{name:"DeleteStream",fields:[{rule:"required",type:"string",name:"applicationId",id:1},{rule:"required",type:"string",name:"secret",id:2},{rule:"optional",type:"string",name:"streamId",id:3,oneof:"streamOrToken"},{rule:"optional",type:"string",name:"streamToken",id:5,oneof:"streamOrToken"},{rule:"optional",type:"string",name:"reason",id:4}],oneofs:{streamOrToken:[3,5]}},{name:"DeleteStreamResponse",fields:[{rule:"required",type:"string",name:"status",id:1}]},{name:"Stream",fields:[{rule:"required",type:"string",name:"streamId",id:1}]},{name:"ListStreams",fields:[{rule:"required",type:"string",name:"applicationId",id:1},{rule:"required",type:"string",name:"secret",id:2},{rule:"optional",type:"string",name:"start",id:3},{rule:"required",type:"uint32",name:"length",id:4},{rule:"repeated",type:"string",name:"options",id:5}]},{name:"ListStreamsResponse",fields:[{rule:"required",type:"string",name:"status",id:1},{rule:"optional",type:"string",name:"start",id:2},{rule:"optional",type:"uint32",name:"length",id:3},{rule:"repeated",type:"Stream",name:"streams",id:4}]},{name:"GetPlaylistUris",fields:[{rule:"required",type:"string",name:"applicationId",id:1},{rule:"required",type:"string",name:"secret",id:2},{rule:"required",type:"string",name:"streamId",id:3},{rule:"repeated",type:"string",name:"options",id:4}]},{name:"GetPlaylistUrisResponse",fields:[{rule:"required",type:"string",name:"status",id:1},{rule:"repeated",type:"Playlist",name:"playlists",id:2},{rule:"optional",type:"StreamMetadata",name:"streamInfo",id:3}],messages:[{name:"PlaylistMetadata",fields:[{rule:"optional",type:"uint32",name:"bitrate",id:1},{rule:"optional",type:"uint32",name:"height",id:2},{rule:"optional",type:"float",name:"framesPerSecond",id:3}]},{name:"StreamMetadata",fields:[{rule:"required",type:"string",name:"startTime",id:1},{rule:"optional",type:"string",name:"endTime",id:2}]},{name:"Playlist",fields:[{rule:"required",type:"string",name:"name",id:1},{rule:"required",type:"PlaylistType",name:"type",id:2},{rule:"required",type:"string",name:"uri",id:3},{rule:"required",type:"bool",name:"isVariant",id:4},{rule:"required",type:"bool",name:"isProtected",id:5},{rule:"required",type:"PlaylistMetadata",name:"info",id:6}]}],enums:[{name:"PlaylistType",values:[{name:"Hls",id:0},{name:"Dash",id:1}]}]}]}}.apply(e,[]))||(t.exports=n)},function(t,e,i){var n,r;n=[i(0),i(1),i(7),i(12),i(2),i(50),i(49)],void 0===(r=function(t,e,i,n,r,s,o){"use strict";var a=5;function u(t,r,u,c){e.Ot(t,"uri"),e.tt(r,"deviceId"),e.Ot(u,"version"),e.V(c,"logger"),this.At=r,this.U=u,this.z=c,this.Bi=new n.MQWebSocket(t,this.z,[s,o],a),this.Wi=new i.Observable(null).extend({rateLimit:0})}return u.prototype.onEvent=function(t,e){return this.Bi.onEvent(t,e)},u.prototype.disconnect=function(){return this.Wi.setValue(null),this.Bi.disconnect()},u.prototype.authenticate=function(t,i){e.Ot(t,"authToken"),e.S(i,"callback");var n={apiVersion:this.Bi.getApiVersion(),clientVersion:this.U,deviceId:this.At,platform:r.browser,platformVersion:r.browserVersion.toString(),authenticationToken:t};this.getSessionId()&&(n.sessionId=this.getSessionId());var s=this;return this.Bi.sendRequest("pcast.Authenticate",n,function(t,e){if(e){var n=s.Wi.getValue();n&&n!==e.sessionId&&s.Bi.disposeOfPendingRequests(),s.Wi.setValue(e.sessionId)}return i(t,e)})},u.prototype.getSessionId=function(){return this.Wi.getValue()},u.prototype.getObservableSessionId=function(){return this.Wi},u.prototype.bye=function(t,i){e.Ot(t,"reason"),e.S(i,"callback");var n={sessionId:this.getSessionId(),reason:t};return this.Bi.sendRequest("pcast.Bye",n,i)},u.prototype.setupStream=function(i,n,s,o,a){e.Ot(i,"streamType"),e.Ot(n,"streamToken"),e.V(s,"options"),e.S(a,"callback");var u=r.browser||"UnknownBrowser",c=u+"-"+(r.browserVersion||0),h="rtt[http]="+o,d={streamToken:n,createStream:{sessionId:this.getSessionId(),options:["data-quality-notifications",h],connectUri:s.connectUri,connectOptions:s.connectOptions||[],tags:s.tags||[],userAgent:t.get(r,["global","navigator","userAgent"],c)}};return s.negotiate&&(d.createStream.createOfferDescription={streamId:"",options:[i,u,c],apiVersion:this.Bi.getApiVersion()},"undefined"!=typeof screen&&d.createStream.createOfferDescription.options.push("screen="+screen.width+"x"+screen.height)),!1===s.receiveAudio&&d.createStream.options.push("no-audio"),!1===s.receiveVideo&&d.createStream.options.push("no-video"),this.Bi.sendRequest("pcast.SetupStream",d,a)},u.prototype.setAnswerDescription=function(t,i,n){e.Ot(t,"streamId"),e.Ot(i,"sdp"),e.S(n,"callback");var r={streamId:t,sessionDescription:{type:"Answer",sdp:i},apiVersion:this.Bi.getApiVersion()};return this.Bi.sendRequest("pcast.SetRemoteDescription",r,n)},u.prototype.addIceCandidates=function(i,n,r,s){e.Ot(i,"streamId"),e.isArray(n,"candidates"),e.V(r,"options"),e.S(s,"callback");var o={streamId:i,candidates:t.map(n,function(t,i){return e.Ot(t.candidate,"candidate["+i+"].candidate"),e.lt(t.sdpMLineIndex,"candidate["+i+"].sdpMLineIndex"),e.Ot(t.sdpMid,"candidate["+i+"].sdpMid"),{candidate:t.candidate,sdpMLineIndex:t.sdpMLineIndex,sdpMid:t.sdpMid}}),options:r,apiVersion:this.Bi.getApiVersion()};return this.Bi.sendRequest("pcast.AddIceCandidates",o,s)},u.prototype.updateStreamState=function(t,i,n,r,s){e.Ot(t,"streamId"),e.Ot(i,"signalingState"),e.Ot(n,"iceGatheringState"),e.Ot(r,"iceConnectionState"),e.S(s,"callback");var o={streamId:t,signalingState:i,iceGatheringState:n,iceConnectionState:r,apiVersion:this.Bi.getApiVersion()};return this.Bi.sendRequest("pcast.UpdateStreamState",o,s)},u.prototype.destroyStream=function(t,i,n){e.Ot(t,"streamId"),e.tt(i,"reason"),e.S(n,"callback");var r={streamId:t,reason:i};return this.Bi.sendRequest("pcast.DestroyStream",r,n)},u.prototype.getRoomInfo=function(t,i,n){t?e.tt(t,"roomId"):e.tt(i,"alias"),e.S(n,"callback");var r={roomId:t,alias:i,sessionId:this.getSessionId()};return this.Bi.sendRequest("chat.GetRoomInfo",r,n)},u.prototype.createRoom=function(t,i){e.V(t,"room"),e.Ot(t.name,"room.name"),e.Ot(t.type,"room.type"),e.Ot(t.description,"room.description"),e.S(i,"callback");var n={sessionId:this.getSessionId(),room:t};return this.Bi.sendRequest("chat.CreateRoom",n,i)},u.prototype.enterRoom=function(t,i,n,r,s){t?e.tt(t,"roomId"):e.tt(i,"alias"),e.V(n,"member"),e.lt(r,"timestamp"),e.S(s,"callback");var o={roomId:t,alias:i,sessionId:this.getSessionId(),member:n,timestamp:r};return this.Bi.sendRequest("chat.JoinRoom",o,s)},u.prototype.leaveRoom=function(t,i,n){e.tt(t,"roomId"),e.lt(i,"timestamp"),e.S(n,"callback");var r={roomId:t,sessionId:this.getSessionId(),timestamp:i};return this.Bi.sendRequest("chat.LeaveRoom",r,n)},u.prototype.updateMember=function(t,i,n,r){e.Ot(t,"roomId"),e.V(i,"member"),e.lt(n,"timestamp"),e.S(r,"callback"),i.updateStreams=i.hasOwnProperty("streams");var s={sessionId:this.getSessionId(),roomId:t,member:i,timestamp:n};return this.Bi.sendRequest("chat.UpdateMember",s,r)},u.prototype.updateRoom=function(t,i,n){e.V(t,"room"),e.lt(i,"timestamp"),e.S(n,"callback");var r={sessionId:this.getSessionId(),room:t,timestamp:i};return this.Bi.sendRequest("chat.UpdateRoom",r,n)},u.prototype.sendMessageToRoom=function(t,i,n){e.Ot(t,"roomId"),e.V(i,"chatMessage");var r={roomId:t,chatMessage:i};return this.Bi.sendRequest("chat.SendMessageToRoom",r,n)},u.prototype.subscribeToRoomConversation=function(t,i,n,r){e.Ot(t,"sessionId"),e.Ot(i,"roomId"),e.lt(n,"batchSize");var s={sessionId:t,roomId:i,limit:n,options:["Subscribe"]};return this.Bi.sendRequest("chat.FetchRoomConversation",s,r)},u.prototype.getMessages=function(t,i,n,r,s,o){e.Ot(t,"sessionId"),e.Ot(i,"roomId"),s&&r||e.lt(n,"batchSize");var a={sessionId:t,roomId:i,limit:n||0,options:[]};return s&&(e.Ot(s,"beforeMessageId"),a.beforeMessageId=s),r&&(e.Ot(r,"afterMessageId"),a.afterMessageId=r),this.Bi.sendRequest("chat.FetchRoomConversation",a,o)},u.prototype.toString=function(){return"PCastProtocol["+this.Bi.toString()+"]"},u}.apply(e,n))||(t.exports=r)},function(t,e,i){var n,r;n=[i(2)],void 0===(r=function(t){"use strict";function e(){this.init()}return e.prototype.init=function(){if(!t.global.AudioContext&&!t.global.webkitAudioContext)throw new Error("Browser does not support AudioContext");this.Vi=new(t.global.AudioContext||t.global.webkitAudioContext)},e.prototype.getNativeAudioContext=function(){return this.Vi},e.prototype.toString=function(){return"AudioContext"},e}.apply(e,n))||(t.exports=r)},function(t,e,i){var n,r;n=[i(1),i(8)],void 0===(r=function(t,e){"use strict";return{toString:function(t){var e=0,i=t.length,n=[],r=[];if(e===i)return"";for(;e<i;)n.push(t[e++]),n.length>=1024&&(r.push(String.fromCharCode.apply(String,n)),n=[]);return r.join("")+String.fromCharCode.apply(String,n)},toByteArray:function(i){t.tt(i,"data");for(var n,r=0,s=new e.Uint8Array(i.length);r<i.length;){if((n=i.charCodeAt(r))>255)throw RangeError("illegal char code: "+n);s[r++]=n}return s}}}.apply(e,n))||(t.exports=r)},function(t,e,i){var n,r;n=[i(0),i(1),i(3)],void 0===(r=function(t,e,i){"use strict";var n=1,r=2,s=1500,o={clientAborted:{id:4e3,name:"Aborted by Client"}};function a(){}function u(e,i,n,r,s){h(r=r||{});var o=f(e,d(r.queryParameters||{},i)),a=t.bind(v,this,t.now(),s);if(!o)return s(l());r.responseType&&(o.responseType=r.responseType),p(o,r),o.addEventListener("readystatechange",t.bind(m,this,o,r,a)),o.timeout=r.timeout||15e3,o.send(n)}function c(e,i,n,r,s){var o=t.bind(e,this,i,n,r),a={startTime:t.now(),isDisposed:!1};return g.call(this,i,r,o,a,s)}function h(i){e.V(i,"settings"),i.queryParameters&&e.V(i.queryParameters,"settings.queryParameters"),i.mimeType&&e.W(i.mimeType,"settings.mimeType"),i.accept&&e.W(i.accept,"settings.accept"),i.contentType&&e.W(i.contentType,"settings.contentType"),i.responseType&&e.W(i.responseType,"settings.responseType"),t.isNullOrUndefined(i.timeout)||e.lt(i.timeout,"settings.timeout")}function d(e,i){var n=i.lastIndexOf("#"),r=i.indexOf("?"),s=t.reduce(e,function(t,e,i){return(t+=t?"&":"")+i.toString()+"="+e.toString()},""),o=-1===n?"":i.substring(n+1),a=-1===r?"":i.substring(r+1,o?n:i.length),u=s+(a?"&"+a:"");return i=i.replace("?"+a,"").replace("#"+o,""),u&&(i+="?"+u),o&&(i+="#"+o),i}function f(t,e){var i=new XMLHttpRequest;if("withCredentials"in i)i.open(t,e,!0);else{if("undefined"==typeof XDomainRequest)return;(i=new XDomainRequest).open(t,e)}return i}function l(){var t=new Error("unsupported");return t.code="unsupported",t}function p(e,i){var n=i.contentType||"application/json",r=i.accept||n,s=t.assign({},{"Content-Type":n,Accept:r},t.get(i,["headers"],{}));t.forOwn(s,function(t,i){e.setRequestHeader(i,t)})}function m(i,n,r){if(4===i.readyState)if(200===i.status){var s=function(e){var i=e.getAllResponseHeaders();return t.reduce(i.trim().split(/[\r\n]+/),function(t,e){var i=e.split(": "),n=i.shift(),r=i.join(": ");return n&&(t[n]=r),t},{})}(i);r(null,{data:i.response||i.responseText,headers:s,rawXhr:i})}else{var o=new Error(0===i.status?"timeout":i.statusText),a=t.get(n,["retryOptions","additionalRetryErrorCodes"],[]);t.forEach(a,function(t){e.lt(t,"additionalRetryErrorCode")}),o.code=i.status,(i.status>=500&&i.status<600||t.includes(a,i.status))&&(o.retryable=!0),r(o)}}function v(e,i,n,r){r&&t.set(r,["stats","successResponseTime"],t.now()-e),i(n,r)}function g(e,a,u,c,h,d){d=d||1;var f=this,l=t.get(a,["delay"],null),p=t.get(a,["retryOptions","delay"],s),m=t.get(a,["retryOptions","backoff"],r),v=t.get(a,["retryOptions","maxAttempts"],n),w=d>1?p*Math.pow(d,m):l,b=function(i,n){return c.isDisposed?h(y(o.clientAborted)):i&&i.retryable&&d<v?g.call(f,e,a,u,c,h,d+1):function(e,i,n,r,s){s&&(t.set(s,["stats","totalResponseTimeForAllAttempts"],t.now()-e),t.set(s,["stats","attempts"],i)),n(r,s)}.call(f,c.startTime,d,h,i,n)},S=new i.Disposable(function(){t.lt(c.mostRecentTimeout)&&clearTimeout(c.mostRecentTimeout),c.isDisposed=!0});return!t.lt(l)&&1===d||t.get(a,["retryOptions","sync"],!1)?(u.call(f,b),S):(function(t,e,i,n,r,s){var a=this;n.mostRecentTimeout=setTimeout(function(){if(n.isDisposed)return s(y(o.clientAborted));i.call(a,s)},r)}.call(f,e,a,u,c,w,b),S)}function y(t){var e=new Error(t.name);return e.code=t.id,e}return a.prototype.get=function(e,i,n){h(i=i||{});var r=f("GET",d(i.queryParameters||{},e)),s=t.bind(v,this,t.now(),n);if(!r)return n(l());i.mimeType&&r.overrideMimeType(i.mimeType),i.responseType&&(r.responseType=i.responseType),p(r,i),r.addEventListener("readystatechange",t.bind(m,this,r,i,s)),r.timeout=i.timeout||3e3,r.send()},a.prototype.post=function(t,e,i,n){return u.call(this,"POST",t,e,i,n)},a.prototype.put=function(t,e,i,n){return u.call(this,"PUT",t,e,i,n)},a.prototype.delete=function(t,e,i,n){return u.call(this,"DELETE",t,e,i,n)},a.prototype.getWithRetry=function(e,i,n){var r=t.bind(this.get,this,e,i),s={startTime:t.now(),isDisposed:!1};return g.call(this,e,i,r,s,n)},a.prototype.postWithRetry=function(t,e,i,n){return c.call(this,this.post,t,e,i,n)},a.prototype.putWithRetry=function(t,e,i,n){return c.call(this,this.put,t,e,i,n)},a.prototype.deleteWithRetry=function(t,e,i,n){return c.call(this,this.delete,t,e,i,n)},new a}.apply(e,n))||(t.exports=r)},function(t,e,i){var n,r;n=[i(0),i(1),i(4),i(8),i(20),i(5),i(7),i(3)],void 0===(r=function(t,e,i,n,r,s,o,a){var u=0,c={capacity:"capacity",error:"error",response:"response"},h="__phenixBatchHttpMessages";function d(s,u,c,d){e.Ot(s,"uri"),u=u||{},e.V(u,"options"),u.requestType&&e.Ot(u.requestType,"options.requestType"),u.maxAttempts&&e.lt(u.maxAttempts,"options.maxAttempts"),u.maxBufferedRecords&&e.lt(u.maxBufferedRecords,"options.maxBufferedRecords"),u.maxBatchSize&&e.lt(u.maxBatchSize,"options.maxBatchSize"),u.contentType&&e.Ot(u.contentType,"options.maxBatchSize"),c&&e.S(c,"serializeRequest"),d&&e.S(d,"deserializeResponse"),this.zi=h+"|"+s,this.Gi=u.requestType||"POST",this._i=u.requestTimeout||3e4,this.Ji=u.maxAttempts||5,this.Hi=u.maxBufferedRecords||1e3,this.Ki=u.maxBatchSize||100,this.Qi=u.contentType||"application/json",this.Xi=c,this.Zi=d,this.ri=s,this.gi=m.call(this)||[],this.Si=!0,this.wt=new i.NamedEvents,this.$i=new o.Observable(!0),this.h=new a.DisposableList,this.Yi=!1,this.tn=!1,this.h.add(this.$i.subscribe(t.bind(l,this))),this.h.add(function(){var t=this;return r.listenForNetworkChange(function(){p.call(t,t.Yi)})}.call(this)),this.h.add(this.wt),g.call(this,[]),l.call(this);var f=this;t.addEventListener(n,"beforeunload",function(){v.call(f,f.gi),f.tn=!0,f.gi=[]})}function f(){if(this.gi.length>this.Hi){var t=this.gi.length-this.Hi/2;this.gi=this.gi.slice(t),this.wt.fireAsync(c.capacity,[null,{numberOfDeletedRecords:t}])}}function l(){if(this.$i.getValue()&&0!==this.gi.length){p.call(this,!0);var e={records:t.take(this.gi,this.Ki)};this.gi=this.gi.slice(this.Ki);var i=this;try{(function(e,i,n){var r=this,o=this.Xi?this.Xi(t.assign({},i)):i;switch(this.Gi){case"POST":return s.postWithRetry(e,o,{timeout:this._i,contentType:this.Qi,retryOptions:{maxAttempts:this.Ji,additionalRetryErrorCodes:[0]}},function(t,e){if(t)return"timeout"!==t.message||function(){return this.gi.length>=this.Hi}.call(r)?(p.call(r,!1),r.wt.fire(c.error,[t])):n();p.call(r,!1);var i=r.Zi?r.Zi(e.data):e.data;return r.wt.fire(c.response,[i])});default:throw new Error("Invalid request type")}}).call(this,this.ri,e,function(){setTimeout(function(){i.gi=i.gi.concat(e.records),p.call(i,!1)},u)})}catch(t){setTimeout(function(){return p.call(i,!1),i.wt.fire(c.error,[t])},u)}}}function p(t){this.Yi=t,this.$i.setValue(!t&&r.isOnline())}d.prototype.on=function(t,i){return e.Ot(t,"eventName"),e.S(i,"callback"),this.wt.listen(t,i)},d.prototype.addRecord=function(t){if(this.tn)return v.call(this,[t]);this.gi.push(t),l.call(this),f.call(this)},d.prototype.addRecordToBeginning=function(t){this.gi.unshift(t),l.call(this),f.call(this)},d.prototype.dispose=function(){this.gi=[],this.h.dispose()};var m=function(){if(!n.localStorage)return null;var t=n.localStorage.getItem(this.zi);return t?JSON.parse(t):[]},v=function(t){if(!n.localStorage||!t||0===t.length)return null;var e=m.call(this).concat(t);return g.call(this,e)},g=function(t){return n.localStorage&&t?n.localStorage.setItem(this.zi,JSON.stringify(t)):null};return d}.apply(e,n))||(t.exports=r)},function(t,e,i){var n,r;n=[i(55)],void 0===(r=function(t){"use strict";return t}.apply(e,n))||(t.exports=r)},function(t,e,i){var n,r;n=[i(0),i(1),i(56),i(18),i(53)],void 0===(r=function(t,e,i,n,r){"use strict";function s(t,e,i){return r.toString(t.encode(e,i))}function o(t,e,i){return t.decode(e+"Response",r.toByteArray(i))}return function(r,a,u,c,h){e.Ot(r,"uri"),e.isArray(a,"protocols"),e.Ot(u,"type"),e.V(c,"options");var d=t.assign({},c||{},{contentType:"application/protobuf"}),f=new n(a,h);return new i(r,d,t.bind(s,this,f,u),t.bind(o,this,f,u))}}.apply(e,n))||(t.exports=r)},function(t,e,i){var n;!function(){for(var r={},s=[65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,48,49,50,51,52,53,54,55,56,57,43,47],o=[],a=0,u=s.length;a<u;++a)o[s[a]]=a;r.encode=function(t,e){for(var i,n;null!==(i=t());)e(s[i>>2&63]),n=(3&i)<<4,null!==(i=t())?(e(s[63&((n|=i>>4&15)|i>>4&15)]),n=(15&i)<<2,null!==(i=t())?(e(s[63&(n|i>>6&3)]),e(s[63&i])):(e(s[63&n]),e(61))):(e(s[63&n]),e(61),e(61))},r.decode=function(t,e){var i,n,r;function s(t){throw Error("Illegal character code: "+t)}for(;null!==(i=t());)if(void 0===(n=o[i])&&s(i),null!==(i=t())&&(void 0===(r=o[i])&&s(i),e(n<<2>>>0|(48&r)>>4),null!==(i=t()))){if(void 0===(n=o[i])){if(61===i)break;s(i)}if(e((15&r)<<4>>>0|(60&n)>>2),null!==(i=t())){if(void 0===(r=o[i])){if(61===i)break;s(i)}e((3&n)<<6>>>0|r)}}},r.test=function(t){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(t)},void 0!==t&&t.exports?t.exports=r:void 0===(n=function(){return r}.call(e,i,e,t))||(t.exports=n)}()},function(t,e,i){t.exports=i(58)},function(t,e,i){var n,r;n=[i(0),i(1),i(8),i(59)],void 0===(r=function(t,e,i,n){"use strict";function r(){this.en=[],this.in=""}return r.prototype.push=function(){this.en.length+arguments.length>1024&&(this.in+=String.fromCharCode.apply(String,this.en),this.en.length=0),Array.prototype.push.apply(this.en,arguments)},r.prototype.build=function(){return this.in+String.fromCharCode.apply(String,this.en)},{toString:function(e){var i=0,s=e.length,o=new r;return n.encode(function(){return i<s?e[i++]:null},t.bind(o.push,o)),o.build()},toByteArray:function(t){e.tt(t,"data");var r,s,o=[];return n.decode((r=t,s=0,function(){return s<r.length?r.charCodeAt(s++):null}),function(t){o.push(t)}),new i.Uint8Array(o)}}}.apply(e,n))||(t.exports=r)},function(t,e,i){var n;void 0===(n=function(){"use strict";return{package:"mq",messages:[{name:"Message",fields:[{rule:"optional",type:"MessageType",name:"messageType",id:7,options:{default:"Request"}},{rule:"optional",type:"string",name:"sessionId",id:1},{rule:"optional",type:"string",name:"requestId",id:2},{rule:"required",type:"string",name:"type",id:3},{rule:"optional",type:"string",name:"encoding",id:4},{rule:"required",type:"bytes",name:"payload",id:5},{rule:"repeated",type:"double",name:"wallTime",id:6}],enums:[{name:"MessageType",values:[{name:"Request",id:0},{name:"Response",id:1},{name:"Event",id:2}]}]},{name:"Error",fields:[{rule:"required",type:"string",name:"reason",id:1}]},{name:"PingPong",fields:[{rule:"required",type:"uint64",name:"originTimestamp",id:1},{rule:"optional",type:"uint64",name:"count",id:2}]}]}}.apply(e,[]))||(t.exports=n)},function(t,e,i){var n,r;n=[i(0)],void 0===(r=function(t){"use strict";function e(e){this.nn=e,this.rn={},this.sn={},function e(i,n){t.get(i,["messages","length"],0)>0&&function(i,n){var r=this;n.messages=t.reduce(i,function(t,i){if(!n[i.name])return t[i.name]={parent:n,type:i.name},e.call(r,i,t[i.name]),t},{})}.call(this,i.messages,n),t.get(i,["enums","length"],0)>0&&function(e,i){i.enums=t.reduce(e,function(e,i){return e[i.name]=t.reduce(i.values,function(t,e){return t[e.name]=e,t},{}),e},{})}.call(this,i.enums,n)}.call(this,this.nn,this.rn),function e(i,n){var s=this;t.forEach(i.messages,function(i){n.messages[i.name].fields=t.reduce(i.fields,t.bind(r,this,n.messages[i.name]),{}),i.messages&&e.call(s,i,n.messages[i.name])})}.call(this,this.nn,this.rn)}function i(e,i,n,r){var o,a=this,u=(o=e.messages[i],t.reduce(o.fields,function(e,i){return e[i.name]=t.clone(i.defaultValue),e},{}));return n.readFields(function(t,n,r){var o=e.messages[i].fields[t];"repeated"===o.rule?n[o.name].push(s.call(a,e.messages[i],i,t,r)):n[o.name]=s.call(a,e.messages[i],i,t,r)},u,r)}function n(e,i,r,s){var o=this,a=e.messages[i];t.forEach(t.keys(a.fields),function(a){return function e(i,r,s,o,a,u){var c=this,h=i.messages[r].fields[s],d=o[h.name];if(t.isUndefined(u)||(d=d[u]),h.defaultValue!==d&&!t.isUndefined(d)){if(t.isArray(d)){if("repeated"!==h.rule)throw new Error("Invalid type. Array is not valid with rule ["+h.rule+"]");return t.forEach(d,function(t,n){e.call(c,i,r,s,o,a,n)})}if(t.V(h.schema)&&t.V(d))return a.writeMessage(s,t.bind(n,this,h.schema.parent,h.type),d);var f=t.isUndefined(d)?h.defaultValue:d;if(t.V(h.schema)&&!h.schema.fields){var l=t.lt(d)?d:t.get(h.schema,[f,"id"]);return a.writeVarintField(s,l)}switch(h.type){case"string":return a.writeStringField(s,f);case"float":return a.writeFloatField(s,f);case"double":return a.writeDoubleField(s,f);case"bool":return a.writeBooleanField(s,f);case"enum":case"uint32":case"uint64":case"int32":case"int64":return a.writeVarintField(s,f);case"sint32":case"sint64":return a.writeSVarintField(s,f);case"fixed32":return a.writeFixed32Field(s,f);case"fixed64":return a.writeFixed64Field(s,f);case"sfixed32":return a.writeSFixed32Field(s,f);case"sfixed64":return a.writeSFixed64Field(s,f);case"bytes":return a.writeBytesField(s,f);default:throw new Error("Unexpected type: "+h.type)}}}.call(o,e,i,parseInt(a),r,s)})}function r(e,i,n){return i[n.id]={rule:n.rule,type:n.type,name:n.name,schema:function e(i,n){return t.get(n,["messages",i])?n.messages[i]:t.get(n,["enums",i])?n.enums[i]:n.parent?e(i,n.parent):i}.call(this,n.type,e),defaultValue:function(e,i,n){if("repeated"===e)return[];switch(i){case"float":case"double":case"uint32":case"uint64":case"int32":case"int64":case"sint32":case"sint64":case"fixed32":case"fixed64":case"sfixed32":case"sfixed64":case"string":case"enum":case"bool":case"long":default:return t.isUndefined(n)?null:n}}(n.rule,n.type,t.get(n,["options","default"]))},i}function s(e,n,r,s){var o="int32"===n||"int64"===n?"true":"",a=e.fields[r];if(t.V(a.schema))return a.schema.fields?i.call(this,a.schema.parent,a.type,s,s.readVarint()+s.pos):t.getEnumName(a.schema,s.readVarint(o));switch(a.type){case"string":return s.readString(o);case"float":return s.readFloat(o);case"double":return s.readDouble(o);case"bool":return s.readBoolean(o);case"enum":return s.readVarint(o);case"uint32":case"uint64":case"int32":case"int64":return s.readVarint(o);case"sint32":case"sint64":return s.readSVarint(o);case"fixed32":return s.readFixed32(o);case"fixed64":return s.readFixed64(o);case"sfixed32":return s.readSFixed32(o);case"sfixed64":return s.readSFixed64(o);case"bytes":return s.readBytes(o);default:throw new Error("Unexpected type: "+a.type)}}return e.prototype.read=function(t,e,n){if(!this.rn.messages[t])throw new Error("Unsupported proto type ["+t+"]");return i.call(this,this.rn,t,e,n)},e.prototype.write=function(t,e,i){if(!this.rn.messages[t])throw new Error("Unsupported proto type ["+t+"]");return n.call(this,this.rn,t,e,i)},e.prototype.getDefaults=function(){},e}.apply(e,n))||(t.exports=r)},function(t,e){e.read=function(t,e,i,n,r){var s,o,a=8*r-n-1,u=(1<<a)-1,c=u>>1,h=-7,d=i?r-1:0,f=i?-1:1,l=t[e+d];for(d+=f,s=l&(1<<-h)-1,l>>=-h,h+=a;h>0;s=256*s+t[e+d],d+=f,h-=8);for(o=s&(1<<-h)-1,s>>=-h,h+=n;h>0;o=256*o+t[e+d],d+=f,h-=8);if(0===s)s=1-c;else{if(s===u)return o?NaN:1/0*(l?-1:1);o+=Math.pow(2,n),s-=c}return(l?-1:1)*o*Math.pow(2,s-n)},e.write=function(t,e,i,n,r,s){var o,a,u,c=8*s-r-1,h=(1<<c)-1,d=h>>1,f=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,l=n?0:s-1,p=n?1:-1,m=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=h):(o=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-o))<1&&(o--,u*=2),(e+=o+d>=1?f/u:f*Math.pow(2,1-d))*u>=2&&(o++,u/=2),o+d>=h?(a=0,o=h):o+d>=1?(a=(e*u-1)*Math.pow(2,r),o+=d):(a=e*Math.pow(2,d-1)*Math.pow(2,r),o=0));r>=8;t[i+l]=255&a,l+=p,a/=256,r-=8);for(o=o<<r|a,c+=r;c>0;t[i+l]=255&o,l+=p,o/=256,c-=8);t[i+l-p]|=128*m}},function(t,e,i){"use strict";t.exports=r;var n=i(63);function r(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}function s(t){return t.type===r.Bytes?t.readVarint()+t.pos:t.pos+1}function o(t,e,i){return i?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function a(t,e,i){var n=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.ceil(Math.log(e)/(7*Math.LN2));i.realloc(n);for(var r=i.pos-1;r>=t;r--)i.buf[r+n]=i.buf[r]}function u(t,e){for(var i=0;i<t.length;i++)e.writeVarint(t[i])}function c(t,e){for(var i=0;i<t.length;i++)e.writeSVarint(t[i])}function h(t,e){for(var i=0;i<t.length;i++)e.writeFloat(t[i])}function d(t,e){for(var i=0;i<t.length;i++)e.writeDouble(t[i])}function f(t,e){for(var i=0;i<t.length;i++)e.writeBoolean(t[i])}function l(t,e){for(var i=0;i<t.length;i++)e.writeFixed32(t[i])}function p(t,e){for(var i=0;i<t.length;i++)e.writeSFixed32(t[i])}function m(t,e){for(var i=0;i<t.length;i++)e.writeFixed64(t[i])}function v(t,e){for(var i=0;i<t.length;i++)e.writeSFixed64(t[i])}function g(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function y(t,e,i){t[i]=e,t[i+1]=e>>>8,t[i+2]=e>>>16,t[i+3]=e>>>24}function w(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}r.Varint=0,r.Fixed64=1,r.Bytes=2,r.Fixed32=5,r.prototype={destroy:function(){this.buf=null},readFields:function(t,e,i){for(i=i||this.length;this.pos<i;){var n=this.readVarint(),r=n>>3,s=this.pos;this.type=7&n,t(r,e,this),this.pos===s&&this.skip(n)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=g(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=w(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=g(this.buf,this.pos)+4294967296*g(this.buf,this.pos+4);return this.pos+=8,t},readSFixed64:function(){var t=g(this.buf,this.pos)+4294967296*w(this.buf,this.pos+4);return this.pos+=8,t},readFloat:function(){var t=n.read(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=n.read(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,i,n=this.buf;return e=127&(i=n[this.pos++]),i<128?e:(e|=(127&(i=n[this.pos++]))<<7,i<128?e:(e|=(127&(i=n[this.pos++]))<<14,i<128?e:(e|=(127&(i=n[this.pos++]))<<21,i<128?e:function(t,e,i){var n,r,s=i.buf;if(n=(112&(r=s[i.pos++]))>>4,r<128)return o(t,n,e);if(n|=(127&(r=s[i.pos++]))<<3,r<128)return o(t,n,e);if(n|=(127&(r=s[i.pos++]))<<10,r<128)return o(t,n,e);if(n|=(127&(r=s[i.pos++]))<<17,r<128)return o(t,n,e);if(n|=(127&(r=s[i.pos++]))<<24,r<128)return o(t,n,e);if(n|=(1&(r=s[i.pos++]))<<31,r<128)return o(t,n,e);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(i=n[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=function(t,e,i){for(var n="",r=e;r<i;){var s,o,a,u=t[r],c=null,h=u>239?4:u>223?3:u>191?2:1;if(r+h>i)break;1===h?u<128&&(c=u):2===h?128==(192&(s=t[r+1]))&&(c=(31&u)<<6|63&s)<=127&&(c=null):3===h?(s=t[r+1],o=t[r+2],128==(192&s)&&128==(192&o)&&((c=(15&u)<<12|(63&s)<<6|63&o)<=2047||c>=55296&&c<=57343)&&(c=null)):4===h&&(s=t[r+1],o=t[r+2],a=t[r+3],128==(192&s)&&128==(192&o)&&128==(192&a)&&((c=(15&u)<<18|(63&s)<<12|(63&o)<<6|63&a)<=65535||c>=1114112)&&(c=null)),null===c?(c=65533,h=1):c>65535&&(c-=65536,n+=String.fromCharCode(c>>>10&1023|55296),c=56320|1023&c),n+=String.fromCharCode(c),r+=h}return n}(this.buf,this.pos,t);return this.pos=t,e},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){var i=s(this);for(t=t||[];this.pos<i;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){var e=s(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){var e=s(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){var e=s(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){var e=s(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){var e=s(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){var e=s(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){var e=s(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){var e=s(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===r.Varint)for(;this.buf[this.pos++]>127;);else if(e===r.Bytes)this.pos=this.readVarint()+this.pos;else if(e===r.Fixed32)this.pos+=4;else{if(e!==r.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var i=new Uint8Array(e);i.set(this.buf),this.buf=i,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),y(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),y(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),y(this.buf,-1&t,this.pos),y(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),y(this.buf,-1&t,this.pos),y(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(t,e){var i,n;if(t>=0?(i=t%4294967296|0,n=t/4294967296|0):(n=~(-t/4294967296),4294967295^(i=~(-t%4294967296))?i=i+1|0:(i=0,n=n+1|0)),t>=0x10000000000000000||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),function(t,e,i){i.buf[i.pos++]=127&t|128,t>>>=7,i.buf[i.pos++]=127&t|128,t>>>=7,i.buf[i.pos++]=127&t|128,t>>>=7,i.buf[i.pos++]=127&t|128,t>>>=7,i.buf[i.pos]=127&t}(i,0,e),function(t,e){var i=(7&t)<<4;e.buf[e.pos++]|=i|((t>>>=3)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t)))))}(n,e)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(t,e,i){for(var n,r,s=0;s<e.length;s++){if((n=e.charCodeAt(s))>55295&&n<57344){if(!r){n>56319||s+1===e.length?(t[i++]=239,t[i++]=191,t[i++]=189):r=n;continue}if(n<56320){t[i++]=239,t[i++]=191,t[i++]=189,r=n;continue}n=r-55296<<10|n-56320|65536,r=null}else r&&(t[i++]=239,t[i++]=191,t[i++]=189,r=null);n<128?t[i++]=n:(n<2048?t[i++]=n>>6|192:(n<65536?t[i++]=n>>12|224:(t[i++]=n>>18|240,t[i++]=n>>12&63|128),t[i++]=n>>6&63|128),t[i++]=63&n|128)}return i}(this.buf,t,this.pos);var i=this.pos-e;i>=128&&a(e,i,this),this.pos=e-1,this.writeVarint(i),this.pos+=i},writeFloat:function(t){this.realloc(4),n.write(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),n.write(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var i=0;i<e;i++)this.buf[this.pos++]=t[i]},writeRawMessage:function(t,e){this.pos++;var i=this.pos;t(e,this);var n=this.pos-i;n>=128&&a(i,n,this),this.pos=i-1,this.writeVarint(n),this.pos+=n},writeMessage:function(t,e,i){this.writeTag(t,r.Bytes),this.writeRawMessage(e,i)},writePackedVarint:function(t,e){this.writeMessage(t,u,e)},writePackedSVarint:function(t,e){this.writeMessage(t,c,e)},writePackedBoolean:function(t,e){this.writeMessage(t,f,e)},writePackedFloat:function(t,e){this.writeMessage(t,h,e)},writePackedDouble:function(t,e){this.writeMessage(t,d,e)},writePackedFixed32:function(t,e){this.writeMessage(t,l,e)},writePackedSFixed32:function(t,e){this.writeMessage(t,p,e)},writePackedFixed64:function(t,e){this.writeMessage(t,m,e)},writePackedSFixed64:function(t,e){this.writeMessage(t,v,e)},writeBytesField:function(t,e){this.writeTag(t,r.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,r.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,r.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,r.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,r.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,r.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,r.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,r.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,r.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,r.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}}},function(t,e,i){var n,r;n=[i(0),i(8),i(4),i(7),i(3)],void 0===(r=function(t,e,i,n,r){"use strict";function s(){var r="undefined"==typeof navigator||navigator.onLine;this.an=new n.Observable(r).extend({timeout:0}),this.wt=new i.NamedEvents,t.addEventListener(e,"online",t.bind(this.wt.fire,this.wt,"online",[])),t.addEventListener(e,"offline",t.bind(this.wt.fire,this.wt,"offline",[])),t.addEventListener(e,"unload",t.bind(this.wt.dispose,this.wt)),this.wt.listen("online",t.bind(this.an.setValue,this.an,!0)),this.wt.listen("offline",t.bind(this.an.setValue,this.an,!1))}function o(e,i){var n=this;if(this.an.setValue(!1),!t.lt(i))return e(!1);n.offlineTimeout=setTimeout(function(){e&&!n.an.getValue()&&e(!1)},i)}function a(t){this.an.setValue(!0),t&&t(!0)}return s.prototype.listenForNetworkChange=function(e,i){var n=new r.DisposableList,s=t.bind(a,this,e),u=t.bind(o,this,e,i);return n.add(this.wt.listen("online",s)),n.add(this.wt.listen("offline",u)),n},s.prototype.isOnline=function(){return this.an.getValue()},new s}.apply(e,n))||(t.exports=r)},function(t,e,i){var n,r;n=[i(0),i(1),i(20)],void 0===(r=function(t,e,i){"use strict";var n=15e3,r=1e3,s=1e3,o=4,a={byebye:{code:1e3,reason:"byebye",desc:"Client closed"},backoffLimitReached:{code:4e3,reason:"backoff-limit-reached",desc:"Reached the limit in terms of the number of reconnects"},networkDisconnect:{code:4001,reason:"network-disconnect",desc:"Network connection monitor determined loss to internet connectivity"},reconnecting:{code:4002,reason:"reconnecting",desc:"Closing WebSocket in order to attempt to establish another connection"}},u={connecting:{code:0,state:"CONNECTING",desc:"The connection is not yet open"},open:{code:1,state:"OPEN",desc:"The connection is open and ready to communicate"},closing:{code:2,state:"CLOSING",desc:"The connection is in the process of closing"},closed:{code:3,state:"CLOSED",desc:"The connection is closed or could not be opened"}};function c(c,h,f,y){e.Ot(c,"uri"),e.V(h,"logger"),t.isNullOrUndefined(f)?f=o:e.lt(f,"maxReconnectAttempts"),this.ri=c,this.z=h,this.un=f,this.cn=y||s,this.hn=!1,this.Jt=!1,this.dn=[],this.fn="connecting",this.z.info("Connecting WebSocket to [%s]",c),this.Mt=d.call(this,m,l);var w=this;this.ln=null,this.pn=i.listenForNetworkChange(function(e){if(e)return t.lt(w.ln)&&(clearTimeout(w.ln),w.ln=null),function(){var t=this;setTimeout(function(){return t.Jt?t.z.info("Unable to go back online after network reconnect. Client has stopped WebSocket."):t.Mt.readyState!==u.open.code?(t.z.info("Network Reconnected. Attempting to reconnect WebSocket."),t.reconnect()):t.mn?(t.z.info("Network Reconnected with WebSocket status of [%s].",u.open.state),m.call(t)):("online"===t.fn&&"reconnected"===this.fn||v.call(t),void t.z.info("Network Reconnected."))},r)}.call(w);t.lt(w.ln)||(p.call(w),w.ln=setTimeout(function(){return function(){this.z.warn("Network not reconnected after [%s]. Going Offline and disconnecting WebSocket connection.",n),this.mn=!0,g.call(this,a.networkDisconnect)}.call(w)},n))},0)}function h(t){return this.Mt.readyState===u.closed.code?l.call(this,t):this.Mt.close(t.code,t.reason)}function d(e,i){var n=new WebSocket(this.ri);return n.onopen=t.bind(e,this),n.onclose=t.bind(i,this),n.onmessage=t.bind(w,this),n.onerror=t.bind(y,this),n}function f(t){this.Mt.readyState!==u.open.code&&this.reconnect(t+1)}function l(t){switch(t.code){case a.reconnecting.code:return;case a.byebye.code:case a.backoffLimitReached.code:case a.networkDisconnect.code:return g.call(this,t);default:if(this.hn)return;return p.call(this,t),this.z.info("Attempting to re-establish socket connection after disconnect event with code [%s] and reason [%s]",t.code,t.reason),this.reconnect()}}function p(t){this.z.info("WebSocket is reconnecting"),this.fn="reconnecting",this.onreconnecting&&this.onreconnecting(t)}function m(t){this.z.info("WebSocket Connected"),function(){var t=this.dn.length;if(0!==t)for(this.z.info("Sending [%s] queued messages",t);t>0;){t--;var e=this.dn.shift();this.send(e)}}.call(this),this.fn="connected",this.onconnected&&this.onconnected(t)}function v(t){this.z.info("Successfully reconnected to WebSocket"),this.fn="reconnected",this.onreconnected&&this.onreconnected(t)}function g(t){this.z.info("WebSocket Disconnected [%s]: [%s]",t.code,t.reason),this.fn="disconnected",this.ondisconnected&&this.ondisconnected(t)}function y(t){this.z.error("An error occurred on the WebSocket connection [%s]",t.data||t),this.onerror&&this.onerror(t)}function w(t){this.z.debug(">> [%s]",t.data),this.onmessage&&this.onmessage(t)}return c.prototype.onmessage=null,c.prototype.onconnected=null,c.prototype.onreconnecting=null,c.prototype.onreconnected=null,c.prototype.ondisconnected=null,c.prototype.onerror=null,c.prototype.send=function(t){return i.isOnline(),this.Mt.send(t)},c.prototype.reconnect=function(e){this.Mt.onclose=null,this.Mt.onerror=null,this.hn=!0;var i,n=this;if(t.lt(e)||(e=1),this.Jt)return this.z.info("Client has stopped WebSocket after [%s] reconnect attempts",e-1);if(e>this.un)return this.z.warn("Unable to reconnect WebSocket after [%s] attempts",this.un),h.call(this,a.backoffLimitReached);h.call(this,a.reconnecting);try{this.Mt=d.call(n,function(){return i&&clearTimeout(i),n.hn=!1,n.Mt.onclose=t.bind(l,n),v.call(n)},function(){e+1>n.un&&(i&&clearTimeout(i),f.call(n,e))})}catch(t){this.z.warn("Unable to create WebSocket connection [%s]",t)}i=function(t){var e=this;return setTimeout(function(){f.call(e,t)},t*t*this.cn)}.call(this,e)},c.prototype.disconnect=function(){return this.pn.dispose(),this.Jt=!0,t.lt(this.ln)&&(clearTimeout(this.ln),this.ln=null),this.Mt.close(a.byebye.code,a.byebye.reason)},c.prototype.toString=function(){return"ReconnectedWebSocket["+this.ri+","+this.Mt.readyState+"]"},c}.apply(e,n))||(t.exports=r)},function(t,e,i){var n,r;n=[i(66)],void 0===(r=function(t){"use strict";return t}.apply(e,n))||(t.exports=r)},function(t,e,i){var n,r;n=[i(0),i(1),i(4),i(67),i(19)],void 0===(r=function(t,e,i,n,r){"use strict";function s(s,o,p,m){e.Ot(s,"uri"),e.V(o,"logger"),e.isArray(p,"protocols"),this.ri=s,this.z=o,this.z.info("Connecting to [%s]",s),this.Mt=new n(this.ri,this.z),this.vn=new r(this.z,t.bind(l,this),t.bind(f,this),p,m),this.wt=new i.NamedEvents,this.Mt.onconnected=t.bind(u,this),this.Mt.onreconnecting=t.bind(a,this),this.Mt.onreconnected=t.bind(c,this),this.Mt.ondisconnected=t.bind(h,this),this.Mt.onerror=t.bind(d,this),this.gn=!1}function o(t,e){this.wt.fire(t,e,this)}function a(t){o.call(this,"reconnecting")}function u(t){o.call(this,"connected")}function c(t){o.call(this,"reconnected")}function h(t){o.call(this,"disconnected",[t.code,t.reason]),this.gn&&(this.wt.dispose(),this.vn.dispose())}function d(t){o.call(this,"error",[t.data])}function f(t){this.Mt.onmessage=t}function l(t){this.Mt&&this.Mt.send(t)}return s.prototype.onEvent=function(t,e){return this.wt.listen(t,e),this.vn.onEvent(t,e)},s.prototype.onRequest=function(t,e){return this.vn.onRequest(t,e)},s.prototype.sendRequest=function(t,e,i,n){return this.vn.sendRequest(t,e,i,n)},s.prototype.sendResponse=function(t,e,i,n){return this.vn.sendResponse(t,e,i,n)},s.prototype.disconnect=function(){return this.gn=!0,this.Mt.disconnect()},s.prototype.disposeOfPendingRequests=function(){return this.z.info("Disposing of pending MQ WebSocket requests"),this.vn.disposeOfRequests()},s.prototype.getApiVersion=function(){return this.vn.getApiVersion()},s.prototype.toString=function(){return"MQWebSocket["+this.Mt.toString()+"]"},s}.apply(e,n))||(t.exports=r)},function(t,e,i){var n,r;n=[i(0),i(1),i(2),i(9),i(12),i(17)],void 0===(r=function(t,e,i,n,r,s){function o(o){e.tt(o,"uri"),this.wi="/telemetry/logs",this.bi="object"==typeof location?location.hostname:i.browser+"-"+i.browserVersion+"-unknown",this.yn=n.level.TRACE,this.Si=!0,this.ki=(i.browser||"Browser")+"/"+(i.browserVersion||"?"),this.xi=0,this.Ei=new r.BatchHttpProto(o+this.wi,[s],"telemetry.StoreLogRecords",{maxAttempts:3,maxBufferedRecords:1e3,maxBatchSize:512}),this.Ei.on("capacity",t.bind(a,this))}function a(e){this.Ei.addRecordToBeginning({level:"Warn",timestamp:t.isoString(),category:"websdk/telemetryLogger",message:"Deleted "+e+" records",source:this.ki,fullQualifiedName:this.bi,sessionId:this.Ii,userId:this.wn,environment:this.Ri,version:this.Ci,runtime:this.xi})}return o.prototype.setThreshold=function(t){e.lt(t,"level"),this.yn=t},o.prototype.getThreshold=function(){return this.yn},o.prototype.isEnabled=function(){return this.Si},o.prototype.setEnabled=function(t){e.pt(t,"enabled"),this.Si=t},o.prototype.log=function(i,n,r,s,o,a,u,c,h){h.level<this.yn||!this.Si||(e.isArray(s,"messages"),this.xi=i,this.Ii=o,this.wn=a,this.Ri=u,this.Ci=c,function(e,i,n){this.Ei.addRecord({level:e,timestamp:t.isoString(),category:i,message:n.join(" "),source:this.ki,fullQualifiedName:this.bi,sessionId:this.Ii,userId:this.wn,environment:this.Ri,version:this.Ci,runtime:this.xi})}.call(this,n,r,s))},o}.apply(e,n))||(t.exports=r)},function(t,e,i){var n,r;n=[i(0),i(1),i(21),i(69)],void 0===(r=function(t,e,i,n){var r={urls:{local:"",staging:"https://telemetry-stg.phenixrts.com",production:"https://telemetry.phenixrts.com"}};function s(){this.bn={}}return s.prototype.getAppender=function(t){var e=i.parseEnvFromPcastBaseUri(t||""),s=r.urls[e];return this.bn[e]||(this.bn[e]=function(t){var e=new n(t);return t||e.setEnabled(!1),e}.call(this,s)),this.bn[e]},new s}.apply(e,n))||(t.exports=r)},function(t,e,i){var n,r;n=[i(0),i(1),i(9),i(70)],void 0===(r=function(t,e,i,n){"use strict";function r(){}return r.prototype.createPCastLogger=function(t,r){t&&e.Ot(t,"baseUri");var s=new i.Logger,o=n.getAppender(t);return o.setThreshold(i.level.INFO),r||s.addAppender(new i.ConsoleAppender),s.addAppender(o),s.isPCastLogger=!0,s},new r}.apply(e,n))||(t.exports=r)},function(t,e,i){var n,r;n=[i(0),i(1),i(22)],void 0===(r=function(t,e,i){"use strict";function n(){this.u={}}return n.prototype.fire=function(i,n,r){e.Ot(i,"name"),t.includes(t.keys(this.u),i)&&this.u[i].fire(n,r)},n.prototype.fireAsync=function(i,n,r){e.Ot(i,"name"),t.includes(t.keys(this.u),i)&&this.u[i].fireAsync(n,r)},n.prototype.listen=function(n,r){return e.Ot(n,"name"),(t.includes(t.keys(this.u),n)?this.u[n]:this.u[n]=new i).listen(r)},n.prototype.size=function(e){return t.includes(t.keys(this.u),e)?this.u[e].size():0},n.prototype.dispose=function(){t.forOwn(this.u,function(t){t.dispose()}),this.u={}},n.prototype.toString=function(){return"NamedEvents|"+t.keys(this.u).length},n}.apply(e,n))||(t.exports=r)},function(t,e,i){var n,r;n=[i(0),i(1),i(13)],void 0===(r=function(t,e,i){"use strict";function n(){this.yn=i.level.TRACE}n.prototype.setThreshold=function(t){e.lt(t,"level"),this.yn=t},n.prototype.getThreshold=function(){return this.yn},n.prototype.log=function(t,e,n,o,a,u,c,h,d){d.level<this.yn||(o[0]=t+" ["+n+"] "+e+" "+o[0],d.level>i.level.INFO?s(o):r(o))};var r=function(t){console.log.apply(console,t)}||function(){},s=function(t){console.error.apply(console,t)}||r;return n}.apply(e,n))||(t.exports=r)},function(t,e){var i;i=function(){return this}();try{i=i||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(i=window)}t.exports=i},function(t,e,i){(function(i){var n;void 0===(n=function(){"use strict";return function(){return"undefined"!=typeof window?window:void 0!==i?i:"undefined"!=typeof self?self:{}}}.apply(e,[]))||(t.exports=n)}).call(this,i(74))},function(t,e,i){var n,r;n=[i(0),i(1),i(8),i(13)],void 0===(r=function(t,e,i,n){"use strict";var r="websdk",s=i.__phenixPageLoadTime||i.__pageLoadTime||t.now(),o="production",a="2018-06-11T21:40:43Z",u="2018.2.9";function c(){this.Sn=[],this.kn=null,this.li=null,this.fi=o,this.En=a}function h(t){this.li=t,t?this.info("Session started on websdk version [%s] ([%s]), user agent [%s]",a,u,navigator.userAgent):this.info("Websdk version [%s] ([%s]), user agent [%s]",a,u,navigator.userAgent)}function d(e,i){var o=(t.now()-s)/1e3,a=function(t){switch(t){case n.level.TRACE:return"Trace";case n.level.DEBUG:return"Debug";case n.level.INFO:return"Info";case n.level.WARN:return"Warn";case n.level.ERROR:return"Error";case n.level.FATAL:return"Fatal";default:throw new Error("Unsupported Logging Level "+t)}}(i.level),u=i.name||r,c=this;t.forEach(this.Sn,function(t){try{t.log(o,a,u,f(Array.prototype.slice.call(e)),c.li,c.kn,c.fi,c.En,i)}catch(t){}})}c.prototype.trace=function(){return d.call(this,arguments,{level:n.level.TRACE})},c.prototype.debug=function(){return d.call(this,arguments,{level:n.level.DEBUG})},c.prototype.info=function(){return d.call(this,arguments,{level:n.level.INFO})},c.prototype.warn=function(){return d.call(this,arguments,{level:n.level.WARN})},c.prototype.error=function(){return d.call(this,arguments,{level:n.level.ERROR})},c.prototype.fatal=function(){return d.call(this,arguments,{level:n.level.FATAL})},c.prototype.addAppender=function(t){e.V(t,"appender"),e.S(t.log,"appender.log"),this.Sn.push(t)},c.prototype.getAppenders=function(){return this.Sn},c.prototype.getUserId=function(){return this.kn},c.prototype.setUserId=function(t){this.kn=t},c.prototype.getEnvironment=function(){return this.fi},c.prototype.setEnvironment=function(t){this.fi=t},c.prototype.getApplicationVersion=function(){return this.En},c.prototype.setApplicationVersion=function(t){this.En=t},c.prototype.getObservableSessionId=function(){return this.Wi},c.prototype.setObservableSessionId=function(i){this.Wi=i,this.In&&this.In.dispose(),i&&(e.V(i,"observableSessionId"),this.In=this.Wi.subscribe(t.bind(h,this),{initial:"notify"}))};var f=function(e){if(0!==e.length){var i=[],n=[];return t.forEach(e,function(e){i.push(t.toString(e)),e instanceof Error&&n.push(e.stack)}),l(i.concat(n))}},l=function(t){for(var e=t[0],i=0;e.indexOf&&t.length>1&&i>=0;)if((i=e.indexOf("%",i))>0)switch(e.substring(i+1,i+2)){case"%":e=e.substring(0,i)+e.substring(i+1),i++;break;case"s":case"d":t[0]=e=e.substring(0,i)+t[1]+e.substring(i+2),t.splice(1,1);break;default:return t}return t};return c}.apply(e,n))||(t.exports=r)},function(t,e,i){var n,r;n=[i(0),i(1)],void 0===(r=function(t,e){"use strict";function i(t){e.V(t,"observable"),this.Tn=t,this.Rn=null,this.Si=!1}return i.prototype.start=function(e,i){this.Si=!0,this.Rn=this.Tn.subscribe(t.noop,{listenForChanges:{callback:e,timeout:i||500}})},i.prototype.stop=function(){this.Si=!1,this.Rn&&this.Rn.dispose(),this.Rn=null},i.prototype.isEnabled=function(){return this.Si},i}.apply(e,n))||(t.exports=r)},function(t,e,i){var n,r;n=[i(0),i(1),i(24)],void 0===(r=function(t,e,i){"use strict";function n(t,n){var r=t;void 0!==r&&null!==r||(r=[]),e.isArray(r,"valuesToSet"),this.observableArray=new i(r,n)}return n.prototype.getValue=function(){return this.observableArray.getValue()},n.prototype.setValue=function(t){return void 0!==t&&null!==t||(t=[]),void 0!==t&&e.isArray(t,"values"),this.observableArray.setValue(t)},n.prototype.subscribe=function(t,e){return this.observableArray.subscribe(t,e)},n.prototype.push=function(t){var e=this.observableArray.getValue();e.push(t),this.observableArray.setValue(e)},n.prototype.pop=function(){var t=this.observableArray.getValue(),e=t.pop();return this.observableArray.setValue(t),e},n.prototype.remove=function(e){var i=this.observableArray.getValue(),n=function(i){return t.S(e)?e(i):i===e},r=t.filter(i,n);return r.length>0&&this.observableArray.setValue(t.remove(i,n)),r},n.prototype.removeAll=function(){var t=this.observableArray.getValue();return this.observableArray.setValue([]),t},n.prototype.extend=function(t){return this.observableArray.extend(t),this},n}.apply(e,n))||(t.exports=r)},function(t,e,i){var n,r;n=[i(0)],void 0===(r=function(t){"use strict";function e(){this.I=[]}return e.prototype.add=function(e){if(!e||!t.S(e.dispose))throw new Error('"disposable" must be a disposable or implement dispose');this.I.push(e)},e.prototype.dispose=function(){var e=[];return t.forEach(this.I,function(t){e.push(t.dispose())}),this.I=[],e},e.prototype.toString=function(){return t.toString(this)},e}.apply(e,n))||(t.exports=r)},function(t,e,i){var n,r;n=[i(0),i(1)],void 0===(r=function(t,e){"use strict";function i(t){e.S(t,"cleanup"),this.k=t}return i.prototype.dispose=function(){return this.k.call()},i.prototype.toString=function(){return t.toString(this)},i}.apply(e,n))||(t.exports=r)},function(t,e,i){var n,r;n=[i(0)],void 0===(r=function(t){"use strict";function e(t){this.Cn=t||""}return e.prototype.detect=function(){var e="Unknown",i="?",n=this.Cn.match(/(Chrome|Chromium|Firefox|Opera|Safari)+\//),r=this.Cn.match(/(Chrome|Chromium|Firefox|Version)+\/([0-9]+)\./),s=!1;return n&&n.length>=2?e=n[1]:this.Cn.match(/^\(?Mozilla/)&&(e="Mozilla",(this.Cn.match(/MSIE/)||this.Cn.match(/; Trident\/.*rv:[0-9]+/))&&(e="IE",(r=this.Cn.match(/MSIE ([0-9]+)/))?(i=parseInt(r[1],10),(r=this.Cn.match(/MSIE [0-9]+.*MSIE ([0-9]+)/))&&(i=parseInt(r[1],10))):(r=this.Cn.match(/rv:([0-9]+)/))&&(i=parseInt(r[1],10)))),"Chrome"===e&&this.Cn.match(/OPR\//)?(e="Opera",r=this.Cn.match(/(OPR)\/([0-9]+)\./)):"Chrome"===e&&this.Cn.match(/Edge\//)?(e="Edge",r=this.Cn.match(/(Edge)\/([0-9]+)\./)):"Firefox"!==e&&"IE"!==e||!this.Cn.match(/Opera/)?"Mozilla"===e&&this.Cn.match(/iphone|ipod|ipad/i)&&(e="Safari",i=parseInt(t.get(this.Cn.match(/OS\s([0-9]+)/),[1]),10),s=!0):(e="Opera",r=this.Cn.match(/(Opera) ([0-9]+)\./)),"Chrome"===e&&(this.Cn.match(/; wv/)||this.Cn.match(/Android/)&&this.Cn.match(/Version\/[0-9].[0-9]/))&&(s=!0),"IE"!==e&&r&&r.length>=3&&(i=parseInt(r[2],10)),"ReactNative"===navigator.product&&(e="ReactNative",i=navigator.productSub||"?"),{browser:e,version:i,isWebview:s}},e}.apply(e,n))||(t.exports=r)},function(t,e,i){var n,r;n=[i(81)],void 0===(r=function(t){return t}.apply(e,n))||(t.exports=r)},function(t,e,i){var n,r;n=[i(0)],void 0===(r=function(t){var e=function(){};return e.prototype.V=function(i,n){e.prototype.tt("name",n);var r='"'+n+'" must be an object';if(!t.V(i))throw new Error(r)},e.prototype.isArray=function(i,n){e.prototype.tt("name",n);var r='"'+n+'" must be an array';if(!t.isArray(i))throw new Error(r)},e.prototype.tt=function(e,i){var n='"'+i+'" must be a string';if(!t.tt(i))throw new Error('"name" must be a string');if(!t.tt(e))throw new Error(n)},e.prototype.pt=function(i,n){e.prototype.tt("name",n);var r='"'+n+'" must be a boolean';if(!t.pt(i))throw new Error(r)},e.prototype.lt=function(i,n){e.prototype.tt("name",n);var r='"'+n+'" must be a number';if(!t.lt(i))throw new Error(r)},e.prototype.S=function(i,n){e.prototype.tt("name",n);var r='"'+n+'" must be a function';if(!t.S(i))throw new Error(r)},e.prototype.W=function(t,i){e.prototype.Ot(t,i)},e.prototype.Ot=function(t,i){e.prototype.tt("name",i);var n='"'+i+'" must not be empty';if(e.prototype.tt(t,i),""===t)throw new Error(n)},e.prototype.xn=function(i,n,r){if(e.prototype.tt("name",r),!t.V(i))throw new Error('"'+r+'" must be an instance');if(!(i instanceof n))throw new Error('"'+r+'" must be a valid instance of class')},e.prototype.Mi=function(i,n){if(e.prototype.tt("name",n),t.isUndefined(i))throw new Error('"'+n+'" must not be undefined')},e.prototype.Ee=function(i,n,r){if(e.prototype.Ot(r,"name"),i=t.getEnumName(n,i),t.isNullOrUndefined(i))throw new Error('"'+r+'" must be a valid type');return i},e.prototype.On=function(i,n){e.prototype.tt(n,"name"),e.prototype.isArray(i,n),t.forEach(i,function(t,i){e.prototype.tt(t,n+"["+i+"]")})},new e}.apply(e,n))||(t.exports=r)},function(t,e,i){var n;void 0===(n=function(){"use strict";var t=function(){};t.clone=function(e){return t.isArray(e)?e.slice():t.V(e)?t.assign({},e):e},t.get=function(e,i,r){if(t.isNullOrUndefined(e))return r;n(e,"objectToTraverse");var s=i;if(t.tt(s))s=o(i);else if(!t.isArray(s))throw new Error("Unsupported path type "+typeof i);var a=t.reduce(s,function(e,i){if(t.V(e)||t.isArray(e))return e[i]},e);return t.isUndefined(a)?r:a},t.set=function(e,i,r){if(!t.V(e))return e;n(e,"objectToTraverse");var s=e,a=i;if(t.tt(a))a=o(i);else if(!t.isArray(a))throw new Error("Unsupported path type "+typeof i);return t.forEach(a,function(e,i){!function(e,i,n){if(t.lt(parseInt(i))&&t.isArray(e))return e[i]=n;if(t.tt(i)&&t.V(e))return e[i]=n;throw new Error("Unsupported type "+typeof i+" when setting property or index")}(s,e,function(e,i,n,r){if(e.length-1===i)return r;var s=e[i],o=e[i+1];if(t.isArray(n[s])||t.V(n[s]))return n[s];if(!t.isArray(n[s])&&t.lt(parseInt(o)))return[];if(!t.V(n[s])&&t.tt(o))return{};throw new Error("Unsupported type "+typeof s+" when setting property or index")}(a,i,s,r)),s=s[e]}),e},t.bind=function(e,i){var n=Array.prototype.slice.call(arguments,2);return function(){if(!t.S(e))throw new TypeError("_.bind - callback must be a function");var r=n.concat(Array.prototype.slice.call(arguments));return e.apply(i,r)}},t.now=function(){return(new Date).getTime()},t.utc=function(e){return t.lt(e)?e:e?Math.floor(e):NaN},t.isoString=function(){var e=new Date;return e.toISOString?e.toISOString():e.getUTCFullYear()+"-"+t.pad(e.getUTCMonth()+1,2)+"-"+t.pad(e.getUTCDate(),2)+"T"+t.pad(e.getUTCHours(),2)+":"+t.pad(e.getUTCMinutes(),2)+":"+t.pad(e.getUTCSeconds(),2)+"."+(e.getUTCMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"},t.map=function(e,i){n(e,"collection");var r=[];return e.constructor===Array?t.forEach(e,function(e,n){t.tt(i)&&t.V(e)?r.push(e[i]):t.S(i)&&r.push(i(e,n))}):t.forOwn(e,function(e,n){t.S(i)&&r.push(i(e,n))}),r},t.values=function(e){if(!t.V(e)||t.isArray(e))throw new Error("Collection must be an object.");return t.map(e,function(t){return t})},t.keys=function(e){if(!t.V(e)||t.isArray(e))throw new Error("Collection must be an object.");return t.map(e,function(t,e){return e})},t.forEach=function(i,n){if(!t.S(n))throw new Error("Callback must be a function");e(i,"collection");for(var r=0;r<i.length;r++)if(!1===n(i[r],r))return},t.forOwn=function(e,i){if(!t.S(i))throw new Error("Callback must be a function");n(e,"objectWithProperties");for(var r=Object.keys(e),s=0;s<r.length;s++){var o=r[s];(e.hasOwnProperty(o)||Object.prototype.hasOwnProperty.call(e,o))&&i(e[o],o)}},t.argumentsToArray=function(e){if(!t.V(e)||!e.length)throw new Error("Collection must be arguments");for(var i=[],n=0;n<e.length;n++)i.push(e[n]);return i},t.assign=function(e){n(e,"target");var i=t.argumentsToArray(arguments);return i.shift(),t.forEach(i,function(i,r){n(i,"source "+r),t.forOwn(i,function(t,i){e[i]=t})}),e},t.includes=function(e,i){if(t.tt(e))return s(i,"Includes value and search parameter"),e.indexOf(i)>-1;if(t.isUndefined(e)||t.isUndefined(i))return!1;n(e,"collection");var r=!1,o=function(t){t===i&&(r=!0)};return e.constructor===Array?t.forEach(e,o):t.forOwn(e,o),r},t.reduce=function(e,i,r){n(e,"collection");var s=r===t.noop()?null:r;return e.constructor===Array?t.forEach(e,function(t,e){s=i(s,t,e)}):t.forOwn(e,function(t,e){s=i(s,t,e)}),s},t.sample=function(t){return e(t,"collection"),t[Math.floor(Math.random()*t.length)]},t.uniqueId=function(){return(t.now()*Math.random()).toString()},t.find=function(i,n,r){var s;return e(i,"collection"),t.forEach(i,function(t,e){if(n(t)&&e>=(r||0))return s=t}),s},t.findIndex=function(i,n,r){var s;return e(i,"collection"),t.forEach(i,function(t,e){if(n(t,e)&&e>=(r||0))return s=e}),s},t.filter=function(i,n){e(i,"collection");var r=[];return t.forEach(i,function(t){n(t)&&r.push(t)}),r},t.remove=function(i,n){return e(i,"collection"),t.filter(i,function(t){return!n(t)})},t.take=function(t,i){return e(t,"collection"),t.slice(0,i)},t.hasDifferences=function(e,i,n){return t.findDifferences(e,i,n).length>0},t.findDifferences=function(e,i,n){var r=[],s={};function o(o,a){s[a]=1,(t.V(o)||t.isArray(o))&&n?t.hasIndexOrKey(i,a)&&t.sameTypes(e[a],i[a])?t.hasDifferences(e[a],i[a],n)&&r.push(a):r.push(a):e[a]!==i[a]&&r.push(a)}if(t.isArray(e)&&t.isArray(i))e.length>i.length?t.forEach(e,o):t.forEach(i,o);else{if(!t.V(e)||!t.V(i)||t.isArray(e)||t.isArray(i))throw new Error("Object types do not match");t.forOwn(e,o),t.forOwn(i,function(t,e){s.hasOwnProperty(e)||r.push(e)})}return r},t.hasIndexOrKey=function(e,i){return t.isArray(e)?e.length>parseInt(i):!!t.V(e)&&e.hasOwnProperty(i)},t.startsWith=function(t,e){return s(t,"value"),s(e,"prefix"),0===t.indexOf(e)},t.sameTypes=function(e,i){return t.isNullOrUndefined(e)||t.isNullOrUndefined(i)?t.isNullOrUndefined(e)&&t.isNullOrUndefined(i):t.isArray(e)||t.isArray(i)?t.isArray(e)&&t.isArray(i):typeof e==typeof i},t.freeze=function(t){return"freeze"in Object?Object.freeze(t):t},t.noop=function(){},t.V=function(t){return null!==t&&"object"==typeof t},t.isArray=function(e){return!!t.V(e)&&e.constructor===Array},t.tt=function(t){return"string"==typeof t},t.lt=function(t){return!isNaN(t)&&"number"==typeof t},t.pt=function(t){return"boolean"==typeof t},t.S=function(t){return"function"==typeof t},t.isNullOrUndefined=function(e){return null===e||t.isUndefined(e)},t.isUndefined=function(t){return void 0===t},t.getEnumName=function(e,i){var n=null,r=t.map(e,function(t){return t});return t.lt(i)?n=t.find(r,function(t){return t.id===i}):t.tt(i)&&(n=t.find(r,function(t){return t.name.toLowerCase()===i.toLowerCase()})),n?n.name:null},t.toString=function(e){if(t.tt(e))return e;if(t.pt(e))return e?"true":"false";if(t.lt(e))return e.toString();var i="";if(e)if(t.S(e.toString))i=e.toString();else if(t.V(e.toString))try{i=e.toString()}catch(t){i="[object invalid toString()]"}if(0!==i.indexOf("[object"))return i;var n=[];return i+JSON.stringify(e,function(e,i){if(t.V(i)&&!t.isNullOrUndefined(i)){if(t.includes(n,i))return"<recursive>";n.push(i)}return""===e?i:t.toString(i)})},t.pad=function(t,e){i(t,"value"),i(e,"numberToPad");for(var n=t.toString().length,r=0;r<e-n;r++)t="0"+t.toString();return t.toString()},t.addEventListener=function(t,e,i,o){n(t,"target"),s(e,"eventName"),r(i,"listener"),t.phenixAddEventListener?t.phenixAddEventListener.call(t,e,i,!!o):t.addEventListener?t.addEventListener(e,i,!!o):t.attachEvent&&t.attachEvent("on"+e,i)},t.removeEventListener=function(t,e,i,o){n(t,"target"),s(e,"eventName"),r(i,"listener"),t.phenixRemoveEventListener?t.phenixRemoveEventListener.call(t,e,i,!!o):t.removeEventListener?t.removeEventListener(e,i,!!o):t.detachEvent&&t.detachEvent("on"+e,i)};var e=function(e){if(!t.isArray(e))throw new Error("Input must be an array.")},i=function(e,i){if(s(i,"name"),!t.lt(e))throw new Error(i+" must be a number.")},n=function(e,i){if(s(i,"name"),!t.V(e))throw new Error("collection type not supported - "+i+" must be an array or object.")},r=function(e,i){if(s(i,"name"),!t.S(e))throw new Error(i+" must be a function.")},s=function(e,i){if(!t.tt(i))throw new Error("Name must be a string.");if(!t.tt(e))throw new Error(i+" must be a string.")};function o(e){var i=e.split("."),n=[];return t.forEach(i,function(e){n=n.concat(function(e){for(var i="",n=[],r=0,s=0;s<e.length;s++)if("["===e[s]){if(r++,!t.tt(i)||r>1)return[e];i&&(n.push(i),i="")}else if("]"===e[s]){if(0!=--r)return[e];n.push(i),i=""}else{if(s===e.length-1)return[e];i+=e[s]}return n}(e))}),n}return t}.apply(e,[]))||(t.exports=n)},function(t,e,i){"use strict";var n,r;n=[i(2),i(9),i(23),i(14),i(27)],void 0===(r=function(t,e,i,n,r){return t.global.PhenixPCast=i,{PCast:i,UserMediaResolver:n,logging:e,RTC:t,express:{PCastExpress:r}}}.apply(e,n))||(t.exports=r)}])});